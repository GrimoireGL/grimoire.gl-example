!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(29),i=r(o),a=n(20),u=r(a),s=n(21),l=r(s),f=n(22),c=r(f),d=n(30),h=r(d),p=n(31),_=r(p),b=n(32),v=r(b),m=n(33),y=r(m),g=n(82),w=r(g),E=n(34),R=r(E),C=n(35),O=r(C),x=n(36),M=r(x),P=n(37),T=r(P),A=n(23),k=r(A),S=n(24),j=r(S),L=n(10),I=r(L),N=n(38),G=r(N),F=n(25),W=r(F),D=n(39),B=r(D),V=n(40),U=r(V),z=n(43),q=r(z),H=n(44),$=r(H),X=n(41),Y=r(X),Z=n(42),J=r(Z),Q=n(11),K=r(Q),ee=n(12),te=r(ee),ne=n(45),re=r(ne),oe=n(26),ie=r(oe),ae=n(46),ue=r(ae),se=n(4),le=r(se),fe=n(47),ce=r(fe),de=n(48),he=r(de),pe=n(49),_e=r(pe),be=n(50),ve=r(be),me=n(51),ye=r(me),ge=n(52),we=r(ge),Ee=n(53),Re=r(Ee),Ce=n(54),Oe=r(Ce),xe=n(13),Me=r(xe),Pe=n(14),Te=r(Pe),Ae=n(55),ke=r(Ae),Se=n(56),je=r(Se),Le=n(57),Ie=r(Le),Ne=n(58),Ge=r(Ne),Fe=n(59),We=r(Fe),De=n(5),Be=r(De),Ve=n(60),Ue=r(Ve),ze=n(61),qe=r(ze),He=n(62),$e=r(He),Xe=n(6),Ye=r(Xe),Ze=n(83),Je=r(Ze),Qe=n(84),Ke=r(Qe),et=n(85),tt=r(et),nt=n(87),rt=r(nt),ot=n(63),it=r(ot),at=n(15),ut=r(at),st=n(64),lt=r(st),ft=n(65),ct=r(ft),dt=n(66),ht=r(dt),pt=n(67),_t=r(pt),bt=n(16),vt=r(bt),mt=n(3),yt=r(mt),gt=n(68),wt=r(gt),Et=n(69),Rt=r(Et),Ct=n(2),Ot=r(Ct),xt=n(70),Mt=r(xt),Pt=n(71),Tt=r(Pt),At=n(72),kt=r(At),St=n(73),jt=r(St),Lt=n(74),It=r(Lt),Nt=n(75),Gt=r(Nt),Ft=n(76),Wt=r(Ft),Dt=n(77),Bt=r(Dt),Vt=n(78),Ut=r(Vt),zt=n(79),qt=r(zt),Ht=n(17),$t=r(Ht),Xt=n(27),Yt=r(Xt),Zt=n(18),Jt=r(Zt),Qt=n(86),Kt=r(Qt),en="0.12.1",tn="grimoirejs-fundamental",nn={Asset:{AssetLoader:i.default,CacheResolver:u.default,ExternalResourceResolver:l.default,ImageResolver:c.default,TextFileResolver:h.default},Components:{AssetLoadingManagerComponent:_.default,CameraComponent:v.default,CanvasInitializerComponent:y.default,ClickableMeshComponent:w.default,FullscreenComponent:R.default,GeometryComponent:O.default,GeometryRegistoryComponent:M.default,HTMLBinderComponent:T.default,LoopManagerComponent:k.default,MaterialComponent:j.default,MaterialContainerComponent:I.default,MaterialImporterComponent:G.default,MeshRendererComponent:W.default,MouseCameraControlComponent:B.default,RenderBufferComponent:U.default,RendererComponent:q.default,RendererManagerComponent:$.default,RenderHitareaComponent:Y.default,RenderQuadComponent:J.default,RenderSceneComponent:K.default,SceneComponent:te.default,TextureBufferComponent:re.default,TextureComponent:ie.default,TimeComponent:ue.default,TransformComponent:le.default},Converters:{CanvasSizeConverter:ce.default,GeometryConverter:he.default,MaterialConverter:_e.default,NodeConverter:ve.default,PositionConverter:ye.default,TextureConverter:we.default,ViewportConverter:Re.default},Geometry:{DefaultPrimitives:Oe.default,Geometry:Me.default,GeometryFactory:Te.default,GeometryUtility:ke.default},Material:{DefaultMacro:je.default,DefaultMaterial:Ie.default,MacroRegistory:Ge.default,Material:We.default,MaterialFactory:Be.default,Pass:Ue.default,Technique:qe.default,TextureReference:$e.default,UniformResolverRegistry:Ye.default,Uniforms:{MatricesRegister:Je.default,MiscRegister:Ke.default,UserValueRegister:tt.default}},nodes:rt.default,Resource:{Buffer:it.default,FrameBuffer:ut.default,GLExtRequestor:lt.default,ManagedProgram:ct.default,ManagedShader:ht.default,Program:_t.default,RenderBuffer:vt.default,ResourceBase:yt.default,ResourceCache:wt.default,Shader:Rt.default,Texture2D:Ot.default,UniformProxy:Mt.default},SceneRenderer:{DrawPriorty:Tt.default,RenderQueue:kt.default,RenderQueueRegistry:jt.default},Sort:{ImportResolver:It.default,NameSemanticsPair:Gt.default,Parser:Wt.default,Preferences:Bt.default,SortTransformUtility:Ut.default,TypeToConstant:qt.default},Util:{HashCalculator:$t.default,MeshIndexCalculator:Yt.default,TextureSizeCalculator:Jt.default}},rn=(0,Kt.default)();Object.assign(nn,{__VERSION__:en,__NAME__:tn}),Object.assign(rn||{},nn),window.GrimoireJS.lib.fundamental=nn,t.default=rn},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.Node.Component},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(3),f=r(l),c=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._texParameterChanged=!0,n._magFilter=WebGLRenderingContext.LINEAR,n._minFilter=WebGLRenderingContext.LINEAR,n._wrapS=WebGLRenderingContext.REPEAT,n._wrapT=WebGLRenderingContext.REPEAT,t._maxTextureSize||(t._maxTextureSize=e.getParameter(WebGLRenderingContext.MAX_TEXTURE_SIZE)),n.texture=e.createTexture(),n}return a(t,e),u(t,[{key:"update",value:function(e,t,n,r,o,i,a,u){this.gl.bindTexture(WebGLRenderingContext.TEXTURE_2D,this.texture);var s=void 0,l=void 0,f=void 0,c=void 0;void 0===n?(s=t||{flipY:!1,premultipliedAlpha:!1},l=e):(c=e,f=t,s=u||{flipY:!1,premultipliedAlpha:!1}),void 0===s.flipY&&(s.flipY=!1),void 0===s.premultipliedAlpha&&(s.premultipliedAlpha=!1),this.gl.pixelStorei(WebGLRenderingContext.UNPACK_FLIP_Y_WEBGL,s.flipY?1:0),this.gl.pixelStorei(WebGLRenderingContext.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultipliedAlpha?1:0),void 0===n?l instanceof HTMLImageElement?this.gl.texImage2D(WebGLRenderingContext.TEXTURE_2D,0,WebGLRenderingContext.RGBA,WebGLRenderingContext.RGBA,WebGLRenderingContext.UNSIGNED_BYTE,this._justifyImage(l)):l instanceof HTMLCanvasElement?this.gl.texImage2D(WebGLRenderingContext.TEXTURE_2D,0,WebGLRenderingContext.RGBA,WebGLRenderingContext.RGBA,WebGLRenderingContext.UNSIGNED_BYTE,this._justifyCanvas(l)):l instanceof HTMLVideoElement&&this.gl.texImage2D(WebGLRenderingContext.TEXTURE_2D,0,WebGLRenderingContext.RGBA,WebGLRenderingContext.RGBA,WebGLRenderingContext.UNSIGNED_BYTE,this._justifyVideo(l)):(void 0===a&&(a=null),this.gl.texImage2D(WebGLRenderingContext.TEXTURE_2D,c,o,f,n,r,o,i,a)),this._ensureMipmap(),this.valid=!0}},{key:"register",value:function(e){this.gl.activeTexture(WebGLRenderingContext.TEXTURE0+e),this.gl.bindTexture(WebGLRenderingContext.TEXTURE_2D,this.texture),this._texParameterChanged&&this._updateTexParameter()}},{key:"destroy",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.gl.deleteTexture(this.texture)}},{key:"_justifyImage",value:function(e){var n=e.naturalWidth,r=e.naturalHeight,o=Math.min(Math.pow(2,Math.log(Math.min(n,r))/Math.LN2|0),t._maxTextureSize);if(n!==r||n!==o){var i=document.createElement("canvas");return i.height=i.width=o,i.getContext("2d").drawImage(e,0,0,n,r,0,0,o,o),i}return e}},{key:"_justifyCanvas",value:function(e){var t=e.width,n=e.height,r=Math.pow(2,Math.log(Math.min(t,n))/Math.LN2|0);return t===n&&t===r||(e.height=e.width=2*r),e}},{key:"_justifyVideo",value:function(e){var t=e.videoWidth,n=e.videoHeight,r=Math.pow(2,Math.log(Math.min(t,n))/Math.LN2|0);if(t!==n||t!==r){var o=document.createElement("canvas");return o.height=o.width=r,o.getContext("2d").drawImage(e,0,0,t,n,0,0,r,r),o}return e}},{key:"_updateTexParameter",value:function(){this.gl.texParameteri(WebGLRenderingContext.TEXTURE_2D,WebGLRenderingContext.TEXTURE_MIN_FILTER,this._minFilter),this.gl.texParameteri(WebGLRenderingContext.TEXTURE_2D,WebGLRenderingContext.TEXTURE_MAG_FILTER,this._magFilter),this.gl.texParameteri(WebGLRenderingContext.TEXTURE_2D,WebGLRenderingContext.TEXTURE_WRAP_S,this._wrapS),this.gl.texParameteri(WebGLRenderingContext.TEXTURE_2D,WebGLRenderingContext.TEXTURE_WRAP_T,this._wrapT),this._texParameterChanged=!1}},{key:"_ensureMipmap",value:function(){(t._filtersNeedsMipmap.indexOf(this.magFilter)>=0||t._filtersNeedsMipmap.indexOf(this.minFilter)>=0)&&(this.gl.bindTexture(WebGLRenderingContext.TEXTURE_2D,this.texture),this.gl.generateMipmap(WebGLRenderingContext.TEXTURE_2D))}},{key:"magFilter",get:function(){return this._magFilter},set:function(e){this._magFilter!==e&&(this._texParameterChanged=!0,this._magFilter=e,this._ensureMipmap())}},{key:"minFilter",get:function(){return this._minFilter},set:function(e){this._minFilter!==e&&(this._texParameterChanged=!0,this._minFilter=e,this._ensureMipmap())}},{key:"wrapS",get:function(){return this._wrapS},set:function(e){this._wrapS!==e&&(this._texParameterChanged=!0,this._wrapS=e)}},{key:"wrapT",get:function(){return this._wrapT},set:function(e){this._wrapT!==e&&(this._texParameterChanged=!0,this._wrapT=e)}}],[{key:"generateDefaultTexture",value:function(e){t.defaultTextures.set(e,null);var n=new t(e);n.update(0,1,1,0,WebGLRenderingContext.RGBA,WebGLRenderingContext.UNSIGNED_BYTE,new Uint8Array([0,0,0,0])),t.defaultTextures.set(e,n)}}]),t}(f.default);t.default=c,c.defaultTextures=new Map,c._filtersNeedsMipmap=[WebGLRenderingContext.LINEAR_MIPMAP_LINEAR,WebGLRenderingContext.LINEAR_MIPMAP_NEAREST,WebGLRenderingContext.NEAREST_MIPMAP_LINEAR,WebGLRenderingContext.NEAREST_MIPMAP_NEAREST]},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){n(this,e),this.gl=t,this.destroyed=!1,this.index=e._maxIndex++,this.valid=!1}return r(e,[{key:"destroy",value:function(){this.destroyed=!0}},{key:"valid",get:function(){return this._valid},set:function(e){var t=this;this._valid!==e&&(this._valid=e,this._valid?this._validResolve(this):this.validPromise=new Promise(function(e){t._validResolve=e}))}}]),e}();o._maxIndex=0,t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(7),l=r(s),f=n(8),c=r(f),d=n(9),h=r(d),p=n(28),_=r(p),b=n(1),v=r(b),m=_.default.mat4,y=_.default.vec3,g=_.default.vec4,w=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.localTransform=new l.default,e.globalTransform=new l.default,e._children=[],e._cachePVM=new l.default,e._cacheVM=new l.default,e._forward=new c.default([0,0,-1,0]),e._up=new c.default([0,1,0,0]),e._right=new c.default([1,0,0,0]),e._globalPosition=new c.default([0,0,0]),e._globalScale=new c.default([1,1,1]),e._matrixTransformMode=!1,e}return a(t,e),u(t,[{key:"calcPVM",value:function(e){return m.mul(this._cachePVM.rawElements,e.ProjectionViewMatrix.rawElements,this.globalTransform.rawElements),this._cachePVM}},{key:"calcVM",value:function(e){return m.mul(this._cacheVM.rawElements,e.ViewMatrix.rawElements,this.globalTransform.rawElements),this._cacheVM}},{key:"$awake",value:function(){var e=this;this.getAttributeRaw("position").watch(function(t){e._localPosition=t,e._matrixTransformMode=!1,e.updateTransform(!0)}),this.getAttributeRaw("rotation").watch(function(t){e._localRotation=t,e._matrixTransformMode=!1,e.updateTransform()}),this.getAttributeRaw("scale").watch(function(t){e._localScale=t,e._matrixTransformMode=!1,e.updateTransform(!0)}),this.getAttributeRaw("rawMatrix").watch(function(t){if(null!==t){var n=t;e._matrixTransformMode=!0,e.localTransform=n,e.updateGlobalTransform()}}),this._localPosition=this.getAttribute("position"),this._localRotation=this.getAttribute("rotation"),this._localScale=this.getAttribute("scale")}},{key:"$mount",value:function(){this._parentTransform=this.node.parent.getComponent(t),this._parentTransform&&this._parentTransform._children.push(this),this.updateTransform()}},{key:"$unmount",value:function(){this._parentTransform&&(this._parentTransform._children.splice(this._parentTransform._children.indexOf(this),1),this._parentTransform=null)}},{key:"updateTransform",value:function(e){this._matrixTransformMode||m.fromRotationTranslationScale(this.localTransform.rawElements,this._localRotation.rawElements,this._localPosition.rawElements,this._localScale.rawElements),this.updateGlobalTransform(e)}},{key:"updateGlobalTransform",value:function(e){this._parentTransform?m.mul(this.globalTransform.rawElements,this._parentTransform.globalTransform.rawElements,this.localTransform.rawElements):m.copy(this.globalTransform.rawElements,this.localTransform.rawElements),e||this._updateDirections(),this._updateGlobalProperty(),this.node.emit("transformUpdated",this),this._children.forEach(function(t){return t.updateGlobalTransform(e)})}},{key:"_updateDirections",value:function(){g.transformMat4(this._forward.rawElements,t._forwardBase.rawElements,this.globalTransform.rawElements),g.transformMat4(this._up.rawElements,t._upBase.rawElements,this.globalTransform.rawElements),g.transformMat4(this._right.rawElements,t._rightBase.rawElements,this.globalTransform.rawElements)}},{key:"_updateGlobalProperty",value:function(){this._parentTransform?(y.transformMat4(this._globalPosition.rawElements,this._localPosition.rawElements,this._parentTransform.globalTransform.rawElements),y.transformMat4(this._globalScale.rawElements,this._localScale.rawElements,this._parentTransform.globalTransform.rawElements)):(y.copy(this._globalPosition.rawElements,this._localPosition.rawElements),y.copy(this._globalScale.rawElements,this._localScale.rawElements))}},{key:"globalPosition",get:function(){return this._globalPosition}},{key:"localPosition",get:function(){return this._localPosition},set:function(e){this._localPosition=e,this.setAttribute("position",e)}},{key:"localRotation",get:function(){return this._localRotation},set:function(e){this._localRotation=e,this.setAttribute("rotation",e)}},{key:"globalScale",get:function(){return this._globalScale}},{key:"localScale",get:function(){return this._localScale},set:function(e){this._localScale=e,this.setAttribute("scale",e)}},{key:"forward",get:function(){return this._forward}},{key:"up",get:function(){return this._up}},{key:"right",get:function(){return this._right}}]),t}(v.default);t.default=w,w.attributes={position:{converter:"Vector3",default:[0,0,0]},rotation:{converter:"Rotation3",default:[0,0,0,1]},scale:{converter:"Vector3",default:[1,1,1]},rawMatrix:{converter:"Object",default:null}},w._forwardBase=new h.default(0,0,-1,0),w._upBase=new h.default(0,1,0,0),w._rightBase=new h.default(1,0,0,0)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(76),u=r(a),s=n(58),l=r(s),f=n(30),c=r(f),d=n(59),h=r(d),p=n(81),_=r(p),b=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},v=function(){function e(t){if(o(this,e),this.gl=t,this.shaderHeader=e.defaultShaderHeader,this.macro=new l.default,e.factories.has(t))throw new Error("MaterialFactory can not be instanciated dupelicately for a WebGLRenderingContext.");e.factories.set(t,this)}return i(e,[{key:"instanciate",value:function(t){return b(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.materialGenerators[t]){n.next=4;break}return n.abrupt("return",e.materialGenerators[t](this));case 4:return n.next=6,this._waitForRegistered(t);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},n,this)}))}},{key:"_waitForRegistered",value:function(t){var n=this;return new Promise(function(r){e._onRegister(t,function(){r(e.materialGenerators[t](n))})})}}],[{key:"get",value:function(e){var t=this.factories.get(e);if(!t)throw new Error("There was no associated MaterialFactory with specified WebGLRenderingContext");return t}},{key:"addMaterialType",value:function(t,n){e.materialGenerators[t]=n,e.registerdHandlers[t]&&e.registerdHandlers[t].forEach(function(e){return e()})}},{key:"addSORTMaterial",value:function(t,n){return b(this,void 0,void 0,regeneratorRuntime.mark(function r(){var o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u.default.parse(n);case 2:o=r.sent,e.addMaterialType(t,function(e){return new h.default(e.gl,o)});case 4:case"end":return r.stop()}},r,this)}))}},{key:"addSORTMaterialFromURL",value:function(t,n){return b(this,void 0,void 0,regeneratorRuntime.mark(function r(){var o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,c.default.resolve(n);case 2:return o=r.sent,r.next=5,e.addSORTMaterial(t,o);case 5:case"end":return r.stop()}},r,this)}))}},{key:"_onRegister",value:function(t,n){e.registerdHandlers[t]?e.registerdHandlers[t].push(n):e.registerdHandlers[t]=[n]}}]),e}();t.default=v,v.factories=new Map,v.defaultShaderHeader=_.default,v.materialGenerators={},v.registerdHandlers={}},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=t.UniformResolverRegistry=function(){function e(){n(this,e),this._generators={}}return r(e,[{key:"add",value:function(e,t){if("function"!=typeof t)throw new Error("secound argument of add must be function");this._generators[e.toUpperCase()]=t}},{key:"generateRegisterers",value:function(e,t){var n=[],r=[];for(var o in t.uniforms){var i=t.uniforms[o],a=i.semantic,u=this._generators[a];if(!u)throw new Error("There was no suitable registerer for specified semantic "+a);var s=u(i,e);"function"==typeof s?n.push(s):(n.push(s.register),s.dispose&&r.push(s.dispose))}return{registerers:n,disposers:r}}}]),e}();t.default=new o},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.lib.math.Matrix},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.lib.math.Vector3},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.lib.math.Vector4},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(71),l=r(s),f=n(1),c=r(f),d=n(19),h=r(d),p=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},_=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.materialArgs={},e.materialReady=!1,e.useMaterial=!1,e}return a(t,e),u(t,[{key:"getDrawPriorty",value:function(e){if(!this.materialReady)return Number.MAX_VALUE;var t=l.default[this._drawOrder?this._drawOrder:this.material.techniques.default.drawOrder];if(void 0===t)throw new Error('Specified drawing order "'+this.material.techniques.default.drawOrder+'" is not defined');return t.descending?(1-e/1e4)*t.priorty:e/1e4*t.priorty}},{key:"$mount",value:function(){this.getAttributeRaw("material").watch(this._onMaterialChanged.bind(this)),this.companion.get("loader").register(this._onMaterialChanged()),this.getAttributeRaw("drawOrder").boundTo("_drawOrder")}},{key:"_onMaterialChanged",value:function(){return p(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getAttribute("material"),void 0!==t){e.next=4;break}return this.useMaterial=!1,e.abrupt("return");case 4:this.useMaterial=!0,this._registeredAttributes&&this.__removeAttributes(),this._materialComponent?this._prepareExternalMaterial(t):this._prepareInternalMaterial(t);case 7:case"end":return e.stop()}},e,this)}))}},{key:"_prepareExternalMaterial",value:function(e){return p(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.companion.get("loader"),n.register(e),t.next=4,e;case 4:r=t.sent,this.material=r,this.materialArgs=this._materialComponent.materialArgs,this.materialReady=!0;case 8:case"end":return t.stop()}},t,this)}))}},{key:"_prepareInternalMaterial",value:function(e){return p(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,o,i,a,u=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.companion.get("loader"),n.register(e),e){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,e;case 6:r=t.sent,this.material=r;for(o in this.material.argumentDeclarations)this.__addAtribute(o,this.material.argumentDeclarations[o]),this.getAttributeRaw(o).boundTo(o,this.material.arguments);i=function(e){u.__addAtribute(e,u.material.macroDeclarations[e]),u.getAttributeRaw(e).watch(function(t){u.material.setMacroValue(e,t)},!0)};for(a in this.material.macroDeclarations)i(a);this._registeredAttributes=!0,this.materialReady=!0;case 13:case"end":return t.stop()}},t,this)}))}}],[{key:"rewriteDefaultMaterial",value:function(e){e!==t._defaultMaterial&&(t._defaultMaterial=e,h.default.componentDeclarations.get("MaterialContainer").attributes.material.default="new("+e+")")}},{key:"defaultMaterial",get:function(){return this._defaultMaterial}}]),t}(c.default);t.default=_,_.attributes={material:{converter:"Material",default:"new(unlit)",componentBoundTo:"_materialComponent"},drawOrder:{converter:"String",default:null}},_._defaultMaterial="unlit"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=r(s),f=n(15),c=r(f),d=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$awake",value:function(){this.getAttributeRaw("layer").boundTo("layer"),this.getAttributeRaw("clearColor").boundTo("clearColor"),this.getAttributeRaw("clearColorEnabled").boundTo("clearColorEnabled"),this.getAttributeRaw("clearDepthEnabled").boundTo("clearDepthEnabled"),this.getAttributeRaw("clearDepth").boundTo("clearDepth"),this.getAttributeRaw("camera").boundTo("camera"),this.getAttributeRaw("technique").boundTo("technique")}},{key:"$mount",value:function(){this._gl=this.companion.get("gl"),this._canvas=this.companion.get("canvasElement")}},{key:"$bufferUpdated",value:function(e){var t=this.getAttribute("out");"default"!==t&&(this._fbo=new c.default(this.companion.get("gl")),this._fbo.update(e.buffers[t]),this._fboSize=e.bufferSizes[t]);var n=this.getAttribute("depthBuffer");n&&this._fbo&&this._fbo.update(e.buffers[n])}},{key:"$render",value:function(e){var t=this.camera?this.camera:e.camera;t&&(this._fbo?(this._fbo.bind(),this._gl.viewport(0,0,this._fboSize.width,this._fboSize.height)):(this._gl.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null),this._gl.viewport(e.viewport.Left,this._canvas.height-e.viewport.Bottom,e.viewport.Width,e.viewport.Height)),this._fbo&&this.clearColorEnabled&&(this._gl.clearColor(this.clearColor.R,this.clearColor.G,this.clearColor.B,this.clearColor.A),this._gl.clear(WebGLRenderingContext.COLOR_BUFFER_BIT)),this.clearDepthEnabled&&(this._gl.clearDepth(this.clearDepth),this._gl.clear(WebGLRenderingContext.DEPTH_BUFFER_BIT)),e.camera.updateContainedScene(e.loopIndex),e.camera.renderScene({renderer:this,camera:t,buffers:e.buffers,layer:this.layer,viewport:e.viewport,loopIndex:e.loopIndex,technique:this.technique}))}}]),t}(l.default);t.default=d,d.attributes={layer:{converter:"String",default:"default"},depthBuffer:{default:null,converter:"String"},out:{converter:"String",default:"default"},clearColor:{default:"#0000",converter:"Color4"},clearColorEnabled:{default:!0,converter:"Boolean"},clearDepthEnabled:{default:!0,converter:"Boolean"},clearDepth:{default:1,converter:"Number"},camera:{default:null,converter:"Component",target:"Camera"},technique:{default:"default",converter:"String"}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(73),l=r(s),f=n(1),c=r(f),d=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.queueRegistory=new l.default,e}return a(t,e),u(t,[{key:"$mount",value:function(){var e=this;this.sceneDescription={},t._sceneDescriptionCreationHandlers.forEach(function(t){return t(e.sceneDescription,e)})}},{key:"updateScene",value:function(e){this._lastUpdateIndex!==e&&(this.node.broadcastMessage("update",this.sceneDescription),this._lastUpdateIndex=e)}}],[{key:"onSceneDescriptionCreation",value:function(e){t._sceneDescriptionCreationHandlers.push(e)}}]),t}(c.default);t.default=d,d.attributes={},d._sceneDescriptionCreationHandlers=[]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(8),u=r(a),s=n(80),l=r(s),f=n(63),c=r(f),d=function(){function e(t){o(this,e),this.gl=t,this.buffers=[],this.indices={},this.accessors={},this.aabb=new l.default([u.default.Zero])}return i(e,[{key:"addAttributes",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:WebGLRenderingContext.STATIC_DRAW;e=this._ensureToBeVertexBuffer(e,n);var r=this.buffers.length;this.buffers.push(e);for(var o in t){var i=t[o];if(i.bufferIndex=r,void 0===i.size)throw new Error('Accessor specified with the semantics "'+o+'" is not containing size as paranmeter.');void 0===i.type&&(i.type=WebGLRenderingContext.FLOAT),void 0===i.stride&&(i.stride=i.size*this._attribTypeToByteSize(i.type)),void 0===i.offset&&(i.offset=0),this.accessors[o]=i}}},{key:"addIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:WebGLRenderingContext.TRIANGLES,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(!o){if(t instanceof c.default||t instanceof ArrayBuffer||t instanceof DataView)throw new Error("The argument 'count' is necessary if you specified buffer with an instance of Buffer or ArrayBuffer");o=t.length}0===i&&(i=this._indexTypeFromCount(o)),t=this._ensureToBeIndexBuffer(t,i),this.indices[e]={byteOffset:r,byteSize:this._indexTypeToByteSize(i),type:i,topology:n,count:o,index:t}}},{key:"drawByDefault",value:function(t,n,r){var o=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Number.MAX_VALUE,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;
n.forEach(function(t){e.bindBufferToAttribute(o,r,t,t)}),e.drawWithCurrentVertexBuffer(this,t,i,a)}},{key:"_ensureToBeVertexBuffer",value:function(e,t){if(!(e instanceof c.default)){var n=e;Array.isArray(n)&&(n=new Float32Array(n)),e=new c.default(this.gl,WebGLRenderingContext.ARRAY_BUFFER,t),e.update(n)}return e}},{key:"_ensureToBeIndexBuffer",value:function(e,t){if(e instanceof c.default){if(e.target!==WebGLRenderingContext.ELEMENT_ARRAY_BUFFER)throw new Error("The usage of buffer specified as index buffer is not ELEMENT_ARRAY_BUFFER")}else{var n=e;Array.isArray(n)&&(n=new(this._indexTypeToArrayConstructor(t))(n)),e=new c.default(this.gl,WebGLRenderingContext.ELEMENT_ARRAY_BUFFER,WebGLRenderingContext.STATIC_DRAW),e.update(n)}return e}},{key:"_indexTypeFromCount",value:function(e){if(e<256)return WebGLRenderingContext.UNSIGNED_BYTE;if(e<65536)return WebGLRenderingContext.UNSIGNED_SHORT;if(e<4294967296)return WebGLRenderingContext.UNSIGNED_INT;throw new Error("Index count exceeds 4,294,967,296. WebGL can not handle such a big index buffer")}},{key:"_indexTypeToArrayConstructor",value:function(e){switch(e){case WebGLRenderingContext.UNSIGNED_BYTE:return Uint8Array;case WebGLRenderingContext.UNSIGNED_SHORT:return Uint16Array;case WebGLRenderingContext.UNSIGNED_INT:return Uint32Array;default:throw new Error("Unsupported index type")}}},{key:"_indexTypeToByteSize",value:function(e){switch(e){case WebGLRenderingContext.UNSIGNED_BYTE:return 1;case WebGLRenderingContext.UNSIGNED_SHORT:return 2;case WebGLRenderingContext.UNSIGNED_INT:return 4;default:throw new Error("Unsupported index type")}}},{key:"_attribTypeToByteSize",value:function(e){switch(e){case WebGLRenderingContext.FLOAT:return 4;default:throw new Error('Unsupported attribute variable type "'+e+'"')}}}],[{key:"bindBufferToAttribute",value:function(e,t,n,r){var o=t.findAttributeLocation(n);if(o<0)return!1;var i=e.accessors[r];if(!i)throw new Error('Specified buffer "'+r+' was not found on this geometry while attempt to bind "'+n+'" of attribute variables.\n\n\t  All of the vertex buffer available on this geometry is '+Object.keys(e.accessors)+'"');var a=e.buffers[i.bufferIndex];return a.bind(),t.gl.vertexAttribPointer(o,i.size,i.type,!1,i.stride,i.offset),!0}},{key:"drawWithCurrentVertexBuffer",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.MAX_VALUE,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=e.indices[t];if(void 0===o)throw new Error('Specified index buffer "'+t+'" was not found on this geometry.All of the index buffer available on this geometry is "'+Object.keys(e.indices)+'"');o.index.bind(),o.index.gl.drawElements(o.topology,Math.min(o.count,n),o.type,Math.min(r*o.byteSize+o.byteOffset,o.byteOffset+(o.count-1)*o.byteSize))}}]),e}();t.default=d,d._lastGeometry=new Map},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){n(this,e),this.gl=t}return r(e,[{key:"instanciate",value:function(t,n){var r=e.factoryDelegates[t];if(!r)throw new Error("Can not instanciate unknown geometry type "+t);var o=r(this.gl,n);return void 0!==e.factoryExtentions[t]&&e.factoryExtentions[t].forEach(function(e){return e(o,n)}),o}},{key:"instanciateAsDefault",value:function(t){var n=e.factoryArgumentDeclarations[t],r={};for(var o in n){var i=n[o];r[o]=i.default}return this.instanciate(t,r)}}],[{key:"addType",value:function(t,n,r){e.factoryDelegates[t]=r,e.factoryArgumentDeclarations[t]=n}},{key:"extend",value:function(t,n){void 0===e.factoryExtentions[t]&&(e.factoryExtentions[t]=[]),e.factoryExtentions[t].push(n)}}]),e}();t.default=o,o.factoryDelegates={},o.factoryArgumentDeclarations={},o.factoryExtentions={}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(16),f=r(l),c=n(2),d=r(c),h=n(3),p=r(h),_=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.fbo=e.createFramebuffer(),n}return a(t,e),u(t,[{key:"update",value:function(e,t,n){if(this.gl.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,this.fbo),e instanceof d.default){if("undefined"==typeof n&&(n=0),"undefined"==typeof t&&(t=0),this.gl.framebufferTexture2D(WebGLRenderingContext.FRAMEBUFFER,WebGLRenderingContext.COLOR_ATTACHMENT0+n,WebGLRenderingContext.TEXTURE_2D,e.texture,t),this.gl.checkFramebufferStatus(WebGLRenderingContext.FRAMEBUFFER)!==WebGLRenderingContext.FRAMEBUFFER_COMPLETE)throw new Error("INCOMPLETE framebuffer")}else if(e instanceof f.default){var r=t;"undefined"==typeof t&&(r=WebGLRenderingContext.DEPTH_ATTACHMENT),this.gl.framebufferRenderbuffer(WebGLRenderingContext.FRAMEBUFFER,r,WebGLRenderingContext.RENDERBUFFER,e.renderBuffer)}this.gl.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null)}},{key:"bind",value:function(){this.gl.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,this.fbo)}},{key:"destroy",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.gl.deleteFramebuffer(this.fbo)}}]),t}(p.default);t.default=_},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(3),f=r(l),c=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.renderBuffer=e.createRenderbuffer(),n}return a(t,e),u(t,[{key:"update",value:function(e,t,n){this.gl.bindRenderbuffer(WebGLRenderingContext.RENDERBUFFER,this.renderBuffer),this.gl.renderbufferStorage(WebGLRenderingContext.RENDERBUFFER,e,t,n),this.valid=!0}},{key:"bind",value:function(){this.gl.bindRenderbuffer(WebGLRenderingContext.RENDERBUFFER,this.renderBuffer)}},{key:"destroy",value:function(){this.gl.deleteRenderbuffer(this.renderBuffer),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(f.default);t.default=c},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e)}return r(e,null,[{key:"calcHash",value:function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);t=(t<<5)-t+r,t&=t}return t}}]),e}();t.default=o},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e)}return r(e,null,[{key:"getPow2Size",value:function(e,t){var n=Math.pow(2,Math.ceil(Math.log2(e))),r=Math.pow(2,Math.ceil(Math.log2(t)));return{width:n,height:r}}}]),e}();t.default=o},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},i=function(){function e(t){n(this,e),this.toAbsolute=t,this.cache={},this.resolvers={}}return r(e,[{key:"resolve",value:function(e,t){return o(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=this.toAbsolute(e),!this._cached(r)){n.next=5;break}return n.abrupt("return",this.cache[r]);case 5:if(!this._resolving(r)){n.next=11;break}return n.next=8,this.resolvers[r];case 8:return n.abrupt("return",n.sent);case 11:return this.resolvers[r]=t(r),n.next=14,this.resolvers[r];case 14:return o=n.sent,this._resolved(r,o),n.abrupt("return",o);case 17:case"end":return n.stop()}},n,this)}))}},{key:"_cached",value:function(e){return"undefined"!=typeof this.cache[e]}},{key:"_resolving",value:function(e){return"undefined"!=typeof this.resolvers[e]}},{key:"_resolved",value:function(e,t){delete this.resolvers[e],this.cache[e]=t}}]),e}();t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(20),l=r(s),f=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,t._toAbsolute))}return a(t,e),u(t,null,[{key:"_toAbsolute",value:function(e){if(e.match(/^blob\:/m))return e;var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host+t.pathname+t.search+t.hash}}]),t}(l.default);t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ImageResolver=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(21),f=r(l),c=t.ImageResolver=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"resolve",value:function(e){return s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"resolve",this).call(this,e,function(t){return new Promise(function(n,r){var o=new Image;o.onload=function(){n(o)},o.onerror=function(n){r('Error has been occured during loading "'+t+"("+e+')"\n'+n)},o.src=t})})}}]),t}(f.default);t.default=new c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=r(s),f=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._loopActions=[],e._loopIndex=0,e}return a(t,e),u(t,[{key:"$awake",value:function(){var e=this;this.getAttributeRaw("loopEnabled").watch(function(t){t&&e._begin()}),this._registerNextLoop=window.requestAnimationFrame?function(){window.requestAnimationFrame(e._loop.bind(e))}:function(){window.setTimeout(e._loop.bind(e),1e3/60)}}},{key:"register",value:function(e,t){this._loopActions.push({action:e,priorty:t}),this._loopActions.sort(function(e,t){return e.priorty-t.priorty})}},{key:"_begin",value:function(){this._registerNextLoop()}},{key:"_loop",value:function(){var e=this;this.node.emit("loop",{loopIndex:this._loopIndex}),this._loopActions.forEach(function(t){return t.action(e._loopIndex)}),this._loopIndex++,this._registerNextLoop()}}]),t}(l.default);f.attributes={loopEnabled:{default:!1,converter:"Boolean"}},t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=r(s),f=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},c=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.materialArgs={},e}return a(t,e),u(t,[{key:"$mount",value:function(){var e=this.getAttribute("type");e&&(this.materialPromise=this.companion.get("MaterialFactory").instanciate(e),this._registerAttributes())}},{key:"_registerAttributes",value:function(){return f(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.materialPromise;case 2:this.material=e.sent;for(t in this.material.argumentDeclarations)this.__addAtribute(t,this.material.argumentDeclarations[t]),this.getAttributeRaw(t).boundTo(t,this.material.arguments);n=function(e){o.__addAtribute(e,o.material.macroDeclarations[e]),o.getAttributeRaw(e).watch(function(t){o.material.setMacroValue(e,t)},!0)};for(r in this.material.macroDeclarations)n(r);this.ready=!0;case 7:case"end":return e.stop()}},e,this)}))}}]),t}(l.default);t.default=c,c.attributes={type:{converter:"String",default:null}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(12),l=r(s),f=n(10),c=r(f),d=n(4),h=r(d),p=n(1),_=r(p),b=n(28),v=r(b),m=v.default.vec3,y=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._priortyCalcCache=new Float32Array(3),e}return a(t,e),u(t,[{key:"getRenderingPriorty",value:function(e,t,n){return m.add(this._priortyCalcCache,e.transform.globalPosition.rawElements,this.geometry.aabb.Center.rawElements),m.sub(this._priortyCalcCache,this._priortyCalcCache,this._transformComponent.globalPosition.rawElements),this._materialContainer.getDrawPriorty(m.sqrLen(this._priortyCalcCache))}},{key:"$awake",value:function(){this.__bindAttributes()}},{key:"$mount",value:function(){this._transformComponent=this.node.getComponent(h.default),this._materialContainer=this.node.getComponent(c.default),this._containedScene=t._findContainedScene(this.node),this._containedScene.queueRegistory.addRenderable(this)}},{key:"$unmount",value:function(){this._containedScene.queueRegistory.removeRenderable(this)}},{key:"render",value:function(e){if(this.node.isActive&&this.enabled&&this.layer===e.layer&&this.geometry&&(e.material||this._materialContainer.material)){var t={targetBuffer:this.targetBuffer,geometry:this.geometry,attributeValues:null,camera:e.camera,transform:this._transformComponent,buffers:e.buffers,viewport:e.viewport,drawCount:this.drawCount,drawOffset:this.drawOffset,sceneDescription:e.sceneDescription,technique:e.technique,renderable:this};t.attributeValues=this._materialContainer.materialArgs,this._materialContainer.material.draw(t),this.node.emit("render",e)}}},{key:"setRenderableIndex",value:function(e){this.index=e}}],[{key:"_findContainedScene",value:function(e){if(e.parent){var n=e.parent.getComponent(l.default);return n?n:t._findContainedScene(e.parent)}return null}}]),t}(_.default);t.default=y,y.attributes={geometry:{converter:"Geometry",default:"quad"},targetBuffer:{converter:"String",default:"default"},layer:{converter:"String",default:"default"},drawCount:{converter:"Number",default:Number.MAX_VALUE},drawOffset:{converter:"Number",default:0}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(2),l=r(s),f=n(1),c=r(f),d=n(22),h=r(d),p=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},_=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$mount",value:function(){var e=this,t=this.getAttribute("src");this.texture=new l.default(this.companion.get("gl")),this.texture.magFilter=this.getAttribute("magFilter"),this.texture.minFilter=this.getAttribute("minFilter"),this.texture.wrapT=this.getAttribute("wrapT"),this.texture.wrapS=this.getAttribute("wrapS"),this.getAttributeRaw("magFilter").watch(function(t){return e.texture.magFilter=t}),this.getAttributeRaw("minFilter").watch(function(t){return e.texture.minFilter=t}),this.getAttributeRaw("wrapS").watch(function(t){return e.texture.wrapS=t}),this.getAttributeRaw("wrapT").watch(function(t){return e.texture.wrapT=t}),t&&this._loadTask(t)}},{key:"_loadTask",value:function(e){return p(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.default.resolve(e);case 2:n=t.sent,this.texture.update(n);case 4:case"end":return t.stop()}},t,this)}))}}]),t}(c.default);t.default=_,_.attributes={src:{converter:"String",default:null},minFilter:{converter:"Enum",default:"LINEAR",table:{LINEAR:WebGLRenderingContext.LINEAR,NEAREST:WebGLRenderingContext.NEAREST,NEAREST_MIPMAP_NEAREST:WebGLRenderingContext.NEAREST_MIPMAP_NEAREST,NEAREST_MIPMAP_LINEAR:WebGLRenderingContext.NEAREST_MIPMAP_LINEAR,LINEAR_MIPMAP_NEAREST:WebGLRenderingContext.LINEAR_MIPMAP_NEAREST,LINEAR_MIPMAP_LINEAR:WebGLRenderingContext.LINEAR_MIPMAP_LINEAR}},magFilter:{converter:"Enum",default:"LINEAR",table:{LINEAR:WebGLRenderingContext.LINEAR,NEAREST:WebGLRenderingContext.NEAREST}},wrapS:{converter:"Enum",default:"REPEAT",table:{REPEAT:WebGLRenderingContext.REPEAT,MIRRORED_REPEAT:WebGLRenderingContext.MIRRORED_REPEAT,CLAMP_TO_EDGE:WebGLRenderingContext.CLAMP_TO_EDGE}},wrapT:{converter:"Enum",default:"REPEAT",table:{REPEAT:WebGLRenderingContext.REPEAT,MIRRORED_REPEAT:WebGLRenderingContext.MIRRORED_REPEAT,CLAMP_TO_EDGE:WebGLRenderingContext.CLAMP_TO_EDGE}}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(9),u=r(a),s=511,l=s<<8,f=l<<8,c=f<<8,d=function(){function e(){o(this,e)}return i(e,null,[{key:"fromIndex",value:function(e){return new u.default((e&s)/255,((e&l)>>8)/255,((e&f)>>16)/255,((e&c)>>24)/255)}},{key:"fromColor",value:function(e){return e[0]+(e[1]<<8)+(e[2]<<16)+(e[3]<<24)}}]),e}();t.default=d},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.lib.math.GLM},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(92),l=r(s),f=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},c=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.registerCount=0,e.loadCount=0,e.completeCount=0,e.errorCount=0,e.promise=new Promise(function(t){e._resolve=t}),e}return a(t,e),u(t,[{key:"register",value:function(e){var t=this;return this.registerCount++,new Promise(function(n,r){(function(){return f(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=n,t.next=4,e;case 4:t.t1=t.sent,(0,t.t0)(t.t1),this.loadCount++,t.next=13;break;case 9:t.prev=9,t.t2=t.catch(0),r(t.t2),this.errorCount++;case 13:this.completeCount++,this._checkLoadCompleted();case 15:case"end":return t.stop()}},t,this,[[0,9]])}))}).bind(t)()})}},{key:"_checkLoadCompleted",value:function(){this.emit("progress",this),this.registerCount===this.completeCount&&this._resolve()}}]),t}(l.default);t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.TextFileResolver=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(21),f=r(l),c=t.TextFileResolver=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"resolve",value:function(e){return s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"resolve",this).call(this,e,function(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",e),r.onload=function(e){t(r.responseText)},r.onerror=function(e){n(e)},r.send()})})}}]),t}(f.default);t.default=new c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(19),l=r(s),f=n(29),c=r(f),d=n(1),h=r(d),p=n(96),_=r(p),b=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},v=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.loader=new c.default,e}return a(t,e),u(t,[{key:"$treeInitialized",value:function(){this.getAttribute("autoStart")&&this._autoStart(),this._documentResolver()}},{key:"$awake",value:function(){var e=this;this.companion.set(l.default.ns(this.name.ns)("loader"),this.loader),this.loader.register(new Promise(function(t){e._documentResolver=t}));var t=this.companion.get("canvasContainer");if(this.getAttribute("enableLoader")){var n=document.createElement("div");n.innerHTML=_.default,n.style.width=n.style.height="100%",t.appendChild(n),this._loaderElement=n}}},{key:"_autoStart",value:function(){return b(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:
return e.next=2,this.loader.promise;case 2:this._loaderElement&&this._loaderElement.remove(),this.node.emit("asset-load-completed"),this.tree("goml").setAttribute("loopEnabled",!0);case 5:case"end":return e.stop()}},e,this)}))}}]),t}(h.default);t.default=v,v.attributes={loadingProgress:{default:0,converter:"Number"},autoStart:{default:!0,converter:"Boolean"},enableLoader:{default:!0,converter:"Boolean"}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(28),l=r(s),f=n(9),c=r(f),d=n(8),h=r(d),p=n(7),_=r(p),b=n(72),v=r(b),m=n(4),y=r(m),g=n(12),w=r(g),E=n(1),R=r(E),C=l.default.vec3,O=l.default.vec4,x=l.default.mat4,M=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._renderQueue=new v.default,e._eyeCache=h.default.Zero,e._lookAtCache=h.default.Zero,e._upCache=h.default.Zero,e.__viewMatrix=new _.default,e.__projectionMatrix=new _.default,e.__invProjectionMatrix=new _.default,e.__projectionViewMatrix=new _.default,e._orthographic=!1,e}return a(t,e),u(t,[{key:"$awake",value:function(){var e=this;this.getAttributeRaw("far").watch(function(t){e.Far=t},!0),this.getAttributeRaw("near").watch(function(t){e.Near=t},!0),this.getAttributeRaw("fovy").watch(function(t){e.Fovy=t},!0),this.getAttributeRaw("aspect").watch(function(t){e.Aspect=t},!0),this.getAttributeRaw("orthoSize").watch(function(t){e.OrthoSize=t},!0),this.getAttributeRaw("orthogonal").watch(function(t){e.OrthographicMode=t},!0),this.getAttributeRaw("autoAspect").boundTo("_autoAspect")}},{key:"$mount",value:function(){this.transform=this.node.getComponent(y.default),this.containedScene=t._findContainedScene(this.node),this.containedScene.queueRegistory.registerQueue(this._renderQueue),this.node.on("transformUpdated",this.updateTransform.bind(this)),this.updateTransform()}},{key:"$unmount",value:function(){this.containedScene.queueRegistory.unregisterQueue(this._renderQueue),this.containedScene=null}},{key:"updateContainedScene",value:function(e){this.containedScene&&this.containedScene.updateScene(e)}},{key:"renderScene",value:function(e){e=e,this.containedScene&&(this._justifyAspect(e),e.sceneDescription=this.containedScene.sceneDescription,this._renderQueue.renderAll(e,!0,e.loopIndex))}},{key:"_justifyAspect",value:function(e){if(this._autoAspect){var t=e.viewport.Width/e.viewport.Height;this._aspectCache!==t&&(this.setAttribute("aspect",t),this._aspectCache=t)}}},{key:"updateTransform",value:function(){var e=this.transform;C.transformMat4(this._eyeCache.rawElements,h.default.Zero.rawElements,e.globalTransform.rawElements),O.transformMat4(this._lookAtCache.rawElements,t._frontOrigin.rawElements,e.globalTransform.rawElements),C.add(this._lookAtCache.rawElements,this._lookAtCache.rawElements,this._eyeCache.rawElements),O.transformMat4(this._upCache.rawElements,t._upOrigin.rawElements,e.globalTransform.rawElements),x.lookAt(this.__viewMatrix.rawElements,this._eyeCache.rawElements,this._lookAtCache.rawElements,this._upCache.rawElements),x.mul(this.__projectionViewMatrix.rawElements,this.__projectionMatrix.rawElements,this.__viewMatrix.rawElements)}},{key:"_recalculateProjection",value:function(){this._orthographic?x.ortho(this.__projectionMatrix.rawElements,-this._orthoSize*this._aspect,this._orthoSize*this._aspect,-this._orthoSize,this._orthoSize,this._near,this._far):x.perspective(this.__projectionMatrix.rawElements,this._fovy,this._aspect,this._near,this._far),x.mul(this.__projectionViewMatrix.rawElements,this.__projectionMatrix.rawElements,this.__viewMatrix.rawElements),x.invert(this.__invProjectionMatrix.rawElements,this.__projectionMatrix.rawElements)}},{key:"ViewMatrix",get:function(){return this.__viewMatrix}},{key:"ProjectionMatrix",get:function(){return this.__projectionMatrix}},{key:"InvProjectionMatrix",get:function(){return this.__invProjectionMatrix}},{key:"ProjectionViewMatrix",get:function(){return this.__projectionViewMatrix}},{key:"Far",get:function(){return this._far},set:function(e){this._far=e,this._recalculateProjection()}},{key:"Near",get:function(){return this._near},set:function(e){this._near=e,this._recalculateProjection()}},{key:"Aspect",get:function(){return this._aspect},set:function(e){this._aspect=e,this._recalculateProjection()}},{key:"Fovy",get:function(){return this._fovy},set:function(e){this._fovy=e,this._recalculateProjection()}},{key:"OrthoSize",get:function(){return this._orthoSize},set:function(e){this._orthoSize=e}},{key:"OrthographicMode",set:function(e){this._orthographic=e,this._recalculateProjection()},get:function(){return this._orthographic}},{key:"AutoAspect",set:function(e){this._autoAspect!==e&&(this._autoAspect=e,this._recalculateProjection())},get:function(){return this._autoAspect}}],[{key:"_findContainedScene",value:function(e){if(e.parent){var n=e.parent.getComponent(w.default);return n?n:t._findContainedScene(e.parent)}return null}}]),t}(R.default);t.default=M,M._frontOrigin=new c.default(0,0,-1,0),M._upOrigin=new c.default(0,1,0,0),M.attributes={fovy:{default:"45d",converter:"Angle2D"},near:{default:.01,converter:"Number"},far:{default:100,converter:"Number"},aspect:{default:1.6,converter:"Number"},autoAspect:{default:!0,converter:"Boolean"},orthoSize:{default:100,converter:"Number"},orthogonal:{default:!1,converter:"Boolean"}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(5),f=r(l),c=n(93),d=r(c),h=n(2),p=r(h),_=n(64),b=r(_),v=n(1),m=r(v),y=d.default.ns("HTTP://GRIMOIRE.GL/NS/DEFAULT");!function(e){e[e.Aspect=0]="Aspect",e[e.Fit=1]="Fit",e[e.Manual=2]="Manual"}(u||(u={}));var g=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"$awake",value:function(){var e=this;if(this._scriptTag=this.companion.get("scriptElement"),!this._isContainedInBody(this._scriptTag))throw new Error("goml script should have body as ancesotor to instanciate canvas element in the location");this._generateCanvas(this._scriptTag),this.getAttributeRaw("width").watch(function(t){e._resize()}),this.getAttributeRaw("height").watch(function(t){e._resize()}),this.getAttributeRaw("antialias").watch(function(e){console.warn("Changing antialias attribute is not supported. This is only works when the canvas element created.")}),this.getAttributeRaw("preserveDrawingBuffer").watch(function(e){console.warn("Changing preserveDrawingBuffer attribute is not supported. This is only works when the canvas element created.")})}},{key:"_generateCanvas",value:function(e){var t=this;this._autoFixForBody(e),this.canvas=document.createElement("canvas"),window.addEventListener("resize",function(){return t._onWindowResize()}),this._configureCanvas(this.canvas,e);var n=this._getContext(this.canvas);return this.companion.set(y("gl"),n),this.companion.set(y("canvasElement"),this.canvas),this.companion.set(y("MaterialFactory"),new f.default(n)),this.companion.set(y("GLExtRequestor"),new b.default(n)),p.default.generateDefaultTexture(n),this.canvas}},{key:"_resize",value:function(e){var t=(this.companion.get("canvasElement"),this.getAttribute("width")),n=this.getAttribute("height");if(this._widthMode=this._asResizeMode(t),this._heightMode=this._asResizeMode(n),this._widthMode===this._heightMode&&this._widthMode===u.Aspect)throw new Error("Width and height could not have aspect mode in same time!");this._widthMode===u.Aspect&&(this._ratio=t.aspect),this._heightMode===u.Aspect&&(this._ratio=n.aspect),this._widthMode===u.Manual&&this._applyManualWidth(t.size,e),this._heightMode===u.Manual&&this._applyManualHeight(n.size,e),this._onWindowResize(e)}},{key:"_onWindowResize",value:function(e){var t=this._getParentSize();this._widthMode===u.Fit&&this._applyManualWidth(t.width,e),this._heightMode===u.Fit&&(0===t.height&&d.default.debug&&console.warn("Canvas height parameter specified as fit and height of parent element is 0.\n This is possibly the reason you haven't set css to html or body element."),this._applyManualHeight(t.height,e))}},{key:"_applyManualWidth",value:function(e,t){e!==this.canvas.width&&(this.canvas.width=e,this._canvasContainer.style.width=e+"px",t||this.node.broadcastMessage(1,"resizeCanvas"),this._heightMode===u.Aspect&&this._applyManualHeight(e/this._ratio,t))}},{key:"_applyManualHeight",value:function(e,t){e!==this.canvas.height&&(this.canvas.height=e,this._canvasContainer.style.height=e+"px",t||this.node.broadcastMessage(1,"resizeCanvas"),this._widthMode===u.Aspect&&this._applyManualWidth(e*this._ratio,t))}},{key:"_getParentSize",value:function(){var e=this._canvasContainer.parentElement,t=e.getBoundingClientRect();return t}},{key:"_asResizeMode",value:function(e){return"fit"===e.mode?u.Fit:"aspect"===e.mode?u.Aspect:u.Manual}},{key:"_configureCanvas",value:function(e,t){e.style.position="absolute",e.style.top="0px",e.style.left="0px",this._canvasContainer=document.createElement("div"),this._canvasContainer.style.position="relative",this._canvasContainer.style.overflow="hidden",this._canvasContainer.appendChild(e),this.getAttribute("containerId")&&(this._canvasContainer.id=this.getAttribute("containerId")),this.getAttribute("containerClass")&&(this._canvasContainer.className=this.getAttribute("containerClass")),this.companion.set(y("canvasContainer"),this._canvasContainer),t.parentElement.insertBefore(this._canvasContainer,t.nextSibling),this._resize(!0)}},{key:"_getContext",value:function(e){var t={antialias:this.getAttribute("antialias"),preserveDrawingBuffer:this.getAttribute("preserveDrawingBuffer")},n=e.getContext("webgl",t);return n||(n=e.getContext("webgl-experimental",t)),n}},{key:"_isContainedInBody",value:function(e){return!!e.parentElement&&("BODY"===e.parentNode.nodeName||this._isContainedInBody(e.parentElement))}},{key:"_autoFixForBody",value:function(e){if("BODY"===e.parentElement.nodeName){var t=document.body.getBoundingClientRect();0===t.height&&(document.body.style.height="100%",document.body.parentElement.style.height="100%")}}}]),t}(m.default);g.attributes={width:{default:"fit",converter:"CanvasSize"},height:{default:"fit",converter:"CanvasSize"},containerId:{default:"",converter:"String"},containerClass:{default:"gr-container",converter:"String"},preserveDrawingBuffer:{default:!0,converter:"Boolean"},antialias:{default:!0,converter:"Boolean"}},t.default=g},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=r(s),f=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._fullscreen=!1,e}return a(t,e),u(t,[{key:"$awake",value:function(){var e=this;this.getAttributeRaw("fullscreen").watch(function(t){e._fullscreen!==t&&(e._fullscreen=t,e._switchFullscreen())})}},{key:"_switchFullscreen",value:function(){this._fullscreen?this.requestFullscreen(this.getAttribute("fullscreenTarget")||this.companion.get("canvasContainer")):this.exitFullscreen()}},{key:"requestFullscreen",value:function(e){if(e.webkitRequestFullscreen)e.webkitRequestFullscreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else if(e.msRequestFullscreen)e.msRequestFullscreen();else{if(!e.requestFullscreen)return void console.error("");e.requestFullscreen()}}},{key:"exitFullscreen",value:function(){document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():document.cancelFullScreen?document.cancelFullScreen():document.exitFullscreen&&document.exitFullscreen()}}]),t}(l.default);t.default=f,f.attributes={fullscreen:{converter:"Boolean",default:!1},fullscreenTarget:{converter:"String",default:null}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(14),l=r(s),f=n(1),c=r(f),d=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$mount",value:function(){var e=this.getAttribute("type");if(e){var t=this.companion.get("GeometryFactory"),n=l.default.factoryArgumentDeclarations[e],r={};for(var o in n)this.__addAtribute(o,n[o]),r[o]=this.getAttribute(o);this.geometry=t.instanciate(e,r);var i=this.companion.get("GeometryRegistory"),a=this.getAttribute("name");if(!a)throw new Error("Name was not specified");i.addGeometry(a,this.geometry)}}}]),t}(c.default);t.default=d,d.attributes={type:{converter:"String",default:null},name:{converter:"String",default:null}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(14),l=r(s),f=n(1),c=r(f),d=n(19),h=r(d),p=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._geometries={},e}return a(t,e),u(t,[{key:"$awake",value:function(){this._factory=new l.default(this.companion.get("gl")),this.companion.set(this.name,this),this.companion.set(h.default.ns(this.name.ns)("GeometryFactory"),this._factory);var e=!0,t=!1,n=void 0;try{for(var r,o=this.getAttribute("defaultGeometry")[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;this.addGeometry(i,this._factory.instanciateAsDefault(i))}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}}},{key:"addGeometry",value:function(e,t){this._geometries[e]=t}},{key:"removeGeometry",value:function(e){this._geometries[e]&&delete this._geometries[e]}},{key:"getGeometry",value:function(e){return this._geometries[e]}}]),t}(c.default);t.default=p,p.attributes={defaultGeometry:{converter:"StringArray",default:["quad","cube","sphere"]}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(11),l=r(s),f=n(4),c=r(f),d=n(1),h=r(d),p=n(9),_=r(p),b=n(7),v=r(b),m=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._isFirstCall=!0,e}return a(t,e),u(t,[{key:"$awake",value:function(){this._canvasContainer=this.companion.get("canvasContainer"),this._currentTransform=this.node.getComponent(c.default)}},{key:"$mount",value:function(){this._canvasContainer=this.companion.get("canvasContainer"),this._currentTransform=this.node.getComponent(c.default),this.node.on("render",this._onRender.bind(this))}},{key:"$treeInitialized",value:function(){var e=this;this.getAttributeRaw("targetRenderer").watch(function(t){e._rendererQuery!==t&&e._onRendererChanged()},!0),this.getAttributeRaw("htmlQuery").watch(function(t){e._onQueryChanged(t)},!0)}},{key:"_onRender",value:function(e){if(this._isFirstCall&&(this._onRendererChanged(),this._isFirstCall=!1),this._queriedElement&&e.renderer===this._targetRenderer){var t=e.viewport,n=v.default.transform(this._currentTransform.calcPVM(e.camera),new _.default(0,0,0,1)),r={x:n.X/n.W,y:n.Y/n.W,z:n.Z/n.W};if(r.z>=-1&&r.z<=1){var o={x:t.Left+(r.x+1)/2*t.Width,y:t.Top+(r.y+1)/2*t.Height};this._queriedElement.style.visibility="visible",this._queriedElement.style.left=o.x+"px",this._queriedElement.style.bottom=o.y+"px"}else this._queriedElement.style.visibility="hidden"}}},{key:"_restoreDefault",value:function(){this._canvasContainer.removeChild(this._queriedElement),this._parentCache.appendChild(this._queriedElement);var e=this._queriedElement.style,t=this._styleCache;e.position=t.position,e.left=t.left,e.bottom=t.bottom,e.visibility=t.visibility}},{key:"_beginTrack",value:function(){this._parentCache.removeChild(this._queriedElement),this._canvasContainer.appendChild(this._queriedElement),this._queriedElement.style.position="absolute"}},{key:"_onRendererChanged",value:function(){var e=this,t=!1;this.tree(this.getAttribute("targetRenderer")).forEach(function(n){return!!t||(e._targetRenderer=n.getComponent(l.default),void(e._targetRenderer&&(t=!0)))})}},{key:"_onQueryChanged",value:function(e){var t=void 0;if(e&&""!==e&&(t=document.querySelectorAll(e)),this._queriedElement&&this._restoreDefault(),t&&0!==t.length){this._queriedElement=t.item(0);var n=this._queriedElement.style;this._styleCache={position:n.position,visibility:n.visibility,left:n.left,bottom:n.bottom},this._parentCache=this._queriedElement.parentElement,this._beginTrack()}else this._queriedElement=void 0,this._parentCache=void 0}}]),t}(h.default);t.default=m,m.attributes={htmlQuery:{default:null,converter:"String"},targetRenderer:{default:"render-scene",converter:"String"}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(5),l=r(s),f=n(1),c=r(f),d=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$awake",value:function(){if(this.getAttributeRaw("typeName").watch(function(e){console.warn("Changeing 'typeName' on MaterialImporter makes no sense. This change won't affect anything.")}),this.getAttributeRaw("src").watch(function(e){console.warn("Changeing 'src' on MaterialImporter makes no sense. This change won't affect anything.")}),!this.getAttribute("typeName")||!this.getAttribute("src"))throw new Error("type or src cannot be null in material importer");var e=this.getAttribute("typeName");if(void 0!==l.default.factories[e])throw new Error("A material type '"+e+"' is already loaded.");l.default.addSORTMaterialFromURL(this.getAttribute("typeName"),this.getAttribute("src"))}}]),t}(c.default);t.default=d,d.attributes={typeName:{default:null,converter:"String"},src:{default:null,converter:"String"}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(8),l=r(s),f=n(89),c=r(f),d=n(7),h=r(d),p=n(4),_=r(p),b=n(1),v=r(b),m=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._updated=!1,e._lastCenter=null,e._lastScreenPos=null,e._xsum=0,e._ysum=0,e._d=l.default.Zero,e}return a(t,e),u(t,[{key:"$awake",value:function(){this.__bindAttributes(),this._listeners={mousemove:this._mouseMove.bind(this),contextmenu:this._contextMenu.bind(this),wheel:this._mouseWheel.bind(this)}}},{key:"$mount",value:function(){this._transform=this.node.getComponent(_.default);var e=this.companion.get("canvasElement");e.addEventListener("mousemove",this._listeners.mousemove),e.addEventListener("contextmenu",this._listeners.contextmenu),e.addEventListener("wheel",this._listeners.wheel),this._lastScreenPos=null,this._xsum=0,this._ysum=0}},{key:"$unmount",value:function(){var e=this.companion.get("canvasElement");e.removeEventListener("mousemove",this._listeners.mousemove),e.removeEventListener("contextmenu",this._listeners.contextmenu),e.removeEventListener("wheel",this._listeners.wheel)}},{key:"$initialized",value:function(){var e=l.default.normalize(this.center.subtractWith(this._transform.localPosition)),t=c.default.fromToRotation(this._transform.forward,e).normalize();this._transform.localRotation=t,this._initialRotation=t,this._initialDirection=l.default.copy(this._transform.forward.negateThis()).normalized,null!==this.distance?this._transform.localPosition=this.center.addWith(this._initialDirection.multiplyWith(this.distance)):this.distance=this._transform.localPosition.subtractWith(this.center).magnitude}},{key:"$update",value:function(){if(this._updated||!this._lastCenter||!this.center.equalWith(this._lastCenter)){this._updated=!1,this._lastCenter=this.center;var e=c.default.angleAxis(-this._xsum*this.rotateSpeed*.01,l.default.YUnit),t=c.default.angleAxis(-this._ysum*this.rotateSpeed*.01,l.default.XUnit),n=c.default.multiply(e,t),r=h.default.rotationQuaternion(n),o=h.default.transformNormal(r,this._initialDirection);this._transform.localPosition=this.center.addWith(this._d).addWith(l.default.normalize(o).multiplyWith(this.distance)),this._transform.localRotation=n,this._transform.localRotation=c.default.multiply(n,this._initialRotation)}}},{key:"_contextMenu",value:function(e){this.isActive&&e.preventDefault()}},{key:"_mouseMove",value:function(e){if(this.isActive){if(null===this._lastScreenPos)return void(this._lastScreenPos={x:e.screenX,y:e.screenY});var t=e.screenX-this._lastScreenPos.x,n=e.screenY-this._lastScreenPos.y;if(this._checkButtonPress(e,!0)&&(this._xsum+=t,this._ysum+=n,this._ysum=Math.min(50*Math.PI,this._ysum),this._ysum=Math.max(50*-Math.PI,this._ysum),this._updated=!0),this._checkButtonPress(e,!1)){var r=-t*this.moveSpeed*.01,o=n*this.moveSpeed*.01;this._d=this._d.addWith(this._transform.right.multiplyWith(r)).addWith(this._transform.up.multiplyWith(o)),this._updated=!0}this._lastScreenPos={x:e.screenX,y:e.screenY}}}},{key:"_checkButtonPress",value:function(e,t){return"buttons"in e?t?(1&e.buttons)>0:(2&e.buttons)>0:t?1===e.which:3===e.which}},{key:"_mouseWheel",value:function(e){if(this.isActive){var t=l.default.subtract(this._transform.localPosition,this.center).normalized,n=e.deltaY*this.zoomSpeed*.05;this.distance=Math.max(1,this.distance+n),this._transform.localPosition=this.center.addWith(t.multiplyWith(this.distance)),e.preventDefault()}}}]),t}(v.default);t.default=m,m.attributes={rotateSpeed:{default:1,converter:"Number"},zoomSpeed:{default:1,converter:"Number"},moveSpeed:{default:1,converter:"Number"},center:{default:"0,0,0",converter:"Position",lazy:!0},distance:{default:null,converter:"Number"}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(16),l=r(s),f=n(1),c=r(f),d=n(18),h=r(d),p=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$mount",value:function(){this.buffer=new l.default(this.companion.get("gl"))}},{key:"$unmount",value:function(){this.buffer.destroy(),this.buffer=null}},{key:"$resizeBuffer",value:function(e){var t=this.getAttribute("name");if(!t)throw new Error("Attribute 'name' must be specified.");var n=h.default.getPow2Size(e.width,e.height);this.buffer.update(WebGLRenderingContext.DEPTH_COMPONENT16,n.width,n.height),e.bufferSizes[t]={width:n.width,height:n.height},e.buffers[t]=this.buffer}}]),t}(c.default);t.default=p,p.attributes={name:{converter:"String",default:null}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(27),l=r(s),f=n(15),c=r(f),d=n(2),h=r(d),p=n(16),_=r(p),b=n(18),v=r(b),m=n(11),y=r(m),g=n(1),w=r(g),E=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._readCache=new Uint8Array(4),e}return a(t,e),u(t,[{key:"$mount",value:function(){if(this._sceneRenderer=this.node.getComponent(y.default),!this._sceneRenderer)throw new Error("The node attaching RenderHitArea should contain RenderScene.");this._gl=this.companion.get("gl"),this._canvas=this.companion.get("canvasElement"),this.hitareaTexture=new h.default(this._gl),this.hitareaRenderbuffer=new _.default(this._gl),this.hitareaFBO&&(this.hitareaFBO.destroy(),this.hitareaFBO=null)}},{key:"$resizeBuffer",value:function(e){var t=v.default.getPow2Size(e.width,e.height);this._bufferSize=[t.width,t.height],this.hitareaTexture.update(0,t.width,t.height,0,WebGLRenderingContext.RGBA,WebGLRenderingContext.UNSIGNED_BYTE),this.hitareaRenderbuffer.update(WebGLRenderingContext.DEPTH_COMPONENT16,t.width,t.height),this.hitareaFBO||(this.hitareaFBO=new c.default(this._gl),this.hitareaFBO.update(this.hitareaTexture),this.hitareaFBO.update(this.hitareaRenderbuffer));
}},{key:"$render",value:function(e){if(this._mouseInside){this.hitareaFBO.bind(),this._gl.viewport(0,0,this._bufferSize[0],this._bufferSize[1]),this._gl.clearColor(0,0,0,0),this._gl.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this._gl.clearDepth(1),this._gl.clear(WebGLRenderingContext.DEPTH_BUFFER_BIT),e.camera.renderScene({renderer:this._sceneRenderer,camera:e.camera,buffers:e.buffers,layer:this._sceneRenderer.layer,viewport:e.viewport,loopIndex:e.loopIndex,technique:"hitarea"}),this._gl.flush(),this._gl.readPixels(this._lastPosition[0]*this._bufferSize[0],this._lastPosition[1]*this._bufferSize[1],1,1,WebGLRenderingContext.RGBA,WebGLRenderingContext.UNSIGNED_BYTE,this._readCache);var t=l.default.fromColor(this._readCache);if(0===t)this._lastRenderable instanceof w.default&&this._lastRenderable.node.emit("mouseleave",this._lastRenderable),this._lastRenderable=null;else{var n=e.camera.containedScene.queueRegistory.getByIndex(t-1);this._lastRenderable!==n?(this._lastRenderable instanceof w.default&&this._lastRenderable.node.emit("mouseleave",this._lastRenderable),n instanceof w.default&&n.node.emit("mouseenter",n)):n instanceof w.default&&(this._mouseMoved?n.node.emit("mousemove",n):n.node.emit("mouseon",n)),this._lastRenderable=n}this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null)}}},{key:"$mousemove",value:function(e){this._lastPosition=[e.viewportNormalizedX,1-e.viewportNormalizedY],this._mouseMoved=!0}},{key:"$mouseenter",value:function(e){this._mouseInside=!0,this._lastPosition=[e.viewportNormalizedX,1-e.viewportNormalizedY],this._mouseMoved=!0}},{key:"$mouseleave",value:function(e){this._mouseInside=!1,this._lastPosition=[e.viewportNormalizedX,1-e.viewportNormalizedY],this._mouseMoved=!0,this._lastRenderable instanceof w.default&&this._lastRenderable.node.emit("mouseleave",this._lastRenderable),this._lastRenderable=null}}]),t}(w.default);t.default=E,E.attributes={}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(10),l=r(s),f=n(15),c=r(f),d=n(1),h=r(d),p=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$awake",value:function(){this.getAttributeRaw("targetBuffer").boundTo("_targetBuffer"),this.getAttributeRaw("clearColor").boundTo("_clearColor"),this.getAttributeRaw("clearColorEnabled").boundTo("_clearColorEnabled"),this.getAttributeRaw("clearDepthEnabled").boundTo("_clearDepthEnabled"),this.getAttributeRaw("clearDepth").boundTo("_clearDepth"),this.getAttributeRaw("technique").boundTo("_technique")}},{key:"$mount",value:function(){this._gl=this.companion.get("gl"),this._canvas=this.companion.get("canvasElement");var e=this.companion.get("GeometryRegistory");this._geom=e.getGeometry("quad"),this._materialContainer=this.node.getComponent(l.default)}},{key:"$bufferUpdated",value:function(e){var t=this.getAttribute("out");"default"!==t&&(this._fbo=new c.default(this.companion.get("gl")),this._fbo.update(e.buffers[t]),this._fboSize=e.bufferSizes[t]);var n=this.getAttribute("depthBuffer");n&&this._fbo&&this._fbo.update(e.buffers[n])}},{key:"$render",value:function(e){if(this._materialContainer.materialReady){this._fbo?(this._fbo.bind(),this._gl.viewport(0,0,this._fboSize.width,this._fboSize.height)):(this._gl.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null),this._gl.viewport(e.viewport.Left,this._canvas.height-e.viewport.Bottom,e.viewport.Width,e.viewport.Height)),this._fbo&&this._clearColorEnabled&&(this._gl.clearColor(this._clearColor.R,this._clearColor.G,this._clearColor.B,this._clearColor.A),this._gl.clear(WebGLRenderingContext.COLOR_BUFFER_BIT)),this._clearDepthEnabled&&(this._gl.clearDepth(this._clearDepth),this._gl.clear(WebGLRenderingContext.DEPTH_BUFFER_BIT));var t={targetBuffer:this._targetBuffer,geometry:this._geom,attributeValues:{},camera:null,transform:null,buffers:e.buffers,viewport:e.viewport,technique:this._technique};t.attributeValues=this._materialContainer.materialArgs,this._materialContainer.material.draw(t),this._gl.flush()}}}]),t}(h.default);t.default=p,p.attributes={out:{default:"default",converter:"String"},depthBuffer:{default:null,converter:"String"},targetBuffer:{default:"default",converter:"String"},clearColor:{default:"#0000",converter:"Color4"},clearColorEnabled:{default:!0,converter:"Boolean"},clearDepthEnabled:{default:!0,converter:"Boolean"},clearDepth:{default:1,converter:"Number"},technique:{default:"default",converter:"String"}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=r(s),f=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._buffers={},e._bufferSizes={},e._wasInside=!1,e}return a(t,e),u(t,[{key:"$awake",value:function(){var e=this;this.getAttributeRaw("camera").boundTo("camera"),this.getAttributeRaw("viewport").watch(function(t){e._viewportSizeGenerator=t,e.$resizeCanvas()}),this._viewportSizeGenerator=this.getAttribute("viewport"),this._mouseMoveHandler=function(t){e._isViewportInside(t)?(e._wasInside||(e.node.emit("mouseenter"),e.node.broadcastMessage("mouseenter",e._toViewportMouseArgs(t))),e.node.emit("mousemove"),e.node.broadcastMessage("mousemove",e._toViewportMouseArgs(t)),e._wasInside=!0):(e._wasInside&&(e.node.emit("mouseleave"),e.node.broadcastMessage("mouseleave",e._toViewportMouseArgs(t))),e._wasInside=!1)},this._mouseEnterHandler=function(t){e._isViewportInside(t)&&(e.node.emit("mouseenter"),e.node.broadcastMessage("mouseenter",e._toViewportMouseArgs(t)),e._wasInside=!0)},this._mouseLeaveHandler=function(t){e._wasInside&&(e.node.emit("mouseleave"),e.node.broadcastMessage("mouseleave",e._toViewportMouseArgs(t))),e._wasInside=!1}}},{key:"$mount",value:function(){var e=this;this._gl=this.companion.get("gl"),this._canvas=this.companion.get("canvasElement"),this.getAttributeRaw("handleMouse").watch(function(t){t?e._enableMouseHandling():e._disableMouseHandling()},!0)}},{key:"$treeInitialized",value:function(){this.$resizeCanvas()}},{key:"$resizeCanvas",value:function(){this._viewportCache=this._viewportSizeGenerator(this._canvas),0===this.node.children.length&&this.node.addChildByName("render-scene",{}),this.node.broadcastMessage("resizeBuffer",{width:this._viewportCache.Width,height:this._viewportCache.Height,buffers:this._buffers,bufferSizes:this._bufferSizes}),this.node.broadcastMessage("bufferUpdated",{buffers:this._buffers,bufferSizes:this._bufferSizes})}},{key:"$renderViewport",value:function(e){this.node.broadcastMessage("render",{camera:this.camera,viewport:this._viewportCache,bufferSizes:this._bufferSizes,buffers:this._buffers,loopIndex:e.loopIndex})}},{key:"_enableMouseHandling",value:function(){this._canvas.addEventListener("mousemove",this._mouseMoveHandler),this._canvas.addEventListener("mouseleave",this._mouseLeaveHandler),this._canvas.addEventListener("mouseenter",this._mouseEnterHandler)}},{key:"_disableMouseHandling",value:function(){this._canvas.removeEventListener("mousemove",this._mouseMoveHandler),this._canvas.removeEventListener("mouseleave",this._mouseLeaveHandler),this._canvas.removeEventListener("mouseenter",this._mouseEnterHandler)}},{key:"_isViewportInside",value:function(e){var t=this._getRelativePosition(e),n=this._viewportCache.toLocalNormalized(t[0],t[1]);return n[0]>=0&&n[0]<=1&&n[1]>=0&&n[1]<=1}},{key:"_getRelativePosition",value:function(e){var t=this._canvas.getBoundingClientRect(),n=t.left+window.pageXOffset,r=t.top+window.pageYOffset;return[e.pageX-n,e.pageY-r]}},{key:"_toViewportMouseArgs",value:function(e){var t=this._getRelativePosition(e),n=this._viewportCache.toLocal(t[0],t[1]),r=this._viewportCache.toLocalNormalized(t[0],t[1]);return Object.assign(e,{viewportX:n[0],viewportY:n[1],viewportNormalizedX:r[0],viewportNormalizedY:r[1]})}}]),t}(l.default);t.default=f,f.attributes={camera:{converter:"Component",default:"camera",target:"Camera"},viewport:{converter:"Viewport",default:"auto"},handleMouse:{converter:"Boolean",default:!0}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(88),l=r(s),f=n(23),c=r(f),d=n(1),h=r(d),p=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$awake",value:function(){this.getAttributeRaw("bgColor").boundTo("_bgColor"),this.getAttributeRaw("clearDepth").boundTo("_clearDepth")}},{key:"$mount",value:function(){this.gl=this.companion.get("gl")}},{key:"$treeInitialized",value:function(){this.node.getComponent(c.default).register(this.onloop.bind(this),1e3),this.getAttribute("complementRenderer")&&0===this.node.getChildrenByNodeName("renderer").length&&this.node.addChildByName("renderer",{})}},{key:"onloop",value:function(e){if(this.enabled){var t=this._bgColor;this.gl.clearColor(t.R,t.G,t.B,t.A),this.gl.clearDepth(this._clearDepth),this.gl.clear(WebGLRenderingContext.COLOR_BUFFER_BIT|WebGLRenderingContext.DEPTH_BUFFER_BIT),this.node.broadcastMessage(1,"renderViewport",{loopIndex:e})}}}]),t}(h.default);t.default=p,p.attributes={bgColor:{default:new l.default(0,0,0,0),converter:"Color4"},clearDepth:{default:1,converter:"Number"},complementRenderer:{default:!0,converter:"Boolean"}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(2),l=r(s),f=n(1),c=r(f),d=n(18),h=r(d),p=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$mount",value:function(){this.buffer=new l.default(this.companion.get("gl"))}},{key:"$unmount",value:function(){this.buffer.destroy(),this.buffer=null}},{key:"$resizeBuffer",value:function(e){var t=this.getAttribute("name");if(!t)throw new Error("Attribute 'name' must be specified.");var n=this.getAttribute("format"),r=this.getAttribute("type"),o=h.default.getPow2Size(e.width,e.height);this.buffer.update(0,o.width,o.height,0,n,r,null),e.bufferSizes[t]={width:o.width,height:o.height},e.buffers[t]=this.buffer}}]),t}(c.default);t.default=p,p.attributes={name:{converter:"String",default:null},format:{converter:"Enum",default:WebGLRenderingContext.RGBA,table:{RGBA:WebGLRenderingContext.RGBA,RGB:WebGLRenderingContext.RGB,ALPHA:WebGLRenderingContext.ALPHA,LUMINANCE:WebGLRenderingContext.LUMINANCE,LUMINANCE_ALPHA:WebGLRenderingContext.LUMINANCE_ALPHA,SRGB_EXT:WebGLRenderingContext.SRGB_EXT,SRGB_ALPHA_EXT:WebGLRenderingContext.SRGB_ALPHA_EXT,DEPTH_COMPONENT:WebGLRenderingContext.DEPTH_COMPONENT,DEPTH_STENCIL:WebGLRenderingContext.DEPTH_STENCIL}},type:{converter:"Enum",default:WebGLRenderingContext.UNSIGNED_BYTE,table:{UNSIGNED_BYTE:WebGLRenderingContext.UNSIGNED_BYTE,UNSIGNED_SHORT_5_6_5:WebGLRenderingContext.UNSIGNED_SHORT_5_6_5,UNSIGNED_SHORT_4_4_4_4:WebGLRenderingContext.UNSIGNED_SHORT_4_4_4_4,UNSIGNED_SHORT_5_5_5_1:WebGLRenderingContext.UNSIGNED_SHORT_5_5_5_1,UNSIGNED_SHORT:WebGLRenderingContext.UNSIGNED_SHORT,UNSIGNED_INT:WebGLRenderingContext.UNSIGNED_INT,FLOAT:WebGLRenderingContext.FLOAT}}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=r(s),f=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._time=0,e._startTime=0,e._lastFrame=0,e}return a(t,e),u(t,[{key:"$awake",value:function(){this._time=0,this._lastFrame=0,this._startTime=Date.now()}},{key:"$update",value:function(){var e=Date.now();e-this._startTime;this.setAttribute("time",e),this.setAttribute("timeDelta",e-this._lastFrame),this._lastFrame=e}}]),t}(l.default);t.default=f,f.attributes={time:{default:0,converter:"Number"},timeDelta:{default:0,converter:"Number"}}},function(e,t){"use strict";function n(e){if("fit"===e)return{mode:"fit"};if("string"==typeof e){var t=/aspect\(([\d+(?.\d*)?]+)\)/.exec(e);if(t)return{mode:"aspect",aspect:Number.parseFloat(t[1])}}return{mode:"manual",size:Number.parseFloat(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if("string"==typeof e)return t.companion.get("GeometryRegistory").getGeometry(e);if(e instanceof a.default)return e;throw new Error('Specified geometry "'+e+'" is not supported for converting into geometry.')}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=n(13),a=r(i)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if("string"==typeof e){var n=/\s*new\s*\(\s*([a-zA-Z\d\-]+)\s*\)/,r=void 0;if(r=n.exec(e))return t.component[t.declaration.componentBoundTo]=null,t.companion.get("MaterialFactory").instanciate(r[1]);var o=t.tree(e).first();if(o){var i=o.getComponent(a.default);return t.component[t.declaration.componentBoundTo]=i,i.materialPromise}return console.warn("There was no matching material component filtered by '"+e+"'"),null}return null}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=n(24),a=r(i)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){return null===e?null:e instanceof a.default?e:"string"==typeof e?t.component.node.tree(e).first():void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=n(95),a=r(i)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(94),i=r(o);t.default={name:"Position",lazy:!0,verify:function(e){return!0},convert:function(e,t){if(null===e)return null;if(t.convertContext._lastVal===e)return t.convertContext._node.getAttribute("position");t.convertContext._lastVal=null;try{var n=i.default.convert("Vector3",t,e);if(n)return n}catch(e){}return t.convertContext._node=i.default.convert("Node",t,e),t.convertContext._node?(t.convertContext._lastVal=e,t.convertContext._node.getAttribute("position")):void 0}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){e.update(t),requestAnimationFrame(function(){return o(e,t)})}function i(e){var t=/(query|backbuffer|video)\((.+)\)[^\)]*$/,n=void 0;return(n=t.exec(e))?{type:n[1],param:n[2]}:null}function a(e){var t=document.createElement("video");return t.src=e,t}function u(e,t){var n=new _.default(e);return t.play(),n.update(t),o(n,t),n}function s(e,t){if(e instanceof _.default)return new h.default(e);if("string"==typeof e){var n=i(e);if(n){var r=function(){var e=n.param,r=function(){switch(n.type){case"backbuffer":return{v:{v:new h.default(function(t){return t[e]})}};case"video":return{v:{v:new h.default(u(t.companion.get("gl"),a(e)))}};case"query":var r=t.tree(e),o=r.first().getComponent(c.default);return{v:{v:new h.default(function(){return o.texture})}}}}();if("object"===("undefined"==typeof r?"undefined":l(r)))return r.v}();if("object"===("undefined"==typeof r?"undefined":l(r)))return r.v}else{var o=function(){var n=new _.default(t.companion.get("gl"));return v.default.resolve(e).then(function(e){n.update(e)}),t.companion.get("loader").register(n.validPromise),{v:new h.default(n)}}();if("object"===("undefined"==typeof o?"undefined":l(o)))return o.v}}if("object"===("undefined"==typeof e?"undefined":l(e)))if(e instanceof HTMLImageElement){var s=function(){var n=new _.default(t.companion.get("gl"));return e.complete&&e.naturalWidth?n.update(e):e.onload=function(){n.update(e)},{v:new h.default(n)}}();if("object"===("undefined"==typeof s?"undefined":l(s)))return s.v}else{if(e instanceof HTMLCanvasElement){var f=new _.default(t.companion.get("gl"));return f.update(e),new h.default(f)}if(e instanceof HTMLVideoElement)return new h.default(u(t.companion.get("gl"),e))}return null}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=s;var f=n(26),c=r(f),d=n(62),h=r(d),p=n(2),_=r(p),b=n(22),v=r(b)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=/(\d+)\s*%/,r=void 0;if(r=n.exec(t)){var o=Number.parseFloat(r[1]);return Math.floor(e*o*.01)}return Math.floor(Number.parseFloat(t))}function i(e){if(e instanceof s.default)return function(){return e};if("string"==typeof e){if("auto"===e)return function(e){return new s.default(0,0,e.width,e.height)};var t=function(){var t=e.split(",");if(4!==t.length)throw new Error("Invalid viewport size was specified.");return{v:function(e){return new s.default(o(e.width,t[0]),o(e.height,t[1]),o(e.width,t[2]),o(e.height,t[3]))}}}();if("object"===("undefined"==typeof t?"undefined":a(t)))return t.v}throw new Error(e+" could not be parsed")}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=i;var u=n(90),s=r(u)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(13),u=r(a),s=n(80),l=r(s),f=n(8),c=r(f),d=n(55),h=r(d),p=n(14),_=r(p),b=new l.default;b.expand(new c.default(-1,-1,-1)),b.expand(new c.default(1,1,1));var v={POSITION:{size:3,stride:32},NORMAL:{size:3,stride:32,offset:12},TEXCOORD:{size:2,stride:32,offset:24}},m=function(){function e(){o(this,e)}return i(e,null,[{key:"register",value:function(){e._registerQuad(),e._registerCube(),e._registerSphere(),e._registerCircle(),e._registerCylinder(),e._registerCone(),e._registerPlane(),e._registerTriangle(),e._registerCapsule()}},{key:"_registerQuad",value:function(){_.default.addType("quad",{},function(e,t){var n=new u.default(e);return n.addAttributes(h.default.plane([0,0,0],[0,0,1],[0,1,0],[1,0,0],1,1),v),n.addIndex("default",h.default.planeIndex(0,1,1)),n.addIndex("wireframe",h.default.linesFromTriangles(h.default.planeIndex(0,1,1)),WebGLRenderingContext.LINES),n})}},{key:"_registerTriangle",value:function(){_.default.addType("triangle",{},function(e,t){var n=new u.default(e);return n.addAttributes(h.default.triangle([0,0,0],[0,0,1],[0,1,0],[1,0,0]),v),n.addIndex("default",h.default.triangleIndex(0)),n.addIndex("wireframe",h.default.linesFromTriangles(h.default.triangleIndex(0)),WebGLRenderingContext.LINES),n})}},{key:"_registerCone",value:function(){_.default.addType("cone",{divide:{converter:"Number",default:50}},function(e,t){for(var n=t.divide,r=new u.default(e),o=n%2!=0?Math.PI/n:0,i=[].concat.apply([],[h.default.circle([0,-.5,0],[0,-1,0],[-Math.sin(o),0,Math.cos(o)],[Math.cos(o),0,Math.sin(o)],n)]),a=Math.cos(Math.PI/n)/3,s=Math.sin(Math.PI/n)/Math.pow(3,.5)*2,l=Math.cos(Math.PI/n)-a,f=Math.PI/n,c=0;c<n;c++){var d=f*(2*c+1);Array.prototype.push.apply(i,h.default.coneTriangle([-Math.sin(d)*l,0,-Math.cos(d)*l],[-Math.cos(Math.PI/2-d),1,-Math.sin(Math.PI/2-d)],[Math.sin(d)*l,1,Math.cos(d)*l],[-Math.cos(d)*s,0,Math.sin(d)*s],n,c))}r.addAttributes(i,v);for(var p=n+2,_=[].concat.apply([],[h.default.circleIndex(0,n)]),b=0;b<n;b++)Array.prototype.push.apply(_,h.default.triangleIndex(p+3*b));return r.addIndex("default",_),r.addIndex("wireframe",h.default.linesFromTriangles(_),WebGLRenderingContext.LINES),r})}},{key:"_registerCylinder",value:function(){_.default.addType("cylinder",{divide:{converter:"Number",default:50}},function(e,t){for(var n=t.divide,r=new u.default(e),o=n%2!=0?Math.PI/n:0,i=[].concat.apply([],[h.default.circle([0,1,0],[0,1,0],[0,0,-1],[1,0,0],n),h.default.circle([0,-1,0],[0,-1,0],[-Math.sin(o),0,Math.cos(o)],[Math.cos(o),0,Math.sin(o)],n)]),a=Math.sin(Math.PI/n),s=Math.cos(Math.PI/n),l=Math.PI/n,f=0;f<n;f++){var c=l*(2*f+1);Array.prototype.push.apply(i,h.default.cylinderPlane([-Math.sin(c)*s,0,-Math.cos(c)*s],[-Math.sin(c),0,-Math.cos(c)],[0,1,0],[-Math.cos(c)*a,0,Math.sin(c)*a],n,f))}r.addAttributes(i,v);for(var d=n+2,p=[].concat.apply([],[h.default.circleIndex(0,n),h.default.circleIndex(d,n)]),_=0;_<n;_++)Array.prototype.push.apply(p,h.default.planeIndex(2*d+4*_,1,1));return r.addIndex("default",p),r.addIndex("wireframe",h.default.linesFromTriangles(p),WebGLRenderingContext.LINES),r})}},{key:"_registerCube",value:function(){_.default.addType("cube",{divHorizontal:{converter:"Number",default:1},divVertical:{converter:"Number",default:1}},function(e,t){var n=t.divHorizontal,r=t.divVertical,o=new u.default(e),i=[].concat.apply([],[h.default.plane([0,0,1],[0,0,1],[0,1,0],[1,0,0],n,r),h.default.plane([0,0,-1],[0,0,-1],[0,1,0],[-1,0,0],n,r),h.default.plane([0,1,0],[0,1,0],[0,0,-1],[1,0,0],n,r),h.default.plane([0,-1,0],[0,-1,0],[0,0,-1],[-1,0,0],n,r),h.default.plane([1,0,0],[1,0,0],[0,1,0],[0,0,-1],n,r),h.default.plane([-1,0,0],[-1,0,0],[0,1,0],[0,0,1],n,r)]);o.addAttributes(i,v);var a=(n+1)*(r+1),s=[].concat.apply([],[h.default.planeIndex(0,n,r),h.default.planeIndex(a,n,r),h.default.planeIndex(2*a,n,r),h.default.planeIndex(3*a,n,r),h.default.planeIndex(4*a,n,r),h.default.planeIndex(5*a,n,r)]);return o.addIndex("default",s),o.addIndex("wireframe",h.default.linesFromTriangles(s),WebGLRenderingContext.LINES),o})}},{key:"_registerSphere",value:function(){_.default.addType("sphere",{divVertical:{converter:"Number",default:50},divHorizontal:{converter:"Number",default:50}},function(e,t){var n=t.divHorizontal,r=t.divVertical,o=new u.default(e);return o.addAttributes(h.default.sphere([0,0,0],[0,1,0],[1,0,0],[0,0,-1],r,n),v),o.addIndex("default",h.default.sphereIndex(0,r,n)),o.addIndex("wireframe",h.default.linesFromTriangles(h.default.sphereIndex(0,r,n)),WebGLRenderingContext.LINES),o})}},{key:"_registerCapsule",value:function(){_.default.addType("capsule",{divide:{converter:"Number",default:50}},function(e,t){var n=t.divide,r=t.divide%2==1?t.divide+1:t.divide,o=new u.default(e);return o.addAttributes(h.default.capsule([0,0,0],[0,1,0],[1,0,0],[0,0,-1],r,n),v),o.addIndex("default",h.default.sphereIndex(0,r,n)),o.addIndex("wireframe",h.default.linesFromTriangles(h.default.sphereIndex(0,r,n)),WebGLRenderingContext.LINES),o})}},{key:"_registerCircle",value:function(){_.default.addType("circle",{divide:{converter:"Number",default:30}},function(e,t){var n=t.divide,r=new u.default(e);return r.addAttributes(h.default.circle([0,0,0],[0,0,1],[0,1,0],[1,0,0],n),v),r.addIndex("default",h.default.circleIndex(0,n)),r.addIndex("wireframe",h.default.linesFromTriangles(h.default.circleIndex(0,n)),WebGLRenderingContext.LINES),r})}},{key:"_registerPlane",value:function(){_.default.addType("plane",{divide:{converter:"Number",default:10}},function(e,t){var n=t.divide,r=t.divide,o=new u.default(e),i=[].concat.apply([],[h.default.plane([0,0,0],[0,0,1],[0,1,0],[1,0,0],n,r),h.default.plane([0,0,0],[0,0,-1],[0,1,0],[-1,0,0],n,r)]);o.addAttributes(i,v);var a=[].concat.apply([],[h.default.planeIndex(0,n,r),h.default.planeIndex((n+1)*(r+1),n,r)]);return o.addIndex("default",a),o.addIndex("wireframe",h.default.linesFromTriangles(a),WebGLRenderingContext.LINES),o})}}]),e}();t.default=m},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e)}return r(e,null,[{key:"linesFromTriangles",value:function(e){var t=[],n=new Array(3),r=0,o=!0,i=!1,a=void 0;try{for(var u,s=e[Symbol.iterator]();!(o=(u=s.next()).done);o=!0){var l=u.value;if(n[r%3]=l,r%3===2){var f=n[0],c=n[1],d=n[2];Array.prototype.push.apply(t,[f,c,c,d,d,f])}r++}}catch(e){i=!0,a=e}finally{try{!o&&s.return&&s.return()}finally{if(i)throw a}}return t}},{key:"plane",value:function(e,t,n,r){for(var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=new Array(8*(o+1)*(i+1)),u=[e[0]-n[0]-r[0],e[1]-n[1]-r[1],e[2]-n[2]-r[2]],s=[r[0]/o*2,r[1]/o*2,r[2]/o*2],l=[n[0]/i*2,n[1]/i*2,n[2]/i*2],f=0;f<i+1;f++)for(var c=0;c<o+1;c++){var d=8*((o+1)*f+c);a[d+0]=u[0]+s[0]*c+l[0]*f,a[d+1]=u[1]+s[1]*c+l[1]*f,a[d+2]=u[2]+s[2]*c+l[2]*f,a[d+3]=t[0],a[d+4]=t[1],a[d+5]=t[2],a[d+6]=1/o*c,a[d+7]=1-1/i*f}return a}},{key:"cylinderPlane",value:function(e,t,n,r,o,i){for(var a=new Array(32),u=[e[0]-n[0]-r[0],e[1]-n[1]-r[1],e[2]-n[2]-r[2]],s=[2*r[0],2*r[1],2*r[2]],l=[2*n[0],2*n[1],2*n[2]],f=0;f<2;f++)for(var c=0;c<2;c++){var d=8*(2*f+c);a[d+0]=u[0]+s[0]*c+l[0]*f,a[d+1]=u[1]+s[1]*c+l[1]*f,a[d+2]=u[2]+s[2]*c+l[2]*f;var h=Math.tan(Math.PI/o)/Math.sin(Math.PI/o);0==c?(a[d+3]=t[0]-h*r[0],a[d+4]=t[1]-h*r[1],a[d+5]=t[2]-h*r[2]):(a[d+3]=t[0]+h*r[0],a[d+4]=t[1]+h*r[1],a[d+5]=t[2]+h*r[2]),a[d+6]=1/o*(i+1+c),a[d+7]=0==f?1:0}return a}},{key:"triangle",value:function(e,t,n,r){for(var o=new Array(24),i=2*Math.PI/3,a=0;a<3;a++){var u=Math.sin(i*a),s=Math.cos(i*a);o[0+8*a]=e[0]+s*n[0]+u*r[0],o[1+8*a]=e[1]+s*n[1]+u*r[1],o[2+8*a]=e[2]+s*n[2]+u*r[2],o[3+8*a]=t[0],o[4+8*a]=t[1],o[5+8*a]=t[2],o[6+8*a]=.5+(s*n[0]+u*r[0])/2,o[7+8*a]=.5+(s*n[1]+u*r[1])/2}return o}},{key:"coneTriangle",value:function(e,t,n,r,o,i){for(var a=new Array(24),u=2*Math.PI/3,s=0;s<3;s++){var l=Math.sin(u*s),f=Math.cos(u*s);a[0+8*s]=e[0]+f*n[0]+l*r[0],a[1+8*s]=e[1]+f*n[1]+l*r[1],a[2+8*s]=e[2]+f*n[2]+l*r[2],a[3+8*s]=t[0],a[4+8*s]=t[1],a[5+8*s]=t[2];var c=Math.pow(2,.5),d=Math.tan(Math.PI/o)/Math.sin(Math.PI/o)/Math.pow(3,.5)*2;0==s?(a[3+8*s]=t[0],a[4+8*s]=t[1],a[5+8*s]=t[2],a[6+8*s]=0,a[7+8*s]=0):1==s?(a[3+8*s]=t[0]/c+d*r[0],a[4+8*s]=t[1]/c+d*r[1],a[5+8*s]=t[2]/c+d*r[2],a[6+8*s]=Math.cos(-Math.PI/o/2*(i+1)),a[7+8*s]=Math.sin(-Math.PI/o/2*(i+1))):(a[3+8*s]=t[0]/c-d*r[0],a[4+8*s]=t[1]/c-d*r[1],a[5+8*s]=t[2]/c-d*r[2],a[6+8*s]=Math.cos(-Math.PI/o/2*i),a[7+8*s]=Math.sin(-Math.PI/o/2*i))}return a}},{key:"triangleIndex",value:function(e){var t=new Array(3);return t[0]=e,t[1]=e+2,t[2]=e+1,t}},{key:"planeIndex",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=new Array(6*t*n),o=0;o<n;o++)for(var i=0;i<t;i++){var a=6*(t*o+i),u=e+(t+1)*o+i,s=e+(t+1)*(o+1)+i;r[a+0]=u,r[a+1]=u+1,r[a+2]=s,r[a+3]=s,r[a+4]=u+1,r[a+5]=s+1}return r}},{key:"circle",value:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5,i=new Array(6*(3+o));i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=t[0],i[4]=t[1],i[5]=t[2],i[6]=.5,i[7]=.5;for(var a=2*Math.PI/o,u=0;u<o+1;u++){var s=8+8*u,l=Math.sin(a*u),f=Math.cos(a*u);i[s+0]=e[0]+f*n[0]+l*r[0],i[s+1]=e[1]+f*n[1]+l*r[1],i[s+2]=e[2]+f*n[2]+l*r[2],i[s+3]=t[0],i[s+4]=t[1],i[s+5]=t[2],i[s+6]=.5+.5*l,i[s+7]=.5-.5*f}return i}},{key:"circleIndex",value:function(e,t){for(var n=new Array(3*t),r=0;r<t;r++)n[3*r+0]=e,n[3*r+1]=e+(r+2),n[3*r+2]=e+(r+1);return n}},{key:"capsule",value:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3,a=new Array(8*(o*i+2));a[0]=e[0]+2*t[0],a[1]=e[1]+2*t[1],a[2]=e[2]+2*t[2],a[3]=t[0],a[4]=t[1],a[5]=t[2],a[6]=0,a[7]=0,a[8]=e[0]-2*t[0],a[9]=e[1]-2*t[1],a[10]=e[2]-2*t[2],a[11]=-t[0],a[12]=-t[1],a[13]=-t[2],a[14]=0,
a[15]=1;for(var u=Math.PI/(o+1),s=2*Math.PI/i,l=0;l<o;l++)for(var f=Math.cos((l+1)*u),c=Math.sin((l+1)*u),d=u*l,h=0;h<i+1;h++){var p=Math.cos(h*s),_=Math.sin(h*s),b=16+8*(l*(i+1)+h);a[b+0]=e[0]+f*t[0]+c*(r[0]*p+n[0]*_),a[b+1]=e[1]+f*t[1]+c*(r[1]*p+n[1]*_),a[b+2]=e[2]+f*t[2]+c*(r[2]*p+n[2]*_),a[b+3]=e[0]+f*t[0]+c*(r[0]*p+n[0]*_),a[b+4]=e[1]+f*t[1]+c*(r[1]*p+n[1]*_),a[b+5]=e[2]+f*t[2]+c*(r[2]*p+n[2]*_);var v=s*h;a[b+6]=v/Math.PI/2,a[b+7]=d/Math.PI,a[b+0]=a[b+0]>0?a[b+0]+t[0]:a[b+0]-t[0],a[b+1]=a[b+1]>0?a[b+1]+t[1]:a[b+1]-t[1],a[b+2]=a[b+2]>0?a[b+2]+t[2]:a[b+2]-t[2]}return a}},{key:"sphere",value:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3,a=new Array(8*(o*i+2));a[0]=e[0]+t[0],a[1]=e[1]+t[1],a[2]=e[2]+t[2],a[3]=t[0],a[4]=t[1],a[5]=t[2],a[6]=0,a[7]=0,a[8]=e[0]-t[0],a[9]=e[1]-t[1],a[10]=e[2]-t[2],a[11]=-t[0],a[12]=-t[1],a[13]=-t[2],a[14]=0,a[15]=1;for(var u=Math.PI/(o+1),s=2*Math.PI/i,l=0;l<o;l++)for(var f=Math.cos((l+1)*u),c=Math.sin((l+1)*u),d=u*l,h=0;h<i+1;h++){var p=Math.cos(h*s),_=Math.sin(h*s),b=16+8*(l*(i+1)+h);a[b+0]=e[0]+f*t[0]+c*(r[0]*p+n[0]*_),a[b+1]=e[1]+f*t[1]+c*(r[1]*p+n[1]*_),a[b+2]=e[2]+f*t[2]+c*(r[2]*p+n[2]*_),a[b+3]=e[0]+f*t[0]+c*(r[0]*p+n[0]*_),a[b+4]=e[1]+f*t[1]+c*(r[1]*p+n[1]*_),a[b+5]=e[2]+f*t[2]+c*(r[2]*p+n[2]*_);var v=s*h;a[b+6]=v/Math.PI/2,a[b+7]=d/Math.PI}return a}},{key:"sphereIndex",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=new Array(n*t*6),o=function(t,r){return e+(n+1)*r+2+t},i=e,a=e+1,u=0;u<n;u++)r[3*u+0]=i,r[3*u+1]=o(u+1,0),r[3*u+2]=o(u,0);for(var s=3*n,l=0;l<t-1;l++)for(var f=0;f<n;f++)r[6*(n*l+f)+s]=o(f,l),r[6*(n*l+f)+s+1]=o(f+1,l),r[6*(n*l+f)+s+2]=o(f,l+1),r[6*(n*l+f)+s+3]=o(f,l+1),r[6*(n*l+f)+s+4]=o(f+1,l),r[6*(n*l+f)+s+5]=o(f+1,l+1);for(var c=n*(t-1)*6+s,d=0;d<n;d++)r[3*d+c+0]=a,r[3*d+c+1]=o(d,t-1),r[3*d+c+2]=o(d+1,t-1);return r}}]),e}();t.default=o},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={GRIMOIRE:null,WEBGL_VERSION:"1"}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(5),u=r(a),s=n(97),l=r(s),f=function(){function e(){o(this,e)}return i(e,null,[{key:"register",value:function(){u.default.addSORTMaterial("unlit",l.default)}}]),e}();t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(56),u=r(a),s=function(){function e(){o(this,e),this._macro={},this._observers={};for(var t in u.default)this.setValue(t,u.default[t])}return i(e,[{key:"setValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null===t&&(t=""),this._macro[e]!==t&&(this._macro[e]=t,this._observers[e]||(this._observers[e]=[]),this._notifyMacroChanged(e,t))}},{key:"getValue",value:function(e){var t=this._macro[e];return null===t?"":t}},{key:"watch",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this._observers[e];r||(r=this._observers[e]=[]),r.push(t),n&&void 0!==this._macro[e]&&t(this._macro[e],!0)}},{key:"unwatch",value:function(e,t){var n=this._observers[e];if(!n)return!1;for(var r=0;r<n.length;r++)if(n[r]===t)return n.splice(r,1),!0}},{key:"_notifyMacroChanged",value:function(e,t){for(var n=0;n<this._observers[e].length;n++)this._observers[e][n](t,!1)}}]),e}();t.default=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(61),u=r(a),s=function(){function e(t,n){o(this,e),this.gl=t,this.techniqueRecipes=n,this.argumentDeclarations={},this.arguments={},this.macroDeclarations={},this.techniques={},this._macroObserver={};for(var r in n)this.techniques[r]=new u.default(this,n[r])}return i(e,[{key:"draw",value:function(e){var t=this.techniques[e.technique];t&&t.draw(e)}},{key:"addMacroObserver",value:function(e,t,n){this._macroObserver[e]||(this._macroObserver[e]=[]),this._macroObserver[e].push(n),this.macroDeclarations[e]=t}},{key:"setMacroValue",value:function(e,t){this._macroObserver[e]&&this._macroObserver[e].forEach(function(e){return e(t)})}},{key:"addArgument",value:function(e,t){this.argumentDeclarations[e]=t}},{key:"deleteArgument",value:function(e){delete this.argumentDeclarations[e]}}]),e}();t.default=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(65),u=r(a),s=n(66),l=r(s),f=n(5),c=r(f),d=n(13),h=r(d),p=n(6),_=r(p),b=n(81),v=r(b),m=function(){function e(t,n){var r=this;o(this,e),this.material=t,this.passRecipe=n,this._macro={};var i=_.default.generateRegisterers(t,n);this._registers=i.registerers,this._disposers=i.disposers,this._gl=t.gl;var a=c.default.get(this._gl),u=a.macro,s=function(e){var t=n.macros[e];r._macro[t.macroName]=t.value,"expose"===t.target?r.material.addMacroObserver(e,{converter:"bool"===t.type?"Boolean":"Number",default:t.value},function(e){"bool"===t.type?r._macro[t.macroName]=e?"":void 0:r._macro[t.macroName]=e,r._updateProgram()}):"refer"===t.target&&(r._macro[t.macroName]=t.value,u.watch(t.macroName,function(e,n){r._macro[t.macroName]=e,n||r._updateProgram()},!0))};for(var l in n.macros)s(l);this._updateProgram(),this._disables=e._glEnableTargets.concat();for(var f=0;f<n.states.enable.length;f++){var d=n.states.enable[f],h=this._disables.indexOf(d);h>-1&&this._disables.splice(h,1)}}return i(e,[{key:"draw",value:function(e){this.program.use();for(var t=0;t<this._registers.length;t++)this._registers[t](this.program.uniforms,e);this._configure();for(var n in this.passRecipe.attributes){var r=this.passRecipe.attributes[n];h.default.bindBufferToAttribute(e.geometry,this.program,n,r.semantic)}h.default.drawWithCurrentVertexBuffer(e.geometry,e.targetBuffer,e.drawCount,e.drawOffset)}},{key:"dispose",value:function(){for(var e=0;e<this._disposers.length;e++)this._disposers[e]()}},{key:"_configure",value:function(){for(var e=this.passRecipe.states,t=this.passRecipe.states.functions,n=0;n<e.enable.length;n++)this._gl.enable(e.enable[n]);for(var r=0;r<this._disables.length;r++)this._gl.disable(this._disables[r]);t.blendColor&&this._gl.blendColor(t.blendColor[0],t.blendColor[1],t.blendColor[2],t.blendColor[3]),t.blendEquationSeparate&&this._gl.blendEquationSeparate(t.blendEquationSeparate[0],t.blendEquationSeparate[1]),t.blendFuncSeparate&&this._gl.blendFuncSeparate(t.blendFuncSeparate[0],t.blendFuncSeparate[1],t.blendFuncSeparate[2],t.blendFuncSeparate[3]),t.colorMask&&this._gl.colorMask(t.colorMask[0],t.colorMask[1],t.colorMask[2],t.colorMask[3]),t.cullFace&&this._gl.cullFace(t.cullFace[0]),t.depthFunc&&this._gl.depthFunc(t.depthFunc[0]),t.depthMask&&this._gl.depthMask(t.depthMask[0]),t.depthRange&&this._gl.depthRange(t.depthRange[0],t.depthRange[1]),t.frontFace&&this._gl.frontFace(t.frontFace[0]),t.lineWidth&&this._gl.lineWidth(t.lineWidth[0]),t.polygonOffset&&this._gl.polygonOffset(t.polygonOffset[0],t.polygonOffset[1]),t.scissor&&this._gl.scissor(t.scissor[0],t.scissor[1],t.scissor[2],t.scissor[3])}},{key:"_updateProgram",value:function(){var e=this.fs;this.fs=l.default.getShader(this._gl,WebGLRenderingContext.FRAGMENT_SHADER,this._generateShaderCode("FS"));var t=this.vs;this.vs=l.default.getShader(this._gl,WebGLRenderingContext.VERTEX_SHADER,this._generateShaderCode("VS")),e&&t&&(e.release(),t.release());var n=this.program;this.program=u.default.getProgram(this._gl,[this.vs,this.fs]),n&&n.release()}},{key:"_generateShaderCode",value:function(e){return"#define "+e+"\n"+this._macroCode()+"\n"+v.default+"/*BEGINNING OF USER CODE*/\n"+("VS"===e?this.passRecipe.vertex:this.passRecipe.fragment)}},{key:"_macroCode",value:function(){var e="";for(var t in this._macro)e+="#define "+t+" "+this._macro[t]+"\n";return e}}]),e}();t.default=m,m._glEnableTargets=[WebGLRenderingContext.CULL_FACE,WebGLRenderingContext.DEPTH_TEST,WebGLRenderingContext.STENCIL_TEST,WebGLRenderingContext.BLEND,WebGLRenderingContext.SCISSOR_TEST,WebGLRenderingContext.DITHER,WebGLRenderingContext.POLYGON_OFFSET_FILL,WebGLRenderingContext.SAMPLE_ALPHA_TO_COVERAGE,WebGLRenderingContext.SAMPLE_COVERAGE]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(60),u=r(a),s=function(){function e(t,n){o(this,e),this.material=t,this.passes=[],"Auto"===n.drawOrder?this.drawOrder="UseAlpha":this.drawOrder=n.drawOrder,this.passes=n.passes.map(function(e){return new u.default(t,e)})}return i(e,[{key:"draw",value:function(e){for(var t=0;t<this.passes.length;t++)this.passes[t].draw(e)}},{key:"dispose",value:function(){this.passes.forEach(function(e){return e.dispose()})}}]),e}();t.default=s},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){n(this,e),this.rawResource=t,this._isFunctionalProxy="function"==typeof t}return r(e,[{key:"get",value:function(e){return this._isFunctionalProxy?this.rawResource(e):this.rawResource}}]),e}();t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(3),f=r(l),c=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:WebGLRenderingContext.ARRAY_BUFFER,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:WebGLRenderingContext.STATIC_DRAW;o(this,t);var a=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.target=n,a.usage=r,a.buffer=e.createBuffer(),a}return a(t,e),u(t,[{key:"update",value:function(e,t){this.bind(),t?(this.valid||this.gl.bufferData(this.target,e+t.byteLength,this.usage),this.gl.bufferSubData(this.target,e,t)):"number"==typeof e?this.gl.bufferData(this.target,e,this.usage):this.gl.bufferData(this.target,e,this.usage),this.valid=!0}},{key:"bind",value:function(){this.gl.bindBuffer(this.target,this.buffer)}},{key:"destroy",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.gl.deleteBuffer(this.buffer)}}]),t}(f.default);t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(5),u=r(a),s=function(){function e(t){o(this,e),this.gl=t,this.extensions={},this._readyExtensions={},this._resolveRequested(),e._requestObserver.push(this._resolveExtensionSafely)}return i(e,[{key:"_resolveRequested",value:function(){var t=this;e._requestedExtensions.forEach(function(e){t._resolveExtensionSafely(e.extensionName)})}},{key:"_resolveExtensionSafely",value:function(t){var n=e._requestedExtensions[e._requestIndexOf(t)];if(!this._resolveExtension(n.extensionName)&&n.isNecessary)throw new Error("A WebGL extension '"+n.extensionName+"' was requested. But that is not supported on this device.")}},{key:"_resolveExtension",value:function(t){if(this._readyExtensions[t])return!0;var n=void 0;return n="undefined"==typeof e._customExtensionResolvers[t]?this.extensions[t]=this.gl.getExtension(t):this.extensions[t]=e._customExtensionResolvers[t](this.gl),this._readyExtensions[t]=void 0!==this.extensions[t],n&&u.default.get(this.gl).macro.setValue(t.toUpperCase(),""),!!this._readyExtensions[t]}}],[{key:"request",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e._requestIndexOf(t);r>-1&&n?e._requestedExtensions[r]={extensionName:t,isNecessary:n}:r===-1&&e._requestedExtensions.push({extensionName:t,isNecessary:n}),e._requestObserver.forEach(function(e){return e(t)})}},{key:"_requestIndexOf",value:function(t){for(var n=0;n<e._requestedExtensions.length;n++)if(e._requestedExtensions[n].extensionName===t)return n;return-1}}]),e}();t.default=s,s._requestedExtensions=[],s._customExtensionResolvers={},s._requestObserver=[],s._customExtensionResolvers.WEBGL_color_buffer_float=function(e){var t=void 0;if(null===e.getExtension("WEBGL_color_buffer_float")){var n=e.createFramebuffer(),r=e.createTexture();e.bindFramebuffer(e.FRAMEBUFFER,n),e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.FLOAT,null),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0),t=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE,e.deleteTexture(r),e.deleteFramebuffer(n)}else t=!0;return t}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(17),l=r(s),f=n(67),c=r(f),d=function(e){function t(e,n){o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.hash=n,r._referenceCount=0,r}return a(t,e),u(t,[{key:"release",value:function(){this._referenceCount--,0===this._referenceCount&&(this.destroy(),t._managedPrograms.get(this.gl)[this.hash]=void 0)}}],[{key:"getProgram",value:function(e,n){t._managedPrograms.has(e)||t._managedPrograms.set(e,{});var r=t._managedPrograms.get(e),o="";n=n.sort(),n.forEach(function(e){o+=e.index+","});var i=l.default.calcHash(o);return void 0===r[i]&&(r[i]=new t(e,i),r[i].update(n)),r[i]._referenceCount++,r[i]}}]),t}(c.default);t.default=d,d._managedPrograms=new Map},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(17),l=r(s),f=n(69),c=r(f),d=function(e){function t(e,n,r,a){o(this,t);var u=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,r));return u.type=n,u.sourceCode=r,u.hash=a,u._referenceCount=0,u}return a(t,e),u(t,[{key:"release",value:function(){this._referenceCount--,0===this._referenceCount&&(this.destroy(),t._managedShaders.get(this.gl)[this.hash]=void 0)}}],[{key:"getShader",value:function(e,n,r){t._managedShaders.has(e)||t._managedShaders.set(e,{});var o=t._managedShaders.get(e),i=l.default.calcHash(r+n);return void 0===o[i]&&(o[i]=new t(e,n,r,i)),o[i]._referenceCount++,o[i]}}]),t}(c.default);t.default=d,d._managedShaders=new Map},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(68),f=r(l),c=n(70),d=r(c),h=n(3),p=r(h),_=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._uniformLocations={},n._attributeLocations={},n.uniforms=new d.default(n),n.program=e.createProgram(),n}return a(t,e),u(t,[{key:"update",value:function(e){var t=this;if(this.valid){var n=this.gl.getAttachedShaders(this.program);n.forEach(function(e){return t.gl.detachShader(t.program,e)})}if(this._uniformLocations={},this._attributeLocations={},e.forEach(function(e){t.gl.attachShader(t.program,e.shader)}),this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,WebGLRenderingContext.LINK_STATUS)){var r=this.gl.getProgramInfoLog(this.program);throw new Error("LINK FAILED\n"+r)}this.valid=!0}},{key:"use",value:function(){this.isLastUsed||this.gl.useProgram(this.program),this.uniforms.onUse()}},{key:"destroy",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.gl.deleteProgram(this.program),this._uniformLocations={},this._attributeLocations={}}},{key:"findAttributeLocation",value:function(e){return void 0===this._attributeLocations[e]?(this._attributeLocations[e]=this.gl.getAttribLocation(this.program,e),this._safeEnableVertexAttribArray(this._attributeLocations[e]),this._attributeLocations[e]):this._attributeLocations[e]}},{key:"findUniformLocation",value:function(e){var t=this._uniformLocations[e];return void 0===t?this._uniformLocations[e]=this.gl.getUniformLocation(this.program,e):t}},{key:"_safeEnableVertexAttribArray",value:function(e){e<0||this.gl.enableVertexAttribArray(e)}},{key:"isLastUsed",get:function(){return f.default.useProgramCheck(this.gl,this.program)}}]),t}(p.default);t.default=_},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=t.ResourceCache=function(){function e(){n(this,e),this._lastUsedPrograms=new Map}return r(e,[{key:"useProgramCheck",value:function(e,t){return this._lastUsedPrograms.get(e)===t||(this._lastUsedPrograms.set(e,t),!1)}}]),e}();t.default=new o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(3),f=r(l),c=function(e){function t(e,n,r){o(this,t);var a=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.type=n,a.sourceCode=r,a.shader=e.createShader(n),r&&a.update(r),a}return a(t,e),u(t,[{key:"update",value:function(e){if(this.gl.shaderSource(this.shader,e),this.gl.compileShader(this.shader),!this.gl.getShaderParameter(this.shader,WebGLRenderingContext.COMPILE_STATUS))throw new Error("Compiling shader failed.\nSourceCode:\n"+this._insertLineNumbers(e)+"\n\nErrorCode:"+this.gl.getShaderInfoLog(this.shader));this.sourceCode=e,this.valid=!0}},{key:"destroy",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.gl.deleteShader(this.shader)}},{key:"_insertLineNumbers",value:function(e){e="1:"+e;for(var t=2,n=0;n<e.length;n++){var r=e.charAt(n);"\n"===r&&(e=e.substring(0,n+1)+(t+":")+e.substring(n+1,e.length),n++,t++)}return e}}]),t}(f.default);t.default=c},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=new Float32Array(9),i=function(){function e(t){n(this,e),this.program=t,this._currentTextureRegister=0,this._gl=t.gl}return r(e,[{key:"uniformBool",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform1i(e,t?1:0)})}},{key:"uniformMatrix",value:function(e,t){var n=this;this._pass(e,function(e){n._gl.uniformMatrix4fv(e,!1,t.rawElements)})}},{key:"uniformMatrix3",value:function(e,t){var n=this;this._pass(e,function(e){for(var r=t.rawElements,i=0;i<3;i++)o[3*i+0]=r[4*i+0],o[3*i+1]=r[4*i+1],o[3*i+2]=r[4*i+2];n._gl.uniformMatrix3fv(e,!1,o)})}},{key:"uniformMatrixArray",value:function(e,t){for(var n=this,r=t.length/16,o=function(r){n._passAsArray(e,r,function(e){return n._gl.uniformMatrix4fv(e,!1,new Float32Array(t.buffer,t.byteOffset+64*r))})},i=0;i<r;i++)o(i)}},{key:"uniformFloat",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform1f(e,t)})}},{key:"uniformFloatArray",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform1fv(e,t)})}},{key:"uniformInt",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform1i(e,t)})}},{key:"uniformVector2",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform2f(e,t.X,t.Y)})}},{key:"uniformIntVector2",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform2i(e,t.X,t.Y)})}},{key:"uniformVector2Array",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform2fv(e,t)})}},{key:"uniformVector3",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform3f(e,t.X,t.Y,t.Z)})}},{key:"uniformIntVector3",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform3i(e,t.X,t.Y,t.Z)})}},{key:"uniformVector3Array",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform3fv(e,t)})}},{key:"uniformColor3",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform3f(e,t.R,t.G,t.B)})}},{key:"uniformVector4",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform4f(e,t.X,t.Y,t.Z,t.W)})}},{key:"uniformIntVector4",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform4f(e,t.X,t.Y,t.Z,t.W)})}},{key:"uniformVector4Array",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform4fv(e,t)})}},{key:"uniformColor4",value:function(e,t){var n=this;this._pass(e,function(e){return n._gl.uniform4f(e,t.R,t.G,t.B,t.A)})}},{key:"uniformTexture2D",value:function(e,t){t.valid?(t.register(this._currentTextureRegister),this.uniformInt(e,this._currentTextureRegister),this._currentTextureRegister++):console.warn("The texture assigned to '"+e+"' is not valid.")}},{key:"onUse",value:function(){this._currentTextureRegister=0}},{key:"_pass",value:function(e,t){var n=this.program.findUniformLocation(e);n&&t(n)}},{key:"_passAsArray",value:function(e,t,n){var r=this.program.findUniformLocation(e+"["+t+"]");r&&n(r)}}]),e}();t.default=i},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={Background:{priorty:1e3},NoAlpha:{priorty:2e3},UseAlpha:{priorty:3e3,descending:!0},NoDepth:{priorty:4e3,descending:!0},Overlay:{priorty:5e3,descending:!0}}},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e),this._rendeables=[]}return r(e,[{key:"add",value:function(e){this._rendeables.push({rendarable:e,priortyCache:Number.MIN_VALUE})}},{key:"remove",value:function(e){for(var t=0;t<this._rendeables.length;t++){var n=this._rendeables[t];if(n.rendarable.index===e.index)break}this._rendeables.length!==t&&this._rendeables.splice(t,1)}},{key:"renderAll",value:function(e,t,n){for(var r=0;r<this._rendeables.length;r++)this._rendeables[r].priortyCache=this._rendeables[r].rendarable.getRenderingPriorty(e.camera,t,this._rendeables[r].priortyCache);this._rendeables.sort(function(e,t){return e.priortyCache-t.priortyCache}),this._rendeables.forEach(function(t){t.rendarable.render(e)})}}]),e}();t.default=o},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e),this._queues=[],this._renderables=[]}return r(e,[{key:"registerQueue",value:function(e){this._queues.push(e),this._renderables.forEach(function(t){return e.add(t)})}},{key:"unregisterQueue",value:function(e){var t=this._queues.indexOf(e);t>-1&&this._queues.splice(t,1)}},{key:"addRenderable",value:function(e){this._renderables.push(e),this._queues.forEach(function(t){return t.add(e)}),e.setRenderableIndex(this._renderables.length)}},{key:"removeRenderable",value:function(e){var t=this._renderables.indexOf(e);t!==-1&&(this._renderables.splice(t,1),this._renderables.forEach(function(e,t){e.setRenderableIndex(t+1)}),this._queues.forEach(function(t){return t.remove(e)}))}},{key:"getByIndex",value:function(e){return this._renderables[e]}}]),e}();t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ImportResolver=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);
return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(20),f=r(l),c=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},d=t.ImportResolver=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,function(e){var n=/^https?:\/\/.*/gm;return n.test(e)?t._toAbsolute(e):e}));return e.staticImports={},e}return a(t,e),u(t,[{key:"resolve",value:function(e){var n=this;return s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"resolve",this).call(this,e,function(t){return n._resolve(e)})}},{key:"_resolve",value:function(e){return c(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.staticImports[e]){t.next=4;break}return t.abrupt("return",this.staticImports[e]);case 4:return t.next=6,this._fromExternal(e);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}},t,this)}))}},{key:"_fromExternal",value:function(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",e),r.onload=function(e){t(r.responseText)},r.onerror=function(e){n(e)},r.send()})}}],[{key:"_toAbsolute",value:function(e){var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host+t.pathname+t.search+t.hash}}]),t}(f.default);t.default=new d},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={attribute:{position:"POSITION",normal:"NORMAL",texCoord:"TEXCOORD"},uniform:{_time:"TIME",_viewportSize:"VIEWPORT_SIZE",_matL:"LOCAL",_matM:"MODEL",_matV:"VIEW",_matP:"PROJECTION",_matVM:"MODELVIEW",_matPVM:"MODELVIEWPROJECTION",_matIM:"MODELINVERSE",_matIV:"VIEWINVERSE",_matIP:"PROJECTIONINVERSE",_matIVM:"MODELVIEWINVERSE",_matIPVM:"MODELVIEWPROJECTIONINVERSE",_matITM:"MODELINVERMousETRANSPOSE",_matITVM:"MODELVIEWINVERSETRANSPOSE"}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(17),u=r(a),s=n(78),l=r(s),f=function(){function e(){o(this,e)}return i(e,null,[{key:"parse",value:function(t){var n=u.default.calcHash(t);return void 0!==e._parsedCache[n]?new Promise(function(t,r){t(e._parsedCache[n])}):e._parse(t).then(function(n){return e._parsedCache[t]=n,n})}},{key:"_parse",value:function(t){return new Promise(function(n,r){var o={};l.default.resolveImports(l.default.removeComment(t)).then(function(t){try{var i=l.default.separateTechniqueSource(t);for(var a in i)o[a]=e._parseTechnique(i[a]);n(o)}catch(e){r(e)}})})}},{key:"_parseTechnique",value:function(t){for(var n=l.default.fetchDrawOrder(t)||"Auto",r=l.default.separatePassSource(t),o=new Array(r.length),i=0;i<r.length;i++)o[i]=e._parsePassSource(r[i]);return{drawOrder:n,passes:o}}},{key:"_parsePassSource",value:function(e){var t=l.default.removePreferences(e),n=l.default.parseVariables(e,"attribute"),r=l.default.parseVariables(e,"uniform"),o=l.default.parseMacros(e),i=l.default.parsePreferences(e);return{fragment:t,vertex:t,attributes:n,uniforms:r,macros:o,states:i}}}]),e}();f._parsedCache={},t.default=f},function(e,t){"use strict";function n(e,t){if(e.length!==t)throw new Error("Unmatching argument count on preference parse");return e.map(function(e){var t=WebGLRenderingContext[e];if("number"!=typeof t)throw new Error("Unknown WebGL constant "+e+" was specified");return t})}function r(e,t){if(e.length!==t)throw new Error("Unmatching argument count on preference parse");return e.map(function(e){var t=Number.parseFloat(e);if(isNaN(t))throw new Error("Failed to parse number on preference parsing");return t})}function o(e,t){if(e.length!==t)throw new Error("Unmatching argument count on preference parse");return e.map(function(e){if("true"!==e&&"false"!==e)throw new Error(e+" is not boolean");return"true"===e})}Object.defineProperty(t,"__esModule",{value:!0}),t.default={Enable:function(e,t){var n=WebGLRenderingContext[t[0]];if("number"!=typeof n)throw new Error('Unknown WebGL constant "'+t[0]+'" was specified on @Enable');e.enable.push(n)},Disable:function(e,t){var n=WebGLRenderingContext[t[0]];if("number"!=typeof n)throw new Error('Unknown WebGL constant "'+t[0]+'" was specified on @Disable');var r=e.enable.indexOf(n);r!==r&&e.enable.splice(r,1)},BlendFunc:function(e,t){var r=n(t,2);e.functions.blendFuncSeparate=[r[0],r[1],r[0],r[1]]},BlendFuncSeparate:function(e,t){e.functions.blendFuncSeparate=n(t,4)},BlendEquation:function(e,t){var r=n(t,1);e.functions.blendEquationSeparate=[r[0],r[0]]},BlendEquationSeparate:function(e,t){e.functions.blendEquationSeparate=n(t,4)},BlendColor:function(e,t){e.functions.blendColor=r(t,4)},ColorMask:function(e,t){e.functions.colorMask=o(t,4),e.enable.push(WebGLRenderingContext.COLOR_WRITEMASK)},CullFace:function(e,t){e.functions.cullFace=n(t,1)},DepthFunc:function(e,t){e.functions.depthFunc=n(t,1)},DepthRange:function(e,t){e.functions.depthRange=r(t,2)},FrontFace:function(e,t){e.functions.frontFace=n(t,1)},LineWidth:function(e,t){e.functions.lineWidth=r(t,1)},PolygonOffset:function(e,t){e.functions.polygonOffset=r(t,2),e.enable.push(WebGLRenderingContext.POLYGON_OFFSET_FILL)},Scissor:function(e,t){e.functions.scissor=r(t,4),e.enable.push(WebGLRenderingContext.SCISSOR_TEST)},ExposeMacro:function(){},ReferMacro:function(){}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(77),u=r(a),s=n(79),l=r(s),f=n(75),c=r(f),d=n(74),h=r(d),p=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},_=function(){function e(){o(this,e)}return i(e,null,[{key:"separateTechniqueSource",value:function(t){if(t.indexOf("@Technique")===-1)return{default:t};for(var n={},r=/@Technique\s+([a-zA-Z0-9_]+)/g,o=void 0;o=r.exec(t);){var i=o[1];if(void 0!==n[i])throw new Error("Technique name "+i+" is dupelicated");n[i]=e.obtainNextSection(t,"{","}",o.index+o.length)}return n}},{key:"separatePassSource",value:function(t){if(t.indexOf("@Pass")===-1)return[t];for(var n=[],r=/@Pass/g,o=void 0;o=r.exec(t);)n.push(e.obtainNextSection(t,"{","}",o.index+o.length));return n}},{key:"fetchDrawOrder",value:function(e){var t=/@DrawOrder\s*\((\w+)\)/g.exec(e);if(t){var n=e.indexOf("@Pass");if(n!==-1&&n<t.index)throw new Error("DrawOrder preference should be just under @Technique section");return t[1]}return null}},{key:"removePreferences",value:function(e){var t=/@.+$/gm;return e.replace(t,"")}},{key:"resolveImports",value:function(t){return p(this,void 0,void 0,regeneratorRuntime.mark(function n(){var r,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=/\s*@import\s+"([^"]+)"/.exec(t)){n.next=4;break}return n.abrupt("break",17);case 4:return o=void 0,n.t0=e,n.next=8,h.default.resolve(r[1]);case 8:return n.t1=n.sent,n.next=11,n.t0.resolveImports.call(n.t0,n.t1);case 11:if(o=n.sent){n.next=14;break}throw new Error("Required shader chunk '"+r[1]+"' was not found!!");case 14:t=t.replace(r[0],"\n"+o+"\n"),n.next=0;break;case 17:return n.abrupt("return",t);case 18:case"end":return n.stop()}},n,this)}))}},{key:"parseMacros",value:function(e){for(var t={},n=/@ExposeMacro\s*\(\s*([a-zA-Z0-9_]+)\s*,\s*([a-zA-Z0-9_]+)\s*,\s*([a-zA-Z0-9_]+)\s*,\s*([a-zA-Z0-9_]+)\s*\)/g,r=void 0;r=n.exec(e);){if(!(r[1]&&r[2]&&r[3]&&r[4]))throw new Error("Invalid parameter was passed on @ExposeMacro preference on '"+r[0]+"'");if("bool"!==r[1]&&"int"!==r[1])throw new Error('Invalid macro type "'+r[1]+'". regexResult type must be int or bool');var o=void 0;if("bool"===r[1]){if("true"!==r[4]&&"false"!==r[4])throw new Error('Default macro value "'+r[4]+'" is invalid for bool type macro. Must be true or false');o="true"===r[4]}else if(o=parseFloat(r[4]),isNaN(o))throw new Error('Default macro value "'+r[4]+'" is invalid for int type macro. Must be a number.');t[r[2]]={name:r[2],macroName:r[3],type:r[1],value:o,target:"expose"}}for(n=/@ReferMacro\s*\(\s*([a-zA-Z0-9_]+)\s*,\s*(.+)\s*\)/g;r=n.exec(e);){if(!r[1]||!r[2])throw new Error("Invalid parameter was passed on @ReferMacro preference on '"+r[0]+"'");t[r[1]]={name:r[1],macroName:r[1],value:r[2],target:"refer"}}return t}},{key:"parsePreferences",value:function(e){for(var t={enable:[WebGLRenderingContext.CULL_FACE,WebGLRenderingContext.BLEND,WebGLRenderingContext.DEPTH_TEST],functions:{blendColor:[0,0,0,0],cullFace:[WebGLRenderingContext.BACK],blendFuncSeparate:[WebGLRenderingContext.ONE,WebGLRenderingContext.ZERO,WebGLRenderingContext.ONE,WebGLRenderingContext.ZERO],blendEquationSeparate:[WebGLRenderingContext.FUNC_ADD,WebGLRenderingContext.FUNC_ADD],lineWidth:[1],frontFace:[WebGLRenderingContext.CCW],depthRange:[0,1],depthFunc:[WebGLRenderingContext.LESS]}},n=/@([A-Za-z]+)\(([a-zA-Z_0-9,\.\-]*)\)/g,r=void 0;r=n.exec(e);){var o=u.default[r[1]];if(!o)throw new Error("Unknown pass preference "+r[1]+" was specified.");o(t,r[2].split(","))}return t}},{key:"asValidJSON",value:function(e){var t=/([\{,]\s*)([a-zA-Z0-9_]+)(\s*\:)/gm,n=e.replace(t,'$1"$2"$3');return n}},{key:"removeComment",value:function(e){for(var t="",n=!1,r=!1,o=0;o<e.length;o++){var i=e.charAt(o);if("/"===i&&o+1<e.length){if("/"===e.charAt(o+1)&&!r){n=!0,o++;continue}if("*"===e.charAt(o+1)&&!n){r=!0,o++;continue}}if("*"===i&&r&&o+1<e.length&&"/"===e.charAt(o+1))r=!1,o++;else{if("\n"===i){if(n){t+="\n",n=!1;continue}r&&(t+="\n")}n||r||(t+=i)}}return t}},{key:"obtainNextSection",value:function(e,t,n,r){var o=e.indexOf(t,r);if(o===-1)throw new Error("Begining section charactor '"+t+"' was not found.");if(t.length>1||n.length>1)throw new Error("Invalid parameter");for(var i=1,a=t.charCodeAt(0),u=n.charCodeAt(0),s=o+1;s<e.length;s++){var l=e.charCodeAt(s);if(l===a?i++:l===u&&i--,0===i)return e.substring(o+1,s)}throw new Error("Invalid bracket matching")}},{key:"generateVariableFetchRegex",value:function(e){return new RegExp("(?:@([a-zA-Z0-9_]+)?(\\{.+\\})?)?\\s*"+e+"\\s+(?:(lowp|mediump|highp)\\s+)?([a-z0-9A-Z]+)\\s+([a-zA-Z0-9_]+)(?:\\s*\\[\\s*([a-zA-Z0-9_]+)\\s*\\]\\s*)?\\s*;","g")}},{key:"parseVariables",value:function(t,n){for(var r={},o=e.generateVariableFetchRegex(n),i=void 0;i=o.exec(t);){var a=i[5],u=l.default[i[4]],s=i[3],f=i[2],d=void 0!==i[6],h=void 0,p=i[1];p||(p=c.default[n][a],p||(p="uniform"===n?"USER_VALUE":a.toUpperCase())),d&&(h=parseInt(i[6],10),isNaN(h)&&(h=i[6])),r[a]={semantic:p,name:a,type:u,precision:s,attributes:f?JSON.parse(e.asValidJSON(f)):{},isArray:d,count:h}}return r}}]),e}();t.default=_},function(e,t){"use strict";if(Object.defineProperty(t,"__esModule",{value:!0}),!WebGLRenderingContext.ONE)throw new Error("WebGLRenderingContext constant can not be retrived!");var n=WebGLRenderingContext,r={vec2:n.FLOAT_VEC2,vec3:n.FLOAT_VEC3,vec4:n.FLOAT_VEC4,ivec2:n.INT_VEC2,ivec3:n.INT_VEC3,ivec4:n.INT_VEC4,bvec2:n.BOOL_VEC2,bvec3:n.BOOL_VEC3,bvec4:n.BOOL_VEC4,float:n.FLOAT,int:n.INT,bool:n.BOOL,sampler2D:n.SAMPLER_2D,samplerCube:n.SAMPLER_CUBE,mat4:n.FLOAT_MAT4,mat3:n.FLOAT_MAT3,mat2:n.FLOAT_MAT2};t.default=r},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.lib.math.AABB},function(e,t){e.exports="/*Header start*/\n// helper macros\n#ifdef FS\n  #define FS_PREC(prec,type) precision prec type;\n  #define VS_PREC(prec,type)\n#endif\n#ifdef VS\n#define VS_PREC(prec,type) precision prec type;\n#define FS_PREC(prec,type)\n#endif\n// constants\n#define PI 3.141592653589793\n#define E 2.718281828459045\n#define LN2 0.6931471805599453\n#define LN10 2.302585092994046\n#define LOG2E 1.4426950408889634\n#define LOG10E 0.4342944819032518\n#define SQRT2 1.4142135623730951\n#define SQRT1_2 0.7071067811865476\n\n/*Header end*/\n"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(25),l=r(s),f=n(1),c=r(f),d=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$mount",value:function(){if(this._meshRenderer=this.node.getComponent(l.default),!this._meshRenderer)throw new Error("ClickableMeshComponent must be attached with MeshRenderer")}},{key:"render",value:function(){}},{key:"onclick",value:function(){}}]),t}(c.default);t.default=d,d.attributes={}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),i=r(o),a=n(6),u=r(a);u.default.add("MODELVIEWPROJECTION",function(e){return function(t,n){t.uniformMatrix(e.name,n.transform.calcPVM(n.camera))}}),u.default.add("LOCAL",function(e){return function(t,n){t.uniformMatrix(e.name,n.transform.localTransform)}}),u.default.add("MODEL",function(e){return function(t,n){t.uniformMatrix(e.name,n.transform.globalTransform)}}),u.default.add("MODELVIEW",function(e){return function(t,n){t.uniformMatrix(e.name,n.camera.ViewMatrix.multiplyWith(n.transform.globalTransform))}}),u.default.add("VIEW",function(e){return function(t,n){t.uniformMatrix(e.name,n.camera.ViewMatrix)}}),u.default.add("PROJECTION",function(e){return function(t,n){t.uniformMatrix(e.name,n.camera.ProjectionMatrix)}}),u.default.add("MODELINVERSE",function(e){return function(t,n){t.uniformMatrix(e.name,i.default.inverse(n.transform.globalTransform))}}),u.default.add("VIEWINVERSE",function(e){return function(t,n){t.uniformMatrix(e.name,i.default.inverse(n.camera.ViewMatrix))}}),u.default.add("PROJECTIONINVERSE",function(e){return function(t,n){t.uniformMatrix(e.name,n.camera.InvProjectionMatrix)}}),u.default.add("MODELVIEWINVERSE",function(e){return function(t,n){t.uniformMatrix(e.name,i.default.inverse(n.transform.calcVM(n.camera)))}}),u.default.add("MODELVIEWPROJECTIONINVERSE",function(e){return function(t,n){t.uniformMatrix(e.name,i.default.inverse(n.transform.calcPVM(n.camera)))}}),u.default.add("MODELINVERSETRANSPOSE",function(e){return function(t,n){t.uniformMatrix(e.name,i.default.transpose(i.default.inverse(n.transform.globalTransform)))}}),u.default.add("MODELVIEWINVERSETRANSPOSE",function(e){return function(t,n){t.uniformMatrix3(e.name,i.default.transpose(i.default.inverse(n.transform.calcVM(n.camera))))}}),t.default=null},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(27),i=r(o),a=n(91),u=r(a),s=n(9),l=r(s),f=n(6),c=r(f);c.default.add("VIEWPORT",function(e){return function(t,n){var r=n.viewport;t.uniformVector4(e.name,new l.default(r.Left,r.Top,r.Width,r.Height))}}),c.default.add("VIEWPORT_SIZE",function(e){return function(t,n){var r=n.viewport;t.uniformVector2(e.name,new u.default(r.Width,r.Height))}}),c.default.add("TIME",function(e){return function(t,n){t.uniformFloat(e.name,Date.now()%1e7)}}),c.default.add("HAS_TEXTURE",function(e,t){var n=e.attributes.sampler;if(!n)throw new Error("The variable having HAS_TEXTURE as semantics must have sampler attribute");return function(r,o){var i=!!t.arguments[n]&&!!t.arguments[n].get(o.buffers);r.uniformBool(e.name,i)}}),c.default.add("CAMERA_POSITION",function(e){return function(t,n){t.uniformVector3(e.name,n.camera.transform.globalPosition)}}),c.default.add("CAMERA_DIRECTION",function(e){return function(t,n){t.uniformVector3(e.name,n.camera.transform.forward)}}),c.default.add("MESH_INDEX",function(e){return function(t,n){var r=n.renderable.index;t.uniformVector4(e.name,i.default.fromIndex(r))}}),t.default=null},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n,r,o){var i=void 0;i=t?f.array:f.single,i[e]=function(e,t){return t.addArgument(e.name,{converter:n,default:e.attributes.default?e.attributes.default:r}),{register:function(n,r){o(n,e.name,t.arguments[e.name],r)},dispose:function(){t.deleteArgument(e.name)}}}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),a=r(i),u=n(6),s=r(u),l=WebGLRenderingContext,f={array:{},single:{}};s.default.add("USER_VALUE",function(e,t){var n=void 0;if(e.count){if(n=f.array[e.type],!n)throw new Error("No user_value registerer was registered for "+e.type+"[]")}else if(n=f.single[e.type],!n)throw new Error("No user_value registerer was registered for "+e.type);return n(e,t)}),o(l.FLOAT,!1,"Number",0,function(e,t,n){return e.uniformFloat(t,n)}),o(l.INT,!1,"Number",0,function(e,t,n){return e.uniformInt(t,n)}),o(l.BOOL,!1,"Boolean",!1,function(e,t,n){return e.uniformBool(t,n)}),o(l.INT_VEC2,!1,"Vector2",[0,0],function(e,t,n){return e.uniformVector2(t,n)}),o(l.INT_VEC3,!1,"Vector3",[0,0,0],function(e,t,n){return e.uniformVector3(t,n)}),o(l.INT_VEC4,!1,"Vector4",[0,0,0,0],function(e,t,n){return e.uniformVector4(t,n)}),o(l.FLOAT_VEC2,!1,"Vector2",[0,0],function(e,t,n){return e.uniformVector2(t,n)}),o(l.FLOAT_MAT4,!0,"Object",[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],function(e,t,n){return e.uniformMatrixArray(t,n)}),o(l.SAMPLER_2D,!1,"Texture",null,function(e,t,n,r){var o=void 0;n&&(o=n.get(r.buffers))?e.uniformTexture2D(t,o):e.uniformTexture2D(t,a.default.defaultTextures.get(e.program.gl))}),f.single[l.FLOAT_VEC3]=function(e,t){var n="color"===e.attributes.type,r=e.attributes.default,o=r?r:n?[1,1,1]:[0,0,0];return t.addArgument(e.name,{converter:n?"Color3":"Vector3",default:o}),{register:n?function(n,r){n.uniformColor3(e.name,t.arguments[e.name])}:function(n,r){n.uniformVector3(e.name,t.arguments[e.name])},dispose:function(){t.deleteArgument(e.name)}}},f.single[l.FLOAT_VEC4]=function(e,t){var n="color"===e.attributes.type,r=e.attributes.default,o=r?r:n?[1,1,1,1]:[0,0,0,0];return t.addArgument(e.name,{converter:n?"Color4":"Vector4",default:o}),{register:n?function(n,r){n.uniformColor4(e.name,t.arguments[e.name])}:function(n,r){n.uniformVector4(e.name,t.arguments[e.name])},dispose:function(){t.deleteArgument(e.name)}}},t.default=null},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(46),i=r(o),a=n(41),u=r(a),s=n(51),l=r(s),f=n(50),c=r(f),d=n(57),h=r(d),p=n(54),_=r(p),b=n(19),v=r(b),m=n(31),y=r(m),g=n(32),w=r(g),E=n(33),R=r(E),C=n(34),O=r(C),x=n(35),M=r(x),P=n(36),T=r(P),A=n(37),k=r(A),S=n(23),j=r(S),L=n(24),I=r(L),N=n(10),G=r(N),F=n(38),W=r(F),D=n(25),B=r(D),V=n(39),U=r(V),z=n(40),q=r(z),H=n(43),$=r(H),X=n(44),Y=r(X),Z=n(42),J=r(Z),Q=n(11),K=r(Q),ee=n(12),te=r(ee),ne=n(45),re=r(ne),oe=n(26),ie=r(oe),ae=n(4),ue=r(ae),se=n(47),le=r(se),fe=n(48),ce=r(fe),de=n(49),he=r(de),pe=n(52),_e=r(pe),be=n(53),ve=r(be),me=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})};t.default=function(){v.default.register(function(){return me(void 0,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=v.default.ns("HTTP://GRIMOIRE.GL/NS/DEFAULT"),v.default.registerComponent(t("AssetLoadingManager"),y.default),v.default.registerComponent(t("Camera"),w.default),v.default.registerComponent(t("CanvasInitializer"),R.default),v.default.registerComponent(t("Fullscreen"),O.default),v.default.registerComponent(t("Geometry"),M.default),v.default.registerComponent(t("GeometryRegistory"),T.default),v.default.registerComponent(t("HTMLBinder"),k.default),v.default.registerComponent(t("LoopManager"),j.default),v.default.registerComponent(t("Material"),I.default),v.default.registerComponent(t("MaterialContainer"),G.default),v.default.registerComponent(t("MaterialImporter"),W.default),v.default.registerComponent(t("MeshRenderer"),B.default),v.default.registerComponent(t("MouseCameraControl"),U.default),v.default.registerComponent(t("RenderBuffer"),q.default),v.default.registerComponent(t("Renderer"),$.default),v.default.registerComponent(t("RendererManager"),Y.default),v.default.registerComponent(t("RenderQuad"),J.default),v.default.registerComponent(t("RenderScene"),K.default),v.default.registerComponent(t("Scene"),te.default),v.default.registerComponent(t("TextureBuffer"),re.default),v.default.registerComponent(t("Texture"),ie.default),v.default.registerComponent(t("Transform"),ue.default),v.default.registerComponent(t("RenderHitArea"),u.default),v.default.registerComponent(t("Time"),i.default),v.default.registerConverter(t("CanvasSize"),le.default),v.default.registerConverter(t("Geometry"),ce.default),v.default.registerConverter(t("Material"),he.default),v.default.registerConverter(t("Texture"),_e.default),v.default.registerConverter(t("Texture2D"),_e.default),v.default.registerConverter(t("Viewport"),ve.default),v.default.registerConverter(t("Node"),c.default),v.default.registerConverter(l.default),v.default.registerNode("goml",["CanvasInitializer","LoopManager","AssetLoadingManager","GeometryRegistory","RendererManager","Fullscreen"]),v.default.registerNode("scene",["Scene"]),v.default.registerNode("object",["Transform"]),v.default.registerNode("camera",["Camera"],{position:"0,0,10"},"object"),v.default.registerNode("mesh",["MaterialContainer","MeshRenderer"],{},"object"),v.default.registerNode("renderer",["Renderer"]),v.default.registerNode("geometry",["Geometry"]),v.default.registerNode("texture",["Texture"]),v.default.registerNode("material",["Material"]),v.default.registerNode("import-material",["MaterialImporter"]),v.default.registerNode("texture-buffer",["TextureBuffer"]),v.default.registerNode("render-buffer",["RenderBuffer"]),v.default.registerNode("render-scene",["RenderScene","RenderHitArea"],{material:null}),v.default.registerNode("render-quad",["MaterialContainer","RenderQuad"],{material:null}),_.default.register(),h.default.register();case 49:case"end":return e.stop()}},e,this)}))})}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={goml:{components:["CanvasInitializer","LoopManager","AssetLoadingManager","GeometryRegistory","RendererManager","Fullscreen"]},scene:{components:["Scene"]},object:{components:["Transform"]},camera:{components:["Camera"],default:{position:[0,0,10]},super:"object"},mesh:{components:["MaterialContainer","MeshRenderer"],super:"object"},renderer:{components:["Renderer"]},geometry:{components:["Geometry"]},texture:{components:["Texture"]},material:{components:["Material"]},"import-material":{components:["MaterialImporter"]},"texture-buffer":{components:["TextureBuffer"]},"render-buffer":{components:["RenderBuffer"]},"render-scene":{components:["RenderScene"],default:{material:null}},"render-quad":{components:["MaterialContainer","RenderQuad"],default:{material:null}}}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.lib.math.Color4},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.lib.math.Quaternion},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.lib.math.Rectangle},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.lib.math.Vector2},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.Base.EEObject},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.GrimoireInterface},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.Node.Attribute},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.Node.GomlNode},function(e,t){e.exports='<div style="width:100%;height:100%;position: relative;">\n    <div style="width: 55px;height: 55px;border-radius: 100%;border: 5px solid #381794;border-right-color: #FC659D;animation: rotate 1s linear infinite;position: absolute;top: 0;left: 0;right: 0;bottom: 0;margin: auto;"></div>\n</div>\n<style type="text/css">\n    @keyframes rotate {\n        from {\n            transform: rotate(0deg);\n        }\n        to {\n            transform: rotate(360deg);\n        }\n    }\n</style>\n'},function(e,t){e.exports='@Technique default{\n@Pass{\n  @BlendFunc(SRC_ALPHA,ONE_MINUS_SRC_ALPHA)\n  FS_PREC(mediump,float)\n  varying vec2 vTexCoord;\n  #ifdef VS\n\n  attribute vec3 position;\n  attribute vec2 texCoord;\n  @MODELVIEWPROJECTION\n  uniform mat4 _matPVM;\n  void main()\n  {\n    gl_Position = _matPVM * vec4(position,1.0);\n    vTexCoord = texCoord;\n  }\n  #endif\n  #ifdef FS\n  @{type:"color",default:"white"}\n  uniform vec4 color;\n\n  uniform sampler2D texture;\n  @HAS_TEXTURE{sampler:"texture"}\n  uniform bool _textureUsed;\n\n  uniform float _time;\n  void main(void)\n  {\n    if(_textureUsed){\n      gl_FragColor = color * texture2D(texture,vTexCoord);\n    }else{\n      gl_FragColor = color;\n   }\n  }\n  #endif\n}\n}\n'}])});
//# sourceMappingURL=grimoire-fundamental.min.js.map
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(25),o=n(i),a=r(15),u=n(a),s=r(16),l=n(s),c=r(17),f=n(c),d=r(26),h=n(d),p=r(27),b=n(p),m=r(28),g=n(m),_=r(29),v=n(_),y=r(30),w=n(y),E=r(31),R=n(E),x=r(32),O=n(x),C=r(33),T=n(C),M=r(18),P=n(M),k=r(19),S=n(k),A=r(6),j=n(A),L=r(34),N=n(L),I=r(35),G=n(I),W=r(36),F=n(W),D=r(37),Y=n(D),U=r(38),B=n(U),V=r(41),z=n(V),q=r(42),H=n(q),X=r(39),Z=n(X),$=r(40),J=n($),Q=r(10),K=n(Q),ee=r(43),te=n(ee),re=r(20),ne=n(re),ie=r(3),oe=n(ie),ae=r(44),ue=n(ae),se=r(45),le=n(se),ce=r(46),fe=n(ce),de=r(47),he=n(de),pe=r(48),be=n(pe),me=r(49),ge=n(me),_e=r(50),ve=n(_e),ye=r(51),we=n(ye),Ee=r(52),Re=n(Ee),xe=r(53),Oe=n(xe),Ce=r(54),Te=n(Ce),Me=r(11),Pe=n(Me),ke=r(55),Se=n(ke),Ae=r(12),je=n(Ae),Le=r(56),Ne=n(Le),Ie=r(57),Ge=n(Ie),We=r(58),Fe=n(We),De=r(59),Ye=n(De),Ue=r(60),Be=n(Ue),Ve=r(13),ze=n(Ve),qe=r(61),He=n(qe),Xe=r(62),Ze=n(Xe),$e=r(63),Je=n($e),Qe=r(7),Ke=n(Qe),et=r(82),tt=n(et),rt=r(83),nt=n(rt),it=r(84),ot=n(it),at=r(64),ut=n(at),st=r(21),lt=n(st),ct=r(65),ft=n(ct),dt=r(66),ht=n(dt),pt=r(22),bt=n(pt),mt=r(2),gt=n(mt),_t=r(67),vt=n(_t),yt=r(68),wt=n(yt),Et=r(4),Rt=n(Et),xt=r(69),Ot=n(xt),Ct=r(70),Tt=n(Ct),Mt=r(71),Pt=n(Mt),kt=r(72),St=n(kt),At=r(73),jt=n(At),Lt=r(74),Nt=n(Lt),It=r(75),Gt=n(It),Wt=r(76),Ft=n(Wt),Dt=r(77),Yt=n(Dt),Ut=r(78),Bt=n(Ut),Vt=r(23),zt=n(Vt),qt=r(85),Ht=n(qt),Xt={Asset:{AssetLoader:o.default,CacheResolver:u.default,ExternalResourceResolver:l.default,ImageResolver:f.default,TextFileResolver:h.default},Components:{AssetLoadingManagerComponent:b.default,CameraComponent:g.default,CanvasInitializerComponent:v.default,FullscreenComponent:w.default,GeometryComponent:R.default,GeometryRegistoryComponent:O.default,HTMLBinderComponent:T.default,LoopManagerComponent:P.default,MaterialComponent:S.default,MaterialContainerComponent:j.default,MaterialImporterComponent:N.default,MaterialManagerComponent:G.default,MeshRendererComponent:F.default,MouseCameraControlComponent:Y.default,RenderBufferComponent:B.default,RendererComponent:z.default,RendererManagerComponent:H.default,RenderQuadComponent:Z.default,RenderSceneComponent:J.default,SceneComponent:K.default,TextureBufferComponent:te.default,TextureComponent:ne.default,TransformComponent:oe.default},Converters:{CanvasSizeConverter:ue.default,ComponentConverter:le.default,EnumConverter:fe.default,GeometryConverter:he.default,MaterialConverter:be.default,NumberArrayConverter:ge.default,NumberConverter:ve.default,ObjectConverter:we.default,TextureConverter:Re.default,ViewportConverter:Oe.default},Geometry:{DefaultPrimitives:Te.default,Geometry:Pe.default,GeometryBuilder:Se.default,GeometryFactory:je.default,GeometryUtility:Ne.default},Material:{DefaultMacro:Ge.default,DefaultMaterial:Fe.default,MacroRegistory:Ye.default,Material:Be.default,MaterialFactory:ze.default,Pass:He.default,Technique:Ze.default,TextureReference:Je.default,UniformResolverRegistry:Ke.default,Uniforms:{MatricesRegister:tt.default,MiscRegister:nt.default,UserValueRegister:ot.default}},Resource:{Buffer:ut.default,FrameBuffer:lt.default,GLExtRequestor:ft.default,Program:ht.default,RenderBuffer:bt.default,ResourceBase:gt.default,ResourceCache:vt.default,Shader:wt.default,Texture2D:Rt.default,UniformProxy:Ot.default},SceneRenderer:{DrawPriorty:Tt.default,RenderQueue:Pt.default,RenderQueueRegistry:St.default},Sort:{ImportResolver:jt.default,NameSemanticsPair:Nt.default,Parser:Gt.default,Preferences:Ft.default,SortTransformUtility:Yt.default,TypeToConstant:Bt.default},Util:{TextureSizeCalculator:zt.default}},Zt=(0,Ht.default)();Object.assign(Zt||{},Xt),window.GrimoireJS.lib.fundamental=Xt,t.default=Zt},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.Node.Component},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(90),l=n(s),c=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.gl=e,r.destroyed=!1,r.valid=!1,r}return a(t,e),u(t,[{key:"destroy",value:function(){this.destroyed=!0}},{key:"valid",get:function(){return this._valid},set:function(e){var t=this;this._valid!==e&&(this._valid=e,this._valid?this._validResolve(this):this.validPromise=new Promise(function(e){t._validResolve=e}))}}]),t}(l.default);t.default=c},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(8),l=n(s),c=r(5),f=n(c),d=r(14),h=n(d),p=r(80),b=n(p),m=r(24),g=n(m),_=r(1),v=n(_),y=g.default.mat4,w=g.default.vec3,E=g.default.vec4,R=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.localTransform=new l.default,e.globalTransform=new l.default,e._children=[],e._cachePVM=new l.default,e._cacheVM=new l.default,e._forward=new f.default([0,0,-1,0]),e._up=new f.default([0,1,0,0]),e._right=new f.default([1,0,0,0]),e._globalPosition=new f.default([0,0,0]),e._globalScale=new f.default([1,1,1]),e._matrixTransformMode=!1,e}return a(t,e),u(t,[{key:"calcPVM",value:function(e){return y.mul(this._cachePVM.rawElements,e.ProjectionViewMatrix.rawElements,this.globalTransform.rawElements),this._cachePVM}},{key:"calcVM",value:function(e){return y.mul(this._cacheVM.rawElements,e.ViewMatrix.rawElements,this.globalTransform.rawElements),this._cacheVM}},{key:"$awake",value:function(){var e=this;this.getAttributeRaw("position").watch(function(t){e._localPosition=t,e._matrixTransformMode=!1,e.updateTransform(!0)}),this.getAttributeRaw("rotation").watch(function(t){e._localRotation=t,e._matrixTransformMode=!1,e.updateTransform()}),this.getAttributeRaw("scale").watch(function(t){e._localScale=t,e._matrixTransformMode=!1,e.updateTransform(!0)}),this.getAttributeRaw("rawMatrix").watch(function(t){if(null!==t){var r=t;e._matrixTransformMode=!0,e.localTransform=r,e.updateGlobalTransform()}}),this._localPosition=this.getAttribute("position"),this._localRotation=this.getAttribute("rotation"),this._localScale=this.getAttribute("scale"),this.updateTransform()}},{key:"$mount",value:function(){this._parentTransform=this.node.parent.getComponent(t),this._parentTransform&&this._parentTransform._children.push(this),this.updateTransform()}},{key:"$unmount",value:function(){this._parentTransform&&(this._parentTransform._children.splice(this._parentTransform._children.indexOf(this),1),this._parentTransform=null)}},{key:"updateTransform",value:function(e){this._matrixTransformMode||y.fromRotationTranslationScale(this.localTransform.rawElements,this._localRotation.rawElements,this._localPosition.rawElements,this._localScale.rawElements),this.updateGlobalTransform(e)}},{key:"updateGlobalTransform",value:function(e){this._parentTransform?y.mul(this.globalTransform.rawElements,this._parentTransform.globalTransform.rawElements,this.localTransform.rawElements):y.copy(this.globalTransform.rawElements,this.localTransform.rawElements),e&&this._updateDirections(),this._updateGlobalProperty(),this.node.emit("transformUpdated",this),this._children.forEach(function(t){return t.updateGlobalTransform(e)})}},{key:"_updateDirections",value:function(){E.transformMat4(this._forward.rawElements,t._forwardBase.rawElements,this.globalTransform.rawElements),E.transformMat4(this._up.rawElements,t._upBase.rawElements,this.globalTransform.rawElements),E.transformMat4(this._right.rawElements,t._rightBase.rawElements,this.globalTransform.rawElements)}},{key:"_updateGlobalProperty",value:function(){this._parentTransform?(w.transformMat4(this._globalPosition.rawElements,this._localPosition.rawElements,this._parentTransform.globalTransform.rawElements),w.transformMat4(this._globalScale.rawElements,this._localScale.rawElements,this._parentTransform.globalTransform.rawElements)):(w.copy(this._globalPosition.rawElements,this._localPosition.rawElements),w.copy(this._globalScale.rawElements,this._localScale.rawElements))}},{key:"globalPosition",get:function(){return this._globalPosition}},{key:"localPosition",get:function(){return this._localPosition},set:function(e){this._localPosition=e,this.setAttribute("position",e)}},{key:"localRotation",get:function(){return this._localRotation},set:function(e){this._localRotation=e,this.setAttribute("rotation",e)}},{key:"globalScale",get:function(){return this._globalScale}},{key:"localScale",get:function(){return this._localScale},set:function(e){this._localScale=e,this.setAttribute("scale",e)}},{key:"forward",get:function(){return this._forward}},{key:"up",get:function(){return this._up}},{key:"right",get:function(){return this._right}}]),t}(v.default);t.default=R,R.attributes={position:{converter:"Vector3",default:f.default.Zero},rotation:{converter:"Rotation3",default:b.default.Identity},scale:{converter:"Vector3",default:f.default.One},rawMatrix:{converter:"Object",default:null}},R._forwardBase=new h.default(0,0,-1,0),R._upBase=new h.default(0,1,0,0),R._rightBase=new h.default(1,0,0,0)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)},l=r(2),c=n(l),f=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r._texParameterChanged=!0,r._magFilter=WebGLRenderingContext.LINEAR,r._minFilter=WebGLRenderingContext.LINEAR,r._wrapS=WebGLRenderingContext.REPEAT,r._wrapT=WebGLRenderingContext.REPEAT,t._maxTextureSize||(t._maxTextureSize=e.getParameter(WebGLRenderingContext.MAX_TEXTURE_SIZE)),r.texture=e.createTexture(),r}return a(t,e),u(t,[{key:"update",value:function(e,t,r,n,i,o,a,u){this.gl.bindTexture(WebGLRenderingContext.TEXTURE_2D,this.texture);var s=void 0,l=void 0,c=void 0,f=void 0;void 0===r?(s=t||{flipY:!1,premultipliedAlpha:!1},l=e):(f=e,c=t,s=u||{flipY:!1,premultipliedAlpha:!1}),void 0===s.flipY&&(s.flipY=!1),void 0===s.premultipliedAlpha&&(s.premultipliedAlpha=!1),this.gl.pixelStorei(WebGLRenderingContext.UNPACK_FLIP_Y_WEBGL,s.flipY?1:0),this.gl.pixelStorei(WebGLRenderingContext.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultipliedAlpha?1:0),void 0===r?l instanceof HTMLImageElement?this.gl.texImage2D(WebGLRenderingContext.TEXTURE_2D,0,WebGLRenderingContext.RGBA,WebGLRenderingContext.RGBA,WebGLRenderingContext.UNSIGNED_BYTE,this._justifyImage(l)):l instanceof HTMLCanvasElement?this.gl.texImage2D(WebGLRenderingContext.TEXTURE_2D,0,WebGLRenderingContext.RGBA,WebGLRenderingContext.RGBA,WebGLRenderingContext.UNSIGNED_BYTE,this._justifyCanvas(l)):l instanceof HTMLVideoElement&&this.gl.texImage2D(WebGLRenderingContext.TEXTURE_2D,0,WebGLRenderingContext.RGBA,WebGLRenderingContext.RGBA,WebGLRenderingContext.UNSIGNED_BYTE,this._justifyVideo(l)):(void 0===a&&(a=null),this.gl.texImage2D(WebGLRenderingContext.TEXTURE_2D,f,i,c,r,n,i,o,a)),this._ensureMipmap(),this.valid=!0}},{key:"register",value:function(e){this.gl.activeTexture(WebGLRenderingContext.TEXTURE0+e),this.gl.bindTexture(WebGLRenderingContext.TEXTURE_2D,this.texture),this._texParameterChanged&&this._updateTexParameter()}},{key:"destroy",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.gl.deleteTexture(this.texture)}},{key:"_justifyImage",value:function(e){var r=e.naturalWidth,n=e.naturalHeight,i=Math.min(Math.pow(2,Math.log(Math.min(r,n))/Math.LN2|0),t._maxTextureSize);if(r!==n||r!==i){var o=document.createElement("canvas");return o.height=o.width=i,o.getContext("2d").drawImage(e,0,0,r,n,0,0,i,i),o}return e}},{key:"_justifyCanvas",value:function(e){var t=e.width,r=e.height,n=Math.pow(2,Math.log(Math.min(t,r))/Math.LN2|0);return t===r&&t===n||(e.height=e.width=2*n),e}},{key:"_justifyVideo",value:function(e){var t=e.videoWidth,r=e.videoHeight,n=Math.pow(2,Math.log(Math.min(t,r))/Math.LN2|0);if(t!==r||t!==n){var i=document.createElement("canvas");return i.height=i.width=n,i.getContext("2d").drawImage(e,0,0,t,r,0,0,n,n),i}return e}},{key:"_updateTexParameter",value:function(){this.gl.texParameteri(WebGLRenderingContext.TEXTURE_2D,WebGLRenderingContext.TEXTURE_MIN_FILTER,this._minFilter),this.gl.texParameteri(WebGLRenderingContext.TEXTURE_2D,WebGLRenderingContext.TEXTURE_MAG_FILTER,this._magFilter),this.gl.texParameteri(WebGLRenderingContext.TEXTURE_2D,WebGLRenderingContext.TEXTURE_WRAP_S,this._wrapS),this.gl.texParameteri(WebGLRenderingContext.TEXTURE_2D,WebGLRenderingContext.TEXTURE_WRAP_T,this._wrapT),this._texParameterChanged=!1}},{key:"_ensureMipmap",value:function(){(t._filtersNeedsMipmap.indexOf(this.magFilter)>=0||t._filtersNeedsMipmap.indexOf(this.minFilter)>=0)&&(this.gl.bindTexture(WebGLRenderingContext.TEXTURE_2D,this.texture),this.gl.generateMipmap(WebGLRenderingContext.TEXTURE_2D))}},{key:"magFilter",get:function(){return this._magFilter},set:function(e){this._magFilter!==e&&(this._texParameterChanged=!0,this._magFilter=e,this._ensureMipmap())}},{key:"minFilter",get:function(){return this._minFilter},set:function(e){this._minFilter!==e&&(this._texParameterChanged=!0,this._minFilter=e,this._ensureMipmap())}},{key:"wrapS",get:function(){return this._wrapS},set:function(e){this._wrapS!==e&&(this._texParameterChanged=!0,this._wrapS=e)}},{key:"wrapT",get:function(){return this._wrapT},set:function(e){this._wrapT!==e&&(this._texParameterChanged=!0,this._wrapT=e)}}]),t}(c.default);t.default=f,f._filtersNeedsMipmap=[WebGLRenderingContext.LINEAR_MIPMAP_LINEAR,WebGLRenderingContext.LINEAR_MIPMAP_NEAREST,WebGLRenderingContext.NEAREST_MIPMAP_LINEAR,WebGLRenderingContext.NEAREST_MIPMAP_NEAREST]},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.lib.math.Vector3},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(70),l=n(s),c=r(1),f=n(c),d=r(9),h=n(d),p=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{s(n.next(e))}catch(e){o(e)}}function u(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(a,u)}s((n=n.apply(e,t)).next())})},b=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.materialArgs={},e.ready=!1,e.useMaterial=!1,e}return a(t,e),u(t,[{key:"getDrawPriorty",value:function(e){if(!this.ready)return Number.MAX_VALUE;var t=l.default[this._drawOrder?this._drawOrder:this.material.techniques.default.drawOrder];if(void 0===t)throw new Error('Specified drawing order "'+this.material.techniques.default.drawOrder+'" is not defined');return t.descending?(1-e/1e4)*t.priorty:e/1e4*t.priorty}},{key:"$mount",value:function(){this.getAttributeRaw("material").watch(this._onMaterialChanged),this.companion.get("loader").register(this._onMaterialChanged()),this.getAttributeRaw("drawOrder").boundTo("_drawOrder")}},{key:"_onMaterialChanged",value:function(){return p(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getAttribute("material"),void 0!==t){e.next=4;break}return this.useMaterial=!1,e.abrupt("return");case 4:this.useMaterial=!0,this._materialComponent?this._prepareExternalMaterial(t):this._prepareInternalMaterial(t);case 6:case"end":return e.stop()}},e,this)}))}},{key:"_prepareExternalMaterial",value:function(e){return p(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.companion.get("loader"),r.register(e),t.next=4,e;case 4:n=t.sent,this.material=n,this.materialArgs=this._materialComponent.materialArgs,this.ready=!0;case 8:case"end":return t.stop()}},t,this)}))}},{key:"_prepareInternalMaterial",value:function(e){return p(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r,n,i,o,a,u=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.companion.get("loader"),r.register(e),e){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,e;case 6:n=t.sent,this.material=n;for(i in this.material.argumentDeclarations)this.__addAtribute(i,this.material.argumentDeclarations[i]),this.getAttributeRaw(i).boundTo(i,this.material.arguments);o=function(e){u.__addAtribute(e,u.material.macroDeclarations[e]),u.getAttributeRaw(e).watch(function(t){u.material.setMacroValue(e,t)},!0)};for(a in this.material.macroDeclarations)o(a);this.ready=!0;case 12:case"end":return t.stop()}},t,this)}))}}],[{key:"rewriteDefaultMaterial",value:function(e){e!==t._defaultMaterial&&(t._defaultMaterial=e,h.default.componentDeclarations.get("MaterialContainer").attributes.material.default="new("+e+")")}},{key:"defaultMaterial",get:function(){return this._defaultMaterial}}]),t}(f.default);t.default=b,b.attributes={material:{converter:"Material",default:"new(unlit)",componentBoundTo:"_materialComponent"},drawOrder:{converter:"String",default:null}},b._defaultMaterial="unlit"},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=t.UniformResolverRegistry=function(){function e(){r(this,e),this._generators={}}return n(e,[{key:"add",value:function(e,t){if("function"!=typeof t)throw new Error("secound argument of add must be function");this._generators[e.toUpperCase()]=t}},{key:"generateRegisterers",value:function(e,t){var r=[],n=[];for(var i in t.uniforms){var o=t.uniforms[i],a=o.semantic,u=this._generators[a];if(!u)throw new Error("There was no suitable registerer for specified semantic "+a);var s=u(o,e);"function"==typeof s?r.push(s):(r.push(s.register),s.dispose&&n.push(s.dispose))}return{registerers:r,disposers:n}}}]),e}();t.default=new i},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.lib.math.Matrix},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(72),l=n(s),c=r(1),f=n(c),d=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.sceneDescription={},e.queueRegistory=new l.default,e}return a(t,e),u(t,[{key:"updateScene",value:function(e){this._lastUpdateIndex!==e&&(this.node.broadcastMessage("update",this.sceneDescription),this._lastUpdateIndex=e)}}]),t}(f.default);t.default=d,d.attributes={}},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t,n,i,o){r(this,e),this.vertices=t,this.accessors=n,this.indices=i,this.aabb=o;for(var a in n){var u=n[a];if(void 0===t[u.bufferName])throw new Error('Non existing buffer "'+u.bufferName+'" was bind with "'+a+'".')}}return n(e,[{key:"drawByDefault",value:function(t,r,n){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Number.MAX_VALUE,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;r.forEach(function(t){e.bindBufferToAttribute(i,n,t,t)}),e.drawWithCurrentVertexBuffer(this,t,o,a)}}],[{key:"bindBufferToAttribute",value:function(e,t,r,n){var i=t.findAttributeLocation(r);if(i<0)return!1;var o=e.accessors[n];if(!o)throw new Error('Specified buffer "'+n+' was not found on this geometry while attempt to bind "'+r+'" of attribute variables.\n\n\t  All of the vertex buffer available on this geometry is '+Object.keys(e.accessors)+'"');var a=e.vertices[o.bufferName];return a.bind(),t.gl.vertexAttribPointer(i,o.size,o.type,!1,o.stride,o.offset),!0}},{key:"drawWithCurrentVertexBuffer",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.MAX_VALUE,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=e.indices[t];if(void 0===i)throw new Error('Specified index buffer "'+t+'" was not found on this geometry.All of the index buffer available on this geometry is "'+Object.keys(e.indices)+'"');i.index.bind(),i.index.gl.drawElements(i.topology,Math.min(i.count,r),i.type,Math.min(n*i.byteSize+i.byteOffset,(i.count-1)*i.byteSize))}}]),e}();t.default=i,i._lastGeometry=new Map},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t){r(this,e),this.gl=t}return n(e,[{key:"instanciate",value:function(t,r){var n=e.factoryDelegates[t];if(!n)throw new Error("Can not instanciate unknown geometry type "+t);return n(this.gl,r)}},{key:"instanciateAsDefault",value:function(t){var r=e.factoryArgumentDeclarations[t],n={};for(var i in r){var o=r[i];n[i]=o.default}return this.instanciate(t,n)}}],[{key:"addType",value:function(t,r,n){e.factoryDelegates[t]=n,e.factoryArgumentDeclarations[t]=r}}]),e}();t.default=i,i.factoryDelegates={},i.factoryArgumentDeclarations={}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(75),u=n(a),s=r(59),l=n(s),c=r(26),f=n(c),d=r(60),h=n(d),p=r(81),b=n(p),m=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{s(n.next(e))}catch(e){o(e)}}function u(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(a,u)}s((n=n.apply(e,t)).next())})},g=function(){function e(t){i(this,e),this.gl=t,this.shaderHeader=e.defaultShaderHeader,this.macro=new l.default}return o(e,[{key:"instanciate",value:function(t){return m(this,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!e.factories[t]){r.next=4;break}return r.abrupt("return",e.factories[t](this));case 4:return r.next=6,this._waitForRegistered(t);case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}},r,this)}))}},{key:"_waitForRegistered",value:function(t){var r=this;return new Promise(function(n){e._onRegister(t,function(){n(e.factories[t](r))})})}}],[{key:"addMaterialType",value:function(t,r){e.factories[t]=r,e.registerdHandlers[t]&&e.registerdHandlers[t].forEach(function(e){return e()})}},{key:"addSORTMaterial",value:function(t,r){return m(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,u.default.parse(r);case 2:i=n.sent,e.addMaterialType(t,function(e){return new h.default(e.gl,i)});case 4:case"end":return n.stop()}},n,this)}))}},{key:"addSORTMaterialFromURL",value:function(t,r){return m(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,f.default.resolve(r);case 2:return i=n.sent,n.next=5,e.addSORTMaterial(t,i);case 5:case"end":return n.stop()}},n,this)}))}},{key:"_onRegister",value:function(t,r){e.registerdHandlers[t]?e.registerdHandlers[t].push(r):e.registerdHandlers[t]=[r]}}]),e}();t.default=g,g.defaultShaderHeader=b.default,g.factories={},g.registerdHandlers={}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.lib.math.Vector4},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{s(n.next(e))}catch(e){o(e)}}function u(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(a,u)}s((n=n.apply(e,t)).next())})},o=function(){function e(t){r(this,e),this.toAbsolute=t,this.cache={},this.resolvers={}}return n(e,[{key:"resolve",value:function(e,t){return i(this,void 0,void 0,regeneratorRuntime.mark(function r(){var n,i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n=this.toAbsolute(e),!this._cached(n)){r.next=5;break}return r.abrupt("return",this.cache[n]);case 5:if(!this._resolving(n)){r.next=11;break}return r.next=8,this.resolvers[n];case 8:return r.abrupt("return",r.sent);case 11:return this.resolvers[n]=t(n),r.next=14,this.resolvers[n];case 14:return i=r.sent,this._resolved(n,i),r.abrupt("return",i);case 17:case"end":return r.stop()}},r,this)}))}},{key:"_cached",value:function(e){return"undefined"!=typeof this.cache[e]}},{key:"_resolving",value:function(e){return"undefined"!=typeof this.resolvers[e]}},{key:"_resolved",value:function(e,t){delete this.resolvers[e],this.cache[e]=t}}]),e}();t.default=o},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(15),l=n(s),c=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,t._toAbsolute))}return a(t,e),u(t,null,[{key:"_toAbsolute",value:function(e){var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host+t.pathname+t.search+t.hash;
}}]),t}(l.default);t.default=c},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ImageResolver=void 0;var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)},l=r(16),c=n(l),f=t.ImageResolver=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"resolve",value:function(e){return s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"resolve",this).call(this,e,function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){t(n)},n.onerror=function(e){r(e)},n.src=e})})}}]),t}(c.default);t.default=new f},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(1),l=n(s),c=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._loopActions=[],e._loopIndex=0,e}return a(t,e),u(t,[{key:"$awake",value:function(){var e=this;this.getAttributeRaw("loopEnabled").watch(function(t){t&&e._begin()}),this._registerNextLoop=window.requestAnimationFrame?function(){window.requestAnimationFrame(e._loop.bind(e))}:function(){window.setTimeout(e._loop.bind(e),1e3/60)}}},{key:"register",value:function(e,t){this._loopActions.push({action:e,priorty:t}),this._loopActions.sort(function(e,t){return e.priorty-t.priorty})}},{key:"_begin",value:function(){this._registerNextLoop()}},{key:"_loop",value:function(){var e=this;this.node.emit("loop",{loopIndex:this._loopIndex}),this._loopActions.forEach(function(t){return t.action(e._loopIndex)}),this._loopIndex++,this._registerNextLoop()}}]),t}(l.default);c.attributes={loopEnabled:{default:!1,converter:"Boolean"}},t.default=c},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(1),l=n(s),c=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{s(n.next(e))}catch(e){o(e)}}function u(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(a,u)}s((n=n.apply(e,t)).next())})},f=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.materialArgs={},e}return a(t,e),u(t,[{key:"$mount",value:function(){var e=this.getAttribute("type");e&&(this.materialPromise=this.companion.get("MaterialFactory").instanciate(e),this._registerAttributes())}},{key:"_registerAttributes",value:function(){return c(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,r,n,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.materialPromise;case 2:this.material=e.sent;for(t in this.material.argumentDeclarations)this.__addAtribute(t,this.material.argumentDeclarations[t]),this.getAttributeRaw(t).boundTo(t,this.material.arguments);r=function(e){i.__addAtribute(e,i.material.macroDeclarations[e]),i.getAttributeRaw(e).watch(function(t){i.material.setMacroValue(e,t)},!0)};for(n in this.material.macroDeclarations)r(n);this.ready=!0;case 7:case"end":return e.stop()}},e,this)}))}}]),t}(l.default);t.default=f,f.attributes={type:{converter:"String",default:null}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(4),l=n(s),c=r(1),f=n(c),d=r(17),h=n(d),p=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{s(n.next(e))}catch(e){o(e)}}function u(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(a,u)}s((n=n.apply(e,t)).next())})},b=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$mount",value:function(){var e=this,t=this.getAttribute("src");this.texture=new l.default(this.companion.get("gl")),this.texture.magFilter=this.getAttribute("magFilter"),this.texture.minFilter=this.getAttribute("minFilter"),this.texture.wrapT=this.getAttribute("wrapT"),this.texture.wrapS=this.getAttribute("wrapS"),this.getAttributeRaw("magFilter").watch(function(t){return e.texture.magFilter=t}),this.getAttributeRaw("minFilter").watch(function(t){return e.texture.minFilter=t}),this.getAttributeRaw("wrapS").watch(function(t){return e.texture.wrapS=t}),this.getAttributeRaw("wrapT").watch(function(t){return e.texture.wrapT=t}),t&&this._loadTask(t)}},{key:"_loadTask",value:function(e){return p(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.default.resolve(e);case 2:r=t.sent,this.texture.update(r);case 4:case"end":return t.stop()}},t,this)}))}}]),t}(f.default);t.default=b,b.attributes={src:{converter:"String",default:null},minFilter:{converter:"Enum",default:"LINEAR",table:{LINEAR:WebGLRenderingContext.LINEAR,NEAREST:WebGLRenderingContext.NEAREST,NEAREST_MIPMAP_NEAREST:WebGLRenderingContext.NEAREST_MIPMAP_NEAREST,NEAREST_MIPMAP_LINEAR:WebGLRenderingContext.NEAREST_MIPMAP_LINEAR,LINEAR_MIPMAP_NEAREST:WebGLRenderingContext.LINEAR_MIPMAP_NEAREST,LINEAR_MIPMAP_LINEAR:WebGLRenderingContext.LINEAR_MIPMAP_LINEAR}},magFilter:{converter:"Enum",default:"LINEAR",table:{LINEAR:WebGLRenderingContext.LINEAR,NEAREST:WebGLRenderingContext.NEAREST}},wrapS:{converter:"Enum",default:"REPEAT",table:{REPEAT:WebGLRenderingContext.REPEAT,MIRRORED_REPEAT:WebGLRenderingContext.MIRRORED_REPEAT,CLAMP_TO_EDGE:WebGLRenderingContext.CLAMP_TO_EDGE}},wrapT:{converter:"Enum",default:"REPEAT",table:{REPEAT:WebGLRenderingContext.REPEAT,MIRRORED_REPEAT:WebGLRenderingContext.MIRRORED_REPEAT,CLAMP_TO_EDGE:WebGLRenderingContext.CLAMP_TO_EDGE}}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)},l=r(22),c=n(l),f=r(4),d=n(f),h=r(2),p=n(h),b=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.fbo=e.createFramebuffer(),r}return a(t,e),u(t,[{key:"update",value:function(e,t,r){if(this.gl.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,this.fbo),e instanceof d.default){if("undefined"==typeof r&&(r=0),"undefined"==typeof t&&(t=0),this.gl.framebufferTexture2D(WebGLRenderingContext.FRAMEBUFFER,WebGLRenderingContext.COLOR_ATTACHMENT0+r,WebGLRenderingContext.TEXTURE_2D,e.texture,t),this.gl.checkFramebufferStatus(WebGLRenderingContext.FRAMEBUFFER)!==WebGLRenderingContext.FRAMEBUFFER_COMPLETE)throw new Error("INCOMPLETE framebuffer")}else if(e instanceof c.default){var n=t;"undefined"==typeof t&&(n=WebGLRenderingContext.DEPTH_ATTACHMENT),this.gl.framebufferRenderbuffer(WebGLRenderingContext.FRAMEBUFFER,n,WebGLRenderingContext.RENDERBUFFER,e.renderBuffer)}this.gl.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null)}},{key:"bind",value:function(){this.gl.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,this.fbo)}},{key:"destroy",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.gl.deleteFramebuffer(this.fbo)}}]),t}(p.default);t.default=b},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)},l=r(2),c=n(l),f=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.renderBuffer=e.createRenderbuffer(),r}return a(t,e),u(t,[{key:"update",value:function(e,t,r){this.gl.bindRenderbuffer(WebGLRenderingContext.RENDERBUFFER,this.renderBuffer),this.gl.renderbufferStorage(WebGLRenderingContext.RENDERBUFFER,e,t,r),this.valid=!0}},{key:"bind",value:function(){this.gl.bindRenderbuffer(WebGLRenderingContext.RENDERBUFFER,this.renderBuffer)}},{key:"destroy",value:function(){this.gl.deleteRenderbuffer(this.renderBuffer),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(c.default);t.default=f},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){r(this,e)}return n(e,null,[{key:"getPow2Size",value:function(e,t){var r=Math.pow(2,Math.log(e)/Math.LN2|0),n=Math.pow(2,Math.log(t)/Math.LN2|0);return{width:r,height:n}}}]),e}();t.default=i},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.lib.math.GLM},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(89),l=n(s),c=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{s(n.next(e))}catch(e){o(e)}}function u(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(a,u)}s((n=n.apply(e,t)).next())})},f=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.registerCount=0,e.loadCount=0,e.completeCount=0,e.errorCount=0,e.promise=new Promise(function(t){e._resolve=t}),e}return a(t,e),u(t,[{key:"register",value:function(e){var t=this;return this.registerCount++,new Promise(function(r,n){(function(){return c(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e;case 3:t.t0=t.sent,r(t.t0),this.loadCount++,t.next=12;break;case 8:t.prev=8,t.t1=t.catch(0),n(t.t1),this.errorCount++;case 12:this.completeCount++,this._checkLoadCompleted();case 14:case"end":return t.stop()}},t,this,[[0,8]])}))}).bind(t)()})}},{key:"_checkLoadCompleted",value:function(){this.emit("progress",this),this.registerCount===this.completeCount&&this._resolve()}}]),t}(l.default);t.default=f},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.TextFileResolver=void 0;var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)},l=r(16),c=n(l),f=t.TextFileResolver=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"resolve",value:function(e){return s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"resolve",this).call(this,e,function(e){return new Promise(function(t,r){var n=new XMLHttpRequest;n.open("GET",e),n.onload=function(e){t(n.responseText)},n.onerror=function(e){r(e)},n.send()})})}}]),t}(c.default);t.default=new f},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(9),l=n(s),c=r(25),f=n(c),d=r(1),h=n(d),p=r(93),b=n(p),m=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{s(n.next(e))}catch(e){o(e)}}function u(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(a,u)}s((n=n.apply(e,t)).next())})},g=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.loader=new f.default,e}return a(t,e),u(t,[{key:"$treeInitialized",value:function(){this.getAttribute("autoStart")&&this._autoStart(),this._documentResolver()}},{key:"$awake",value:function(){var e=this;this.companion.set(l.default.ns(this.name.ns)("loader"),this.loader),this.loader.register(new Promise(function(t){e._documentResolver=t}));var t=this.companion.get("canvasContainer");if(this.getAttribute("enableLoader")){var r=document.createElement("div");r.innerHTML=b.default,r.style.width=r.style.height="100%",t.appendChild(r),this._loaderElement=r}}},{key:"_autoStart",value:function(){return m(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loader.promise;case 2:this._loaderElement&&this._loaderElement.remove(),this.node.emit("asset-load-completed"),this.tree("goml").setAttribute("loopEnabled",!0);case 5:case"end":return e.stop()}},e,this)}))}}]),t}(h.default);t.default=g,g.attributes={loadingProgress:{default:0,converter:"Number"},autoStart:{default:!0,converter:"Boolean"},enableLoader:{default:!0,converter:"Boolean"}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(24),l=n(s),c=r(14),f=n(c),d=r(5),h=n(d),p=r(8),b=n(p),m=r(71),g=n(m),_=r(3),v=n(_),y=r(10),w=n(y),E=r(1),R=n(E),x=l.default.vec3,O=l.default.vec4,C=l.default.mat4,T=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._renderQueue=new g.default,e._eyeCache=h.default.Zero,e._lookAtCache=h.default.Zero,e._upCache=h.default.Zero,e.__viewMatrix=new b.default,e.__projectionMatrix=new b.default,e.__invProjectionMatrix=new b.default,e.__projectionViewMatrix=new b.default,e._orthographic=!1,e}return a(t,e),u(t,[{key:"$awake",value:function(){var e=this;this.transform=this.node.getComponent(v.default),this.updateTransform(this.transform),this.getAttributeRaw("far").watch(function(t){e.Far=t},!0),this.getAttributeRaw("near").watch(function(t){e.Near=t},!0),this.getAttributeRaw("fovy").watch(function(t){e.Fovy=t},!0),this.getAttributeRaw("aspect").watch(function(t){e.Aspect=t},!0),this.getAttributeRaw("orthoSize").watch(function(t){e.OrthoSize=t},!0),this.getAttributeRaw("orthogonal").watch(function(t){e.OrthographicMode=t},!0),this.getAttributeRaw("autoAspect").boundTo("_autoAspect")}},{key:"$mount",value:function(){this.containedScene=t._findContainedScene(this.node),this.containedScene.queueRegistory.registerQueue(this._renderQueue),this.node.on("transformUpdated",this.updateTransform.bind(this))}},{key:"$unmount",value:function(){this.containedScene.queueRegistory.unregisterQueue(this._renderQueue),this.containedScene=null}},{key:"updateContainedScene",value:function(e){this.containedScene&&this.containedScene.updateScene(e)}},{key:"renderScene",value:function(e){this.containedScene&&(this._justifyAspect(e),e.sceneDescription=this.containedScene.sceneDescription,e.defaultTexture=this.companion.get("defaultTexture"),this._renderQueue.renderAll(e,!0,e.loopIndex))}},{key:"_justifyAspect",value:function(e){if(this._autoAspect){var t=e.viewport.Width/e.viewport.Height;this._aspectCache!==t&&(this.setAttribute("aspect",t),this._aspectCache=t)}}},{key:"updateTransform",value:function(e){x.transformMat4(this._eyeCache.rawElements,h.default.Zero.rawElements,e.globalTransform.rawElements),O.transformMat4(this._lookAtCache.rawElements,t._frontOrigin.rawElements,e.globalTransform.rawElements),x.add(this._lookAtCache.rawElements,this._lookAtCache.rawElements,this._eyeCache.rawElements),O.transformMat4(this._upCache.rawElements,t._upOrigin.rawElements,e.globalTransform.rawElements),C.lookAt(this.__viewMatrix.rawElements,this._eyeCache.rawElements,this._lookAtCache.rawElements,this._upCache.rawElements),C.mul(this.__projectionViewMatrix.rawElements,this.__projectionMatrix.rawElements,this.__viewMatrix.rawElements)}},{key:"_recalculateProjection",value:function(){this._orthographic?C.ortho(this.__projectionMatrix.rawElements,-this._orthoSize*this._aspect,this._orthoSize*this._aspect,-this._orthoSize,this._orthoSize,this._near,this._far):C.perspective(this.__projectionMatrix.rawElements,this._fovy,this._aspect,this._near,this._far),C.mul(this.__projectionViewMatrix.rawElements,this.__projectionMatrix.rawElements,this.__viewMatrix.rawElements),C.invert(this.__invProjectionMatrix.rawElements,this.__projectionMatrix.rawElements)}},{key:"ViewMatrix",get:function(){return this.__viewMatrix}},{key:"ProjectionMatrix",get:function(){return this.__projectionMatrix}},{key:"InvProjectionMatrix",get:function(){return this.__invProjectionMatrix}},{key:"ProjectionViewMatrix",get:function(){return this.__projectionViewMatrix}},{key:"Far",get:function(){return this._far},set:function(e){this._far=e,this._recalculateProjection()}},{key:"Near",get:function(){return this._near},set:function(e){this._near=e,this._recalculateProjection()}},{key:"Aspect",get:function(){return this._aspect},set:function(e){this._aspect=e,this._recalculateProjection()}},{key:"Fovy",get:function(){return this._fovy},set:function(e){this._fovy=e,this._recalculateProjection()}},{key:"OrthoSize",get:function(){return this._orthoSize},set:function(e){this._orthoSize=e}},{key:"OrthographicMode",set:function(e){this._orthographic=e,this._recalculateProjection()},get:function(){return this._orthographic}}],[{key:"_findContainedScene",value:function(e){if(e.parent){var r=e.parent.getComponent(w.default);return r?r:t._findContainedScene(e.parent)}return null}}]),t}(R.default);t.default=T,T._frontOrigin=new f.default(0,0,-1,0),T._upOrigin=new f.default(0,1,0,0),T.attributes={fovy:{default:"45d",converter:"Angle2D"},near:{default:.01,converter:"Number"},far:{default:100,converter:"Number"},aspect:{default:1.6,converter:"Number"},autoAspect:{default:!0,converter:"Boolean"},orthoSize:{default:100,converter:"Number"},orthogonal:{default:!1,converter:"Boolean"}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u,s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(91),c=n(l),f=r(4),d=n(f),h=r(65),p=n(h),b=r(1),m=n(b),g=c.default.ns("HTTP://GRIMOIRE.GL/NS/DEFAULT");!function(e){e[e.Aspect=0]="Aspect",e[e.Fit=1]="Fit",e[e.Manual=2]="Manual"}(u||(u={}));var _=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"$awake",value:function(){var e=this;if(this._scriptTag=this.companion.get("scriptElement"),!this._isContainedInBody(this._scriptTag))throw new Error("goml script should have body as ancesotor to instanciate canvas element in the location");this._generateCanvas(this._scriptTag),this.getAttributeRaw("width").watch(function(t){e._resize()}),this.getAttributeRaw("height").watch(function(t){e._resize()})}},{key:"_generateCanvas",value:function(e){var t=this;this._autoFixForBody(e),this.canvas=document.createElement("canvas"),window.addEventListener("resize",function(){return t._onWindowResize()}),this._configureCanvas(this.canvas,e);var r=this._getContext(this.canvas);return this._defaultTexture=new d.default(r),this._defaultTexture.update(0,1,1,0,WebGLRenderingContext.RGBA,WebGLRenderingContext.UNSIGNED_BYTE,new Uint8Array([0,0,0,0])),this.companion.set(g("gl"),r),this.companion.set(g("canvasElement"),this.canvas),this.companion.set(g("GLExtRequestor"),new p.default(r)),this.companion.set(g("defaultTexture"),this._defaultTexture),this.canvas}},{key:"_resize",value:function(e){var t=(this.companion.get("canvasElement"),this.getAttribute("width")),r=this.getAttribute("height");if(this._widthMode=this._asResizeMode(t),this._heightMode=this._asResizeMode(r),this._widthMode===this._heightMode&&this._widthMode===u.Aspect)throw new Error("Width and height could not have aspect mode in same time!");this._widthMode===u.Aspect&&(this._ratio=t.aspect),this._heightMode===u.Aspect&&(this._ratio=r.aspect),this._widthMode===u.Manual&&this._applyManualWidth(t.size,e),this._heightMode===u.Manual&&this._applyManualHeight(r.size,e),this._onWindowResize(e)}},{key:"_onWindowResize",value:function(e){var t=this._getParentSize();this._widthMode===u.Fit&&this._applyManualWidth(t.width,e),this._heightMode===u.Fit&&(0===t.height&&c.default.debug&&console.warn("Canvas height parameter specified as fit and height of parent element is 0.\n This is possibly the reason you haven't set css to html or body element."),this._applyManualHeight(t.height,e))}},{key:"_applyManualWidth",value:function(e,t){e!==this.canvas.width&&(this.canvas.width=e,this._canvasContainer.style.width=e+"px",t||this.node.broadcastMessage(1,"resizeCanvas"),this._heightMode===u.Aspect&&this._applyManualHeight(e/this._ratio,t))}},{key:"_applyManualHeight",value:function(e,t){e!==this.canvas.height&&(this.canvas.height=e,this._canvasContainer.style.height=e+"px",t||this.node.broadcastMessage(1,"resizeCanvas"),this._widthMode===u.Aspect&&this._applyManualWidth(e*this._ratio,t))}},{key:"_getParentSize",value:function(){var e=this._canvasContainer.parentElement,t=e.getBoundingClientRect();return t}},{key:"_asResizeMode",value:function(e){return"fit"===e.mode?u.Fit:"aspect"===e.mode?u.Aspect:u.Manual}},{key:"_configureCanvas",value:function(e,t){e.style.position="absolute",e.style.top="0px",e.style.left="0px",this._canvasContainer=document.createElement("div"),this._canvasContainer.style.position="relative",this._canvasContainer.style.overflow="hidden",this._canvasContainer.appendChild(e),this.getAttribute("containerId")&&(this._canvasContainer.id=this.getAttribute("containerId")),this.getAttribute("containerClass")&&(this._canvasContainer.className=this.getAttribute("containerClass")),this.companion.set(g("canvasContainer"),this._canvasContainer),t.parentElement.insertBefore(this._canvasContainer,t.nextSibling),this._resize(!0)}},{key:"_getContext",value:function(e){var t=e.getContext("webgl");return t||(t=e.getContext("webgl-experimental")),t}},{key:"_isContainedInBody",value:function(e){return!!e.parentElement&&("BODY"===e.parentNode.nodeName||this._isContainedInBody(e.parentElement))}},{key:"_autoFixForBody",value:function(e){if("BODY"===e.parentElement.nodeName){var t=document.body.getBoundingClientRect();0===t.height&&(document.body.style.height="100%",document.body.parentElement.style.height="100%")}}}]),t}(m.default);_.attributes={width:{default:"fit",converter:"CanvasSize"},height:{default:"fit",converter:"CanvasSize"},containerId:{default:"",converter:"String"},containerClass:{default:"gr-container",converter:"String"}},t.default=_},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e
}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(1),l=n(s),c=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._fullscreen=!1,e}return a(t,e),u(t,[{key:"$awake",value:function(){var e=this;this.getAttributeRaw("fullscreen").watch(function(t){e._fullscreen!==t&&(e._fullscreen=t,e._switchFullscreen())})}},{key:"_switchFullscreen",value:function(){this._fullscreen?this.requestFullscreen(this.getAttribute("fullscreenTarget")||this.companion.get("canvasContainer")):this.exitFullscreen()}},{key:"requestFullscreen",value:function(e){if(e.webkitRequestFullscreen)e.webkitRequestFullscreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else if(e.msRequestFullscreen)e.msRequestFullscreen();else{if(!e.requestFullscreen)return void console.error("");e.requestFullscreen()}}},{key:"exitFullscreen",value:function(){document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():document.cancelFullScreen?document.cancelFullScreen():document.exitFullscreen&&document.exitFullscreen()}}]),t}(l.default);t.default=c,c.attributes={fullscreen:{converter:"Boolean",default:!1},fullscreenTarget:{converter:"String",default:null}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(12),l=n(s),c=r(1),f=n(c),d=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$mount",value:function(){var e=this.getAttribute("type");if(e){var t=this.companion.get("GeometryFactory"),r=l.default.factoryArgumentDeclarations[e],n={};for(var i in r)this.__addAtribute(i,r[i]),n[i]=this.getAttribute(i);this.geometry=t.instanciate(e,n);var o=this.companion.get("GeometryRegistory"),a=this.getAttribute("name");if(!a)throw new Error("Name was not specified");o.addGeometry(a,this.geometry)}}}]),t}(f.default);t.default=d,d.attributes={type:{converter:"String",default:null},name:{converter:"String",default:null}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(12),l=n(s),c=r(1),f=n(c),d=r(9),h=n(d),p=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._geometries={},e}return a(t,e),u(t,[{key:"$awake",value:function(){this._factory=new l.default(this.companion.get("gl")),this.companion.set(this.name,this),this.companion.set(h.default.ns(this.name.ns)("GeometryFactory"),this._factory);var e=!0,t=!1,r=void 0;try{for(var n,i=this.getAttribute("defaultGeometry")[Symbol.iterator]();!(e=(n=i.next()).done);e=!0){var o=n.value;this.addGeometry(o,this._factory.instanciateAsDefault(o))}}catch(e){t=!0,r=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw r}}}},{key:"addGeometry",value:function(e,t){this._geometries[e]=t}},{key:"removeGeometry",value:function(e){this._geometries[e]&&delete this._geometries[e]}},{key:"getGeometry",value:function(e){return this._geometries[e]}}]),t}(f.default);t.default=p,p.attributes={defaultGeometry:{converter:"StringArray",default:["quad","cube","sphere"]}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(3),l=n(s),c=r(1),f=n(c),d=r(14),h=n(d),p=r(8),b=n(p),m=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._isFirstCall=!0,e}return a(t,e),u(t,[{key:"$awake",value:function(){this._canvasContainer=this.companion.get("canvasContainer"),this._currentTransform=this.node.getComponent(l.default)}},{key:"$mount",value:function(){this._canvasContainer=this.companion.get("canvasContainer"),this._currentTransform=this.node.getComponent(l.default),this.node.on("render",this._onRender.bind(this))}},{key:"$treeInitialized",value:function(){var e=this;this.getAttributeRaw("targetRenderer").watch(function(t){e._rendererQuery!==t&&e._onRendererChanged()},!0),this.getAttributeRaw("htmlQuery").watch(function(t){e._onQueryChanged(t)},!0)}},{key:"_onRender",value:function(e){if(this._isFirstCall&&(this._onRendererChanged(),this._isFirstCall=!1),this._queriedElement&&e.caller.node===this._targetNode){var t=e.viewport,r=b.default.transform(this._currentTransform.calcPVM(e.camera),new h.default(0,0,0,1)),n={x:r.X/r.W,y:r.Y/r.W,z:r.Z/r.W};if(n.z>=-1&&n.z<=1){var i={x:t.Left+(n.x+1)/2*t.Width,y:t.Top+(n.y+1)/2*t.Height};this._queriedElement.style.visibility="visible",this._queriedElement.style.left=i.x+"px",this._queriedElement.style.bottom=i.y+"px"}else this._queriedElement.style.visibility="hidden"}}},{key:"_restoreDefault",value:function(){this._canvasContainer.removeChild(this._queriedElement),this._parentCache.appendChild(this._queriedElement);var e=this._queriedElement.style,t=this._styleCache;e.position=t.position,e.left=t.left,e.bottom=t.bottom,e.visibility=t.visibility}},{key:"_beginTrack",value:function(){this._parentCache.removeChild(this._queriedElement),this._canvasContainer.appendChild(this._queriedElement),this._queriedElement.style.position="absolute"}},{key:"_onRendererChanged",value:function(){var e=this,t=!1;this.tree(this.getAttribute("targetRenderer")).forEach(function(r){return!!t||(e._targetNode=r,void(t=!0))})}},{key:"_onQueryChanged",value:function(e){var t=void 0;if(e&&""!==e&&(t=document.querySelectorAll(e)),this._queriedElement&&this._restoreDefault(),t&&0!==t.length){this._queriedElement=t.item(0);var r=this._queriedElement.style;this._styleCache={position:r.position,visibility:r.visibility,left:r.left,bottom:r.bottom},this._parentCache=this._queriedElement.parentElement,this._beginTrack()}else this._queriedElement=void 0,this._parentCache=void 0}}]),t}(f.default);t.default=m,m.attributes={htmlQuery:{default:null,converter:"String"},targetRenderer:{default:"render-scene",converter:"String"}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(13),l=n(s),c=r(1),f=n(c),d=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$awake",value:function(){if(!this.getAttribute("typeName")||!this.getAttribute("src"))throw new Error("type or src cannot be null in material importer");l.default.addSORTMaterialFromURL(this.getAttribute("typeName"),this.getAttribute("src"))}}]),t}(f.default);t.default=d,d.attributes={typeName:{default:null,converter:"String"},src:{default:null,converter:"String"}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(9),l=n(s),c=r(13),f=n(c),d=r(1),h=n(d),p=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$awake",value:function(){var e=l.default.ns(this.name.ns);this.companion.set(e("MaterialFactory"),new f.default(this.companion.get("gl")))}}]),t}(h.default);t.default=p,p.attributes={}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(10),l=n(s),c=r(6),f=n(c),d=r(3),h=n(d),p=r(1),b=n(p),m=r(24),g=n(m),_=g.default.vec3,v=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._priortyCalcCache=new Float32Array(3),e}return a(t,e),u(t,[{key:"getRenderingPriorty",value:function(e,t,r){return _.add(this._priortyCalcCache,e.transform.globalPosition.rawElements,this._geometry.aabb.Center.rawElements),_.sub(this._priortyCalcCache,this._priortyCalcCache,this._transformComponent.globalPosition.rawElements),this._materialContainer.getDrawPriorty(_.sqrLen(this._priortyCalcCache))}},{key:"$awake",value:function(){this.getAttributeRaw("targetBuffer").boundTo("_targetBuffer"),this.getAttributeRaw("layer").boundTo("_layer"),this.getAttributeRaw("drawOffset").boundTo("_drawOffset"),this.getAttributeRaw("drawCount").boundTo("_drawCount"),this.getAttributeRaw("geometry").boundTo("_geometry")}},{key:"$mount",value:function(){this._transformComponent=this.node.getComponent(h.default),this._materialContainer=this.node.getComponent(f.default),this._containedScene=t._findContainedScene(this.node),this._containedScene.queueRegistory.addRenderable(this)}},{key:"$unmount",value:function(){this._containedScene.queueRegistory.removeRenderable(this)}},{key:"render",value:function(e){if(this.node.isActive&&this.enabled&&this._layer===e.layer&&this._geometry&&(e.material||this._materialContainer.ready)){var t={targetBuffer:this._targetBuffer,geometry:this._geometry,attributeValues:null,camera:e.camera,transform:this._transformComponent,buffers:e.buffers,viewport:e.viewport,drawCount:this._drawCount,drawOffset:this._drawOffset,sceneDescription:e.sceneDescription,defaultTexture:e.defaultTexture,technique:e.technique};e.material?(t.attributeValues=e.materialArgs,e.material.draw(t)):(t.attributeValues=this._materialContainer.materialArgs,this._materialContainer.material.draw(t)),this.node.emit("render",e)}}}],[{key:"_findContainedScene",value:function(e){if(e.parent){var r=e.parent.getComponent(l.default);return r?r:t._findContainedScene(e.parent)}return null}}]),t}(b.default);t.default=v,v.attributes={geometry:{converter:"Geometry",default:"quad"},targetBuffer:{converter:"String",default:"default"},layer:{converter:"String",default:"default"},drawCount:{converter:"Number",default:Number.MAX_VALUE},drawOffset:{converter:"Number",default:0}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(5),l=n(s),c=r(80),f=n(c),d=r(8),h=n(d),p=r(3),b=n(p),m=r(1),g=n(m),_=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._lastScreenPos=null,e._xsum=0,e._ysum=0,e}return a(t,e),u(t,[{key:"$awake",value:function(){this.getAttributeRaw("rotateSpeed").boundTo("_rotateSpeed"),this.getAttributeRaw("zoomSpeed").boundTo("_zoomSpeed"),this.getAttributeRaw("moveSpeed").boundTo("_moveSpeed"),this.getAttributeRaw("origin").boundTo("_origin")}},{key:"$mount",value:function(){var e=this.getAttribute("center"),t=null;null!==e?(console.warn("The attribute 'center' is deprecated now. This attribute would be removed on next version. Use 'distance' instead."),t=e):t=this.getAttribute("distance"),this._transform=this.node.getComponent(b.default),this._initialRight=l.default.copy(this._transform.right),this._initialUp=l.default.copy(this._transform.up),this._initialDirection=l.default.copy(this._transform.forward.negateThis()),this._initialRotation=this._transform.localRotation;var r=this.getAttribute("origin");null!==t?this._origin=this._transform.localPosition.addWith(this._transform.forward.multiplyWith(t)):this._origin=r;var n=this.companion.get("canvasElement");n.addEventListener("mousemove",this._mouseMove.bind(this)),n.addEventListener("contextmenu",this._contextMenu.bind(this)),n.addEventListener("mousewheel",this._mouseWheel.bind(this))}},{key:"_contextMenu",value:function(e){e.preventDefault()}},{key:"_mouseMove",value:function(e){if(null===this._lastScreenPos)return void(this._lastScreenPos={x:e.screenX,y:e.screenY});var t=!1,r=e.screenX-this._lastScreenPos.x,n=e.screenY-this._lastScreenPos.y,i=this._transform.localPosition.subtractWith(this._origin).magnitude;if((1&e.buttons)>0&&(this._xsum+=r,this._ysum+=n,this._ysum=Math.min(50*Math.PI,this._ysum),this._ysum=Math.max(50*-Math.PI,this._ysum),t=!0),(2&e.buttons)>0){var o=-r*this._moveSpeed*.01,a=n*this._moveSpeed*.01;this._origin=this._origin.addWith(this._transform.right.multiplyWith(o)).addWith(this._transform.up.multiplyWith(a)),i=this._transform.localPosition.subtractWith(this._origin).magnitude,t=!0}if(t){var u=f.default.angleAxis(-this._xsum*this._rotateSpeed*.01,this._initialUp),s=f.default.angleAxis(-this._ysum*this._rotateSpeed*.01,this._initialRight),c=f.default.multiply(u,s),d=h.default.rotationQuaternion(c),p=h.default.transformNormal(d,this._initialDirection);this._transform.localPosition=this._origin.addWith(l.default.normalize(p).multiplyWith(i)),this._transform.localRotation=f.default.multiply(this._initialRotation,c)}this._lastScreenPos={x:e.screenX,y:e.screenY}}},{key:"_mouseWheel",value:function(e){var t=l.default.normalize(l.default.subtract(this._transform.localPosition,this._origin)),r=-e.deltaY*this._zoomSpeed*.05,n=l.default.subtract(this._origin,this._transform.localPosition).magnitude,i=Math.max(1,n-r);this._transform.localPosition=this._origin.addWith(t.multiplyWith(i)),e.preventDefault()}}]),t}(g.default);t.default=_,_.attributes={rotateSpeed:{default:1,converter:"Number"},zoomSpeed:{default:1,converter:"Number"},moveSpeed:{default:1,converter:"Number"},center:{default:null,converter:"Number"},distance:{default:null,converter:"Number"},origin:{default:"0,0,0",converter:"Vector3"}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(22),l=n(s),c=r(1),f=n(c),d=r(23),h=n(d),p=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$mount",value:function(){this.buffer=new l.default(this.companion.get("gl"))}},{key:"$unmount",value:function(){this.buffer.destroy(),this.buffer=null}},{key:"$resizeBuffer",value:function(e){var t=this.getAttribute("name");if(!t)throw new Error("Attribute 'name' must be specified.");var r=h.default.getPow2Size(e.width,e.height);this.buffer.update(WebGLRenderingContext.DEPTH_COMPONENT16,r.width,r.height),e.bufferSizes[t]={width:r.width,height:r.height},e.buffers[t]=this.buffer}}]),t}(f.default);t.default=p,p.attributes={name:{converter:"String",default:null}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(6),l=n(s),c=r(21),f=n(c),d=r(1),h=n(d),p=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$awake",value:function(){this.getAttributeRaw("targetBuffer").boundTo("_targetBuffer"),this.getAttributeRaw("clearColor").boundTo("_clearColor"),this.getAttributeRaw("clearColorEnabled").boundTo("_clearColorEnabled"),this.getAttributeRaw("clearDepthEnabled").boundTo("_clearDepthEnabled"),this.getAttributeRaw("clearDepth").boundTo("_clearDepth"),this.getAttributeRaw("technique").boundTo("_technique")}},{key:"$mount",value:function(){this._gl=this.companion.get("gl"),this._canvas=this.companion.get("canvasElement");var e=this.companion.get("GeometryRegistory");this._geom=e.getGeometry("quad"),this._materialContainer=this.node.getComponent(l.default)}},{key:"$bufferUpdated",value:function(e){var t=this.getAttribute("out");"default"!==t&&(this._fbo=new f.default(this.companion.get("gl")),this._fbo.update(e.buffers[t]),this._fboSize=e.bufferSizes[t]);var r=this.getAttribute("depthBuffer");r&&this._fbo&&this._fbo.update(e.buffers[r])}},{key:"$render",value:function(e){if(this._materialContainer.ready){this._fbo?(this._fbo.bind(),this._gl.viewport(0,0,this._fboSize.width,this._fboSize.height)):(this._gl.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null),this._gl.viewport(e.viewport.Left,this._canvas.height-e.viewport.Bottom,e.viewport.Width,e.viewport.Height)),this._fbo&&this._clearColorEnabled&&(this._gl.clearColor(this._clearColor.R,this._clearColor.G,this._clearColor.B,this._clearColor.A),this._gl.clear(WebGLRenderingContext.COLOR_BUFFER_BIT)),this._clearDepthEnabled&&(this._gl.clearDepth(this._clearDepth),this._gl.clear(WebGLRenderingContext.DEPTH_BUFFER_BIT));var t={targetBuffer:this._targetBuffer,geometry:this._geom,attributeValues:{},camera:null,transform:null,buffers:e.buffers,viewport:e.viewport,defaultTexture:this.companion.get("defaultTexture"),technique:this._technique};t.attributeValues=this._materialContainer.materialArgs,this._materialContainer.material.draw(t),this._gl.flush()}}}]),t}(h.default);t.default=p,p.attributes={out:{default:"default",converter:"String"},depthBuffer:{default:null,converter:"String"},targetBuffer:{default:"default",converter:"String"},clearColor:{default:"#0000",converter:"Color4"},clearColorEnabled:{default:!0,converter:"Boolean"},clearDepthEnabled:{default:!0,converter:"Boolean"},clearDepth:{default:1,converter:"Number"},technique:{default:"default",converter:"String"}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(1),l=n(s),c=r(21),f=n(c),d=r(6),h=n(d),p=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$awake",value:function(){this.getAttributeRaw("layer").boundTo("_layer"),this.getAttributeRaw("clearColor").boundTo("_clearColor"),this.getAttributeRaw("clearColorEnabled").boundTo("_clearColorEnabled"),this.getAttributeRaw("clearDepthEnabled").boundTo("_clearDepthEnabled"),this.getAttributeRaw("clearDepth").boundTo("_clearDepth"),this.getAttributeRaw("camera").boundTo("_camera"),this.getAttributeRaw("technique").boundTo("_technique")}},{key:"$mount",value:function(){this._gl=this.companion.get("gl"),this._canvas=this.companion.get("canvasElement"),this._materialContainer=this.node.getComponent(h.default)}},{key:"$bufferUpdated",value:function(e){var t=this.getAttribute("out");"default"!==t&&(this._fbo=new f.default(this.companion.get("gl")),this._fbo.update(e.buffers[t]),this._fboSize=e.bufferSizes[t]);var r=this.getAttribute("depthBuffer");r&&this._fbo&&this._fbo.update(e.buffers[r])}},{key:"$render",value:function(e){var t=this._camera?this._camera:e.camera;if(t){this._fbo?(this._fbo.bind(),this._gl.viewport(0,0,this._fboSize.width,this._fboSize.height)):(this._gl.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null),this._gl.viewport(e.viewport.Left,this._canvas.height-e.viewport.Bottom,e.viewport.Width,e.viewport.Height)),this._fbo&&this._clearColorEnabled&&(this._gl.clearColor(this._clearColor.R,this._clearColor.G,this._clearColor.B,this._clearColor.A),this._gl.clear(WebGLRenderingContext.COLOR_BUFFER_BIT)),this._clearDepthEnabled&&(this._gl.clearDepth(this._clearDepth),this._gl.clear(WebGLRenderingContext.DEPTH_BUFFER_BIT)),e.camera.updateContainedScene(e.loopIndex);var r=this._materialContainer.useMaterial;e.camera.renderScene({caller:this,camera:t,buffers:e.buffers,layer:this._layer,viewport:e.viewport,material:r?this._materialContainer.material:void 0,materialArgs:r?this._materialContainer.material:void 0,loopIndex:e.loopIndex,technique:this._technique})}}}]),t}(l.default);t.default=p,p.attributes={layer:{converter:"String",default:"default"},depthBuffer:{default:null,converter:"String"},out:{converter:"String",default:"default"},clearColor:{default:"#0000",converter:"Color4"},clearColorEnabled:{default:!0,converter:"Boolean"},clearDepthEnabled:{default:!0,converter:"Boolean"},clearDepth:{default:1,converter:"Number"},camera:{default:null,converter:"Component",target:"Camera"},technique:{default:"default",converter:"String"}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(1),l=n(s),c=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e._buffers={},e._bufferSizes={},e}return a(t,e),u(t,[{key:"$mount",value:function(){var e=this;this._gl=this.companion.get("gl"),this._canvas=this.companion.get("canvasElement"),this._camera=this.getAttribute("camera"),this.getAttributeRaw("camera").watch(function(t){return e._camera=t}),this.getAttributeRaw("viewport").watch(function(t){e._viewportSizeGenerator=t,e.$resizeCanvas()}),this._viewportSizeGenerator=this.getAttribute("viewport")}},{key:"$treeInitialized",value:function(){this.$resizeCanvas()}},{key:"$resizeCanvas",value:function(){this._viewportCache=this._viewportSizeGenerator(this._canvas),0===this.node.children.length&&this.node.addChildByName("render-scene",{}),this.node.broadcastMessage("resizeBuffer",{width:this._viewportCache.Width,height:this._viewportCache.Height,buffers:this._buffers,bufferSizes:this._bufferSizes}),this.node.broadcastMessage("bufferUpdated",{buffers:this._buffers,bufferSizes:this._bufferSizes})}},{key:"$renderViewport",value:function(e){this.node.broadcastMessage("render",{camera:this._camera,viewport:this._viewportCache,bufferSizes:this._bufferSizes,buffers:this._buffers,loopIndex:e.loopIndex})}}]),t}(l.default);t.default=c,c.attributes={camera:{converter:"Component",default:"camera",target:"Camera"},viewport:{converter:"Viewport",default:"auto"}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(86),l=n(s),c=r(18),f=n(c),d=r(1),h=n(d),p=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$awake",value:function(){this.getAttributeRaw("bgColor").boundTo("_bgColor"),
this.getAttributeRaw("clearDepth").boundTo("_clearDepth")}},{key:"$mount",value:function(){this.gl=this.companion.get("gl")}},{key:"$treeInitialized",value:function(){this.node.getComponent(f.default).register(this.onloop.bind(this),1e3),this.getAttribute("complementRenderer")&&0===this.node.getChildrenByNodeName("renderer").length&&this.node.addChildByName("renderer",{})}},{key:"onloop",value:function(e){if(this.enabled){var t=this._bgColor;this.gl.clearColor(t.R,t.G,t.B,t.A),this.gl.clearDepth(this._clearDepth),this.gl.clear(WebGLRenderingContext.COLOR_BUFFER_BIT|WebGLRenderingContext.DEPTH_BUFFER_BIT),this.node.broadcastMessage(1,"renderViewport",{loopIndex:e})}}}]),t}(h.default);t.default=p,p.attributes={bgColor:{default:new l.default(0,0,0,0),converter:"Color4"},clearDepth:{default:1,converter:"Number"},complementRenderer:{default:!0,converter:"Boolean"}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(4),l=n(s),c=r(1),f=n(c),d=r(23),h=n(d),p=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"$mount",value:function(){this.buffer=new l.default(this.companion.get("gl"))}},{key:"$unmount",value:function(){this.buffer.destroy(),this.buffer=null}},{key:"$resizeBuffer",value:function(e){var t=this.getAttribute("name");if(!t)throw new Error("Attribute 'name' must be specified.");var r=this.getAttribute("format"),n=this.getAttribute("type"),i=h.default.getPow2Size(e.width,e.height);this.buffer.update(0,i.width,i.height,0,r,n,null),e.bufferSizes[t]={width:i.width,height:i.height},e.buffers[t]=this.buffer}}]),t}(f.default);t.default=p,p.attributes={name:{converter:"String",default:null},format:{converter:"Enum",default:WebGLRenderingContext.RGBA,table:{RGBA:WebGLRenderingContext.RGBA,RGB:WebGLRenderingContext.RGB,ALPHA:WebGLRenderingContext.ALPHA,LUMINANCE:WebGLRenderingContext.LUMINANCE,LUMINANCE_ALPHA:WebGLRenderingContext.LUMINANCE_ALPHA,SRGB_EXT:WebGLRenderingContext.SRGB_EXT,SRGB_ALPHA_EXT:WebGLRenderingContext.SRGB_ALPHA_EXT,DEPTH_COMPONENT:WebGLRenderingContext.DEPTH_COMPONENT,DEPTH_STENCIL:WebGLRenderingContext.DEPTH_STENCIL}},type:{converter:"Enum",default:WebGLRenderingContext.UNSIGNED_BYTE,table:{UNSIGNED_BYTE:WebGLRenderingContext.UNSIGNED_BYTE,UNSIGNED_SHORT_5_6_5:WebGLRenderingContext.UNSIGNED_SHORT_5_6_5,UNSIGNED_SHORT_4_4_4_4:WebGLRenderingContext.UNSIGNED_SHORT_4_4_4_4,UNSIGNED_SHORT_5_5_5_1:WebGLRenderingContext.UNSIGNED_SHORT_5_5_5_1,UNSIGNED_SHORT:WebGLRenderingContext.UNSIGNED_SHORT,UNSIGNED_INT:WebGLRenderingContext.UNSIGNED_INT,FLOAT:WebGLRenderingContext.FLOAT}}}},function(e,t){"use strict";function r(e){if("fit"===e)return{mode:"fit"};if("string"==typeof e){var t=/aspect\(([\d+(?.\d*)?]+)\)/.exec(e);if(t)return{mode:"aspect",aspect:Number.parseFloat(t[1])}}return{mode:"manual",size:Number.parseFloat(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){if(!this.declaration.target)throw new Error("Component converter require to be specified target");if(null===e)return null;if(e instanceof s.default)return e.getComponent(this.declaration.target);if(e instanceof a.default){if(e.name===this.declaration.target)return e;throw new Error("Specified component must be "+this.declaration.target)}var t=this.tree(e).first();return t?t.getComponent(this.declaration.target):null}Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),a=n(o),u=r(92),s=n(u);t.default=i},function(e,t){"use strict";function r(e){if(!this.declaration.table)throw new Error("Enum converter needs to be specified table in attribute dictionary");if("number"==typeof e)return e;if("string"==typeof e){var t=this.declaration.table[e];if(t)return t;throw new Error("Specified value is not exisiting in the relation table")}return null}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){if("string"==typeof e)return this.companion.get("GeometryRegistory").getGeometry(e);if(e instanceof a.default)return e;throw new Error('Specified geometry "'+e+'" is not supported for converting into geometry.')}Object.defineProperty(t,"__esModule",{value:!0});var o=r(11),a=n(o);t.default=i},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){if("string"==typeof e){var t=/\s*new\s*\(\s*([a-zA-Z\d\-]+)\s*\)/,r=void 0;if(r=t.exec(e))return this.component[this.declaration.componentBoundTo]=null,this.companion.get("MaterialFactory").instanciate(r[1]);var n=this.tree(e).first().getComponent(a.default);return this.component[this.declaration.componentBoundTo]=n,n.materialPromise}return null}Object.defineProperty(t,"__esModule",{value:!0});var o=r(19),a=n(o);t.default=i},function(e,t){"use strict";function r(e){if(e instanceof Array)return e;if("string"==typeof e){var t=e.split(",");return t.map(function(e){return Number.parseFloat(e)})}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},function(e,t){"use strict";function r(e){return"number"==typeof e?e:"string"==typeof e?Number.parseFloat(e):null===e?null:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},function(e,t){"use strict";function r(e){return e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){e.update(t),requestAnimationFrame(function(){return i(e,t)})}function o(e){var t=/(query|backbuffer|video)\((.+)\)[^\)]*$/,r=void 0;return(r=t.exec(e))?{type:r[1],param:r[2]}:null}function a(e){var t=document.createElement("video");return t.src=e,t}function u(e,t){var r=new b.default(e);return t.play(),r.update(t),i(r,t),r}function s(e){var t=this;if(e instanceof b.default)return new h.default(e);if("string"==typeof e){var r=o(e);if(r){var n=function(){var e=r.param,n=function(){switch(r.type){case"backbuffer":return{v:{v:new h.default(function(t){return t[e]})}};case"video":return{v:{v:new h.default(u(t.companion.get("gl"),a(e)))}};case"query":var n=t.tree(e),i=n.first().getComponent(f.default);return{v:{v:new h.default(function(){return i.texture})}}}}();if("object"===("undefined"==typeof n?"undefined":l(n)))return n.v}();if("object"===("undefined"==typeof n?"undefined":l(n)))return n.v}else{var i=function(){var r=new b.default(t.companion.get("gl"));return g.default.resolve(e).then(function(e){r.update(e)}),t.companion.get("loader").register(r.validPromise),{v:new h.default(r)}}();if("object"===("undefined"==typeof i?"undefined":l(i)))return i.v}}if("object"===("undefined"==typeof e?"undefined":l(e)))if(e instanceof HTMLImageElement){var s=function(){var r=new b.default(t.companion.get("gl"));return e.complete&&e.naturalWidth?r.update(e):e.onload=function(){r.update(e)},{v:new h.default(r)}}();if("object"===("undefined"==typeof s?"undefined":l(s)))return s.v}else{if(e instanceof HTMLCanvasElement){var c=new b.default(this.companion.get("gl"));return c.update(e),new h.default(c)}if(e instanceof HTMLVideoElement)return new h.default(u(this.companion.get("gl"),e))}return null}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=r(20),f=n(c),d=r(63),h=n(d),p=r(4),b=n(p),m=r(17),g=n(m);t.default=s},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var r=/(\d+)\s*%/,n=void 0;if(n=r.exec(t)){var i=Number.parseFloat(n[1]);return Math.floor(e*i*.01)}return Math.floor(Number.parseFloat(t))}function o(e){if(e instanceof s.default)return function(){return e};if("string"==typeof e){if("auto"===e)return function(e){return new s.default(0,0,e.width,e.height)};var t=function(){var t=e.split(",");if(4!==t.length)throw new Error("Invalid viewport size was specified.");return{v:function(e){return new s.default(i(e.width,t[0]),i(e.height,t[1]),i(e.width,t[2]),i(e.height,t[3]))}}}();if("object"===("undefined"==typeof t?"undefined":a(t)))return t.v}throw new Error(e+" could not be parsed")}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=r(87),s=n(u);t.default=o},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(79),u=n(a),s=r(5),l=n(s),c=r(56),f=n(c),d=r(12),h=n(d),p=r(55),b=n(p),m=new u.default;m.expand(new l.default(-1,-1,-1)),m.expand(new l.default(1,1,1));var g=function(){function e(){i(this,e)}return o(e,null,[{key:"register",value:function(){e._registerTriangle(),e._registerQuad(),e._registerCube(),e._registerSphere(),e._registerCircle(),e._registerCylinder(),e._registerCone(),e._registerPlane()}},{key:"_registerTriangle",value:function(){h.default.addType("triangle",{},function(e,t){return b.default.build(e,{indices:{default:{generator:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.triangleIndex(0),"t0",1);case 1:case"end":return e.stop()}},e,this)}),topology:WebGLRenderingContext.TRIANGLES},wireframe:{generator:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.linesFromTriangles(f.default.triangleIndex(0)),"t0",1);case 1:case"end":return e.stop()}},e,this)}),topology:WebGLRenderingContext.LINES}},vertices:{main:{size:{POSITION:3,NORMAL:3,TEXCOORD:2},count:f.default.triangleSize(),getGenerators:function(){return{POSITION:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.trianglePosition(l.default.Zero,l.default.YUnit,l.default.XUnit),"t0",1);case 1:case"end":return e.stop()}},e,this)}),NORMAL:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.triangleNormal(l.default.ZUnit),"t0",1);case 1:case"end":return e.stop()}},e,this)}),TEXCOORD:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.triangleTexCoord(),"t0",1);case 1:case"end":return e.stop()}},e,this)})}}}}})})}},{key:"_registerQuad",value:function(){h.default.addType("quad",{},function(e,t){return b.default.build(e,{indices:{default:{generator:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.quadIndex(0),"t0",1);case 1:case"end":return e.stop()}},e,this)}),topology:WebGLRenderingContext.TRIANGLES},wireframe:{generator:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.linesFromTriangles(f.default.quadIndex(0)),"t0",1);case 1:case"end":return e.stop()}},e,this)}),topology:WebGLRenderingContext.LINES}},vertices:{main:{size:{POSITION:3,NORMAL:3,TEXCOORD:2},count:f.default.quadSize(),getGenerators:function(){return{POSITION:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.quadPosition(l.default.Zero,l.default.YUnit,l.default.XUnit),"t0",1);case 1:case"end":return e.stop()}},e,this)}),NORMAL:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.quadNormal(l.default.ZUnit),"t0",1);case 1:case"end":return e.stop()}},e,this)}),TEXCOORD:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.quadTexCoord(),"t0",1);case 1:case"end":return e.stop()}},e,this)})}}}}})})}},{key:"_registerCube",value:function(){h.default.addType("cube",{},function(e,t){return b.default.build(e,{indices:{default:{generator:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.cubeIndex(0),"t0",1);case 1:case"end":return e.stop()}},e,this)}),topology:WebGLRenderingContext.TRIANGLES},wireframe:{generator:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.linesFromTriangles(f.default.cubeIndex(0)),"t0",1);case 1:case"end":return e.stop()}},e,this)}),topology:WebGLRenderingContext.LINES}},vertices:{main:{size:{POSITION:3,NORMAL:3,TEXCOORD:2},count:f.default.cubeSize(),getGenerators:function(){return{POSITION:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.cubePosition(l.default.Zero,l.default.YUnit,l.default.XUnit,l.default.ZUnit.negateThis()),"t0",1);case 1:case"end":return e.stop()}},e,this)}),NORMAL:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.cubeNormal(l.default.Zero,l.default.YUnit,l.default.XUnit,l.default.ZUnit.negateThis()),"t0",1);case 1:case"end":return e.stop()}},e,this)}),TEXCOORD:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.cubeTexCoord(),"t0",1);case 1:case"end":return e.stop()}},e,this)})}}}},aabb:m})})}},{key:"_registerSphere",value:function(){h.default.addType("sphere",{divVertical:{converter:"Number",default:100},divHorizontal:{converter:"Number",default:100}},function(e,t){var r=t.divHorizontal,n=t.divVertical;return b.default.build(e,{indices:{default:{generator:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.sphereIndex(0,r,n),"t0",1);case 1:case"end":return e.stop()}},e,this)}),topology:WebGLRenderingContext.TRIANGLES},wireframe:{generator:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.linesFromTriangles(f.default.sphereIndex(0,r,n)),"t0",1);case 1:case"end":return e.stop()}},e,this)}),topology:WebGLRenderingContext.LINES}},vertices:{main:{size:{POSITION:3,NORMAL:3,TEXCOORD:2},count:f.default.sphereSize(r,n),getGenerators:function(){return{POSITION:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.spherePosition(l.default.Zero,l.default.YUnit,l.default.XUnit,l.default.ZUnit.negateThis(),r,n),"t0",1);case 1:case"end":return e.stop()}},e,this)}),NORMAL:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.sphereNormal(l.default.YUnit,l.default.XUnit,l.default.ZUnit.negateThis(),r,n),"t0",1);case 1:case"end":return e.stop()}},e,this)}),TEXCOORD:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.sphereTexCoord(r,n),"t0",1);case 1:case"end":return e.stop()}},e,this)})}}}},aabb:m})})}},{key:"_registerCircle",value:function(){h.default.addType("circle",{divide:{converter:"Number",default:50}},function(e,t){var r=t.divide;return b.default.build(e,{indices:{default:{generator:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.ellipseIndex(0,r),"t0",1);case 1:case"end":return e.stop()}},e,this)}),topology:WebGLRenderingContext.TRIANGLES},wireframe:{generator:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.linesFromTriangles(f.default.ellipseIndex(0,r)),"t0",1);case 1:case"end":return e.stop()}},e,this)}),topology:WebGLRenderingContext.LINES}},vertices:{main:{size:{POSITION:3,NORMAL:3,TEXCOORD:2},count:f.default.ellipseSize(r),getGenerators:function(){return{POSITION:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.ellipsePosition(l.default.Zero,l.default.YUnit,l.default.XUnit,r),"t0",1);case 1:case"end":return e.stop()}},e,this)}),NORMAL:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.ellipseNormal(l.default.ZUnit,r),"t0",1);case 1:case"end":return e.stop()}},e,this)}),TEXCOORD:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.ellipseTexCoord(r),"t0",1);case 1:case"end":return e.stop()}},e,this)})}}}}})})}},{key:"_registerCylinder",value:function(){h.default.addType("cylinder",{divide:{converter:"Number",default:50}},function(e,t){var r=t.divide;return b.default.build(e,{indices:{default:{generator:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.cylinderIndex(0,r),"t0",1);case 1:case"end":return e.stop()}},e,this)}),topology:WebGLRenderingContext.TRIANGLES},wireframe:{generator:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.linesFromTriangles(f.default.cylinderIndex(0,r)),"t0",1);case 1:case"end":return e.stop()}},e,this)}),topology:WebGLRenderingContext.LINES}},vertices:{main:{size:{POSITION:3,NORMAL:3,TEXCOORD:2},count:f.default.cylinderSize(r),getGenerators:function(){return{POSITION:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.cylinderPosition(l.default.Zero,l.default.YUnit,l.default.XUnit,l.default.ZUnit.negateThis(),r),"t0",1);case 1:case"end":return e.stop()}},e,this)}),NORMAL:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.cylinderNormal(l.default.Zero,l.default.YUnit,l.default.XUnit,l.default.ZUnit.negateThis(),r),"t0",1);case 1:case"end":return e.stop()}},e,this)}),TEXCOORD:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.cylinderTexCoord(r),"t0",1);case 1:case"end":return e.stop()}},e,this)})}}}},aabb:m})})}},{key:"_registerCone",value:function(){h.default.addType("cone",{divide:{converter:"Number",default:50}},function(e,t){var r=t.divide;return b.default.build(e,{indices:{default:{generator:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.coneIndex(0,r),"t0",1);case 1:case"end":return e.stop()}},e,this)}),topology:WebGLRenderingContext.TRIANGLES},wireframe:{generator:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.linesFromTriangles(f.default.coneIndex(0,r)),"t0",1);case 1:case"end":return e.stop()}},e,this)}),topology:WebGLRenderingContext.LINES}},vertices:{main:{size:{POSITION:3,NORMAL:3,TEXCOORD:2},count:f.default.coneSize(r),getGenerators:function(){return{POSITION:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.conePosition(l.default.Zero,l.default.YUnit,l.default.XUnit,l.default.ZUnit.negateThis(),r),"t0",1);case 1:case"end":return e.stop()}},e,this)}),NORMAL:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.coneNormal(l.default.Zero,l.default.YUnit,l.default.XUnit,l.default.ZUnit.negateThis(),r),"t0",1);case 1:case"end":return e.stop()}},e,this)}),TEXCOORD:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.coneTexCoord(r),"t0",1);case 1:case"end":return e.stop()}},e,this)})}}}},aabb:m})})}},{key:"_registerPlane",value:function(){h.default.addType("plane",{divide:{converter:"Number",default:10}},function(e,t){var r=t.divide;return b.default.build(e,{indices:{default:{generator:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.planeIndex(0,r),"t0",1);case 1:case"end":return e.stop()}},e,this)}),topology:WebGLRenderingContext.TRIANGLES},wireframe:{generator:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.linesFromTriangles(f.default.planeIndex(0,r)),"t0",1);case 1:case"end":return e.stop()}},e,this)}),topology:WebGLRenderingContext.LINES}},vertices:{main:{size:{POSITION:3,NORMAL:3,TEXCOORD:2},count:f.default.planeSize(r),getGenerators:function(){return{POSITION:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.planePosition(l.default.Zero,l.default.YUnit,l.default.XUnit,r),"t0",1);case 1:case"end":return e.stop()}},e,this)}),NORMAL:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.planeNormal(l.default.ZUnit,r),"t0",1);case 1:case"end":return e.stop()}},e,this)}),TEXCOORD:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(f.default.planeTexCoord(r),"t0",1);case 1:case"end":return e.stop()}},e,this)})}}}}})})}}]),e}();t.default=g},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(5),u=n(a),s=r(79),l=n(s),c=r(64),f=n(c),d=r(11),h=n(d),p=function(){function e(){i(this,e)}return o(e,null,[{key:"build",value:function(e,t){if(t.verticies|t.indicies)throw new Error("Misspelled API was fixed already. use vertices and indices");var r={},n={},i=t.aabb,o=!i;o&&(i=new l.default);for(var a in t.vertices){var s=4,c=t.vertices[a],d=0;for(var p in c.size){if(n[p])throw new Error("Attribute variable name was dupelicated");var b=c.size[p];n[p]={size:b,offset:d*s,bufferName:a,type:c.type?c.type:WebGLRenderingContext.FLOAT,stride:0},d+=b}for(var m in c.size)n[m].stride=d*s;var g=new Array(d*c.count),_=c.getGenerators(),v=[],y=0,w=[],E=_.beforeEach?_.beforeEach():void 0;for(var R in c.size)if("beforeEach"!==R){var x=_[R];v.push(x()),w.push(c.size[R]),"POSITION"===R&&(y=v.length-1)}for(var O=0,C=0;C<c.count;C++){if(E&&E.next().done)throw new Error("before each was ended before reaching count.");for(var T=0;T<v.length;T++){for(var M=v[T],P=0;P<w[T];P++){var k=M.next();if(k.done)throw new Error("Generator function finished before reaching specified count");g[O]=k.value,O++}o&&T===y&&i.expand(new u.default(g[O-3],g[O-2],g[O-1]))}}r[a]=new f.default(e,WebGLRenderingContext.ARRAY_BUFFER,c.usage?c.usage:WebGLRenderingContext.STATIC_DRAW),r[a].update(new Float32Array(g))}return new h.default(r,n,this._generateIndices(e,t.indices),i)}},{key:"_generateIndices",value:function(e,t){var r={};for(var n in t){var i=[],o=t[n],a=!0,u=!1,s=void 0;try{for(var l,c=o.generator()[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var d=l.value;i.push(d)}}catch(e){u=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(u)throw s}}var h=this._getIndexType(i.length),p=new f.default(e,WebGLRenderingContext.ELEMENT_ARRAY_BUFFER,WebGLRenderingContext.STATIC_DRAW);p.update(new h.ctor(i)),r[n]={count:i.length,index:p,type:h.format,byteSize:h.byteSize,byteOffset:0,topology:o.topology?o.topology:WebGLRenderingContext.TRIANGLES}}return r}},{key:"_getIndexType",value:function(e){var t=WebGLRenderingContext.UNSIGNED_INT,r=Uint32Array,n=4;if(e<256)t=WebGLRenderingContext.UNSIGNED_BYTE,r=Uint8Array,n=1;else if(e<65535)t=WebGLRenderingContext.UNSIGNED_SHORT,r=Uint16Array,n=2;else if(e>=4294967296)throw new Error("Too many index of geometry!");return{format:t,ctor:r,byteSize:n}}}]),e}();t.default=p},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(5),u=n(a),s=function(){function e(){i(this,e)}return o(e,null,[{key:"linesFromTriangles",value:regeneratorRuntime.mark(function e(t){var r,n,i,o,a,u,s,l,c,f,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=new Array(3),n=0,i=!0,o=!1,a=void 0,e.prev=5,u=t[Symbol.iterator]();case 7:if(i=(s=u.next()).done){e.next=17;break}if(l=s.value,r[n%3]=l,n%3!==2){e.next=13;break}return c=r[0],f=r[1],d=r[2],e.delegateYield([c,f,f,d,d,c],"t0",13);case 13:n++;case 14:i=!0,e.next=7;break;case 17:e.next=23;break;case 19:e.prev=19,e.t1=e.catch(5),o=!0,a=e.t1;case 23:e.prev=23,e.prev=24,!i&&u.return&&u.return();case 26:if(e.prev=26,!o){e.next=29;break}throw a;case 29:return e.finish(26);case 30:return e.finish(23);case 31:case"end":return e.stop()}},e,this,[[5,19,23,31],[24,,26,30]])})},{key:"ellipsePosition",value:regeneratorRuntime.mark(function e(t,r,n,i){var o,a,u,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.X;case 2:return e.next=4,t.Y;case 4:return e.next=6,t.Z;case 6:o=2*Math.PI/i,a=0;case 8:if(!(a<i)){e.next=21;break}return u=o*a,s=Math.sin(2*Math.PI-u),l=Math.cos(2*Math.PI-u),e.next=14,t.X+l*r.X+s*n.X;case 14:return e.next=16,t.Y+l*r.Y+s*n.Y;case 16:return e.next=18,t.Z+l*r.Z+s*n.Z;case 18:a++,e.next=8;break;case 21:case"end":return e.stop()}},e,this)})},{key:"trianglePosition",value:regeneratorRuntime.mark(function e(t,r,n){var i,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.addWith(r),o=t.subtractWith(r).addWith(n),a=t.subtractWith(r).subtractWith(n),e.delegateYield(i.rawElements,"t0",4);case 4:return e.delegateYield(o.rawElements,"t1",5);case 5:return e.delegateYield(a.rawElements,"t2",6);case 6:case"end":return e.stop()}},e,this)})},{key:"cubePosition",value:regeneratorRuntime.mark(function t(r,n,i,o){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(e.quadPosition(r.subtractWith(o),n,i),"t0",1);case 1:return t.delegateYield(e.quadPosition(r.addWith(o),n,i.negateThis()),"t1",2);case 2:return t.delegateYield(e.quadPosition(r.addWith(n),o,i),"t2",3);case 3:return t.delegateYield(e.quadPosition(r.addWith(i),o,n.negateThis()),"t3",4);case 4:return t.delegateYield(e.quadPosition(r.subtractWith(n),o,i.negateThis()),"t4",5);case 5:return t.delegateYield(e.quadPosition(r.subtractWith(i),o,n),"t5",6);case 6:case"end":return t.stop()}},t,this)})},{key:"quadPosition",value:regeneratorRuntime.mark(function e(t,r,n){var i,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.subtractWith(n).addWith(r),o=t.addWith(n).addWith(r),a=t.addWith(n).subtractWith(r),u=t.subtractWith(n).subtractWith(r),e.delegateYield(i.rawElements,"t0",5);case 5:return e.delegateYield(o.rawElements,"t1",6);case 6:return e.delegateYield(a.rawElements,"t2",7);case 7:return e.delegateYield(u.rawElements,"t3",8);case 8:case"end":return e.stop()}},e,this)})},{key:"planePosition",value:regeneratorRuntime.mark(function e(t,r,n,i){var o,a,u,s,l,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=t.addWith(n).multiplyWith(2),a=t.subtractWith(r).multiplyWith(2),u=-i/2;case 3:if(!(u<i/2+1)){e.next=13;break}s=-i/2;case 5:if(!(s<i/2+1)){e.next=10;break}return e.delegateYield(o.multiplyWith(s/i).addWith(a.multiplyWith(u/i)).rawElements,"t0",7);case 7:s++,e.next=5;break;case 10:u++,e.next=3;break;case 13:l=-i/2;case 14:if(!(l<i/2+1)){e.next=24;break}c=-i/2;case 16:if(!(c<i/2+1)){e.next=21;break}return e.delegateYield(o.multiplyWith(c/i).addWith(a.multiplyWith(l/i)).rawElements,"t1",18);case 18:c++,e.next=16;break;case 21:l++,e.next=14;break;case 24:case"end":return e.stop()}},e,this)})},{key:"cylinderPosition",value:regeneratorRuntime.mark(function t(r,n,i,o,a){var s,l,c,f,d,h,p,b,m,g;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(e.ellipsePosition(r.addWith(n),o,i,a),"t0",1);case 1:return t.delegateYield(e.ellipsePosition(r.subtractWith(n),o,u.default.negate(i),a),"t1",2);case 2:s=2*Math.PI/a,l=Math.cos(s/2),c=Math.sin(s/2),f=a%2==0?s/2:0,d=0;case 7:if(!(d<a)){t.next=17;break}return h=s/2+s*d,p=Math.sin((Math.PI-s)/2-h-f),b=Math.cos((Math.PI-s)/2-h-f),m=new u.default(l*b,r.Y,l*p),g=new u.default(Math.cos(-s/2-h-f),r.Y,Math.sin(-s/2-h-f)),t.delegateYield(e.quadPosition(m,n,u.default.multiply(c,g)),"t2",14);case 14:d++,t.next=7;break;case 17:case"end":return t.stop()}},t,this)})},{key:"conePosition",value:regeneratorRuntime.mark(function t(r,n,i,o,a){var s,l,c,f,d,h,p,b,m,g;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(e.ellipsePosition(r.subtractWith(n),o,u.default.negate(i),a),"t0",1);case 1:s=2*Math.PI/a,l=Math.cos(s/2)/2,c=Math.sin(s/2),f=a%2==1?s/2:0,d=0;case 6:if(!(d<a)){t.next=16;break}return h=s*d,p=Math.sin((Math.PI-s)/2-h-f),b=Math.cos((Math.PI-s)/2-h-f),m=new u.default(l*b,r.Y,l*p),g=new u.default(Math.cos(-s/2-h-f),r.Y,Math.sin(-s/2-h-f)),t.delegateYield(e.trianglePosition(m,n.subtractWith(m),u.default.multiply(c,g)),"t1",13);
case 13:d++,t.next=6;break;case 16:case"end":return t.stop()}},t,this)})},{key:"spherePosition",value:regeneratorRuntime.mark(function e(t,r,n,i,o,a){var u,s,l,c,f,d,h,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(t.addWith(r).rawElements,"t0",1);case 1:return e.delegateYield(t.subtractWith(r).rawElements,"t1",2);case 2:u=2*Math.PI/a,s=Math.PI/(o+1),l=1;case 5:if(!(l<=o)){e.next=19;break}c=s*l,f=Math.sin(c),d=r.multiplyWith(Math.cos(c)),h=0;case 10:if(!(h<=a)){e.next=16;break}return p=u*h,e.delegateYield(n.multiplyWith(Math.cos(p)).addWith(i.multiplyWith(Math.sin(p))).multiplyWith(f).addWith(d).rawElements,"t2",13);case 13:h++,e.next=10;break;case 16:l++,e.next=5;break;case 19:case"end":return e.stop()}},e,this)})},{key:"quadNormal",value:regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(t.rawElements,"t0",1);case 1:return e.delegateYield(t.rawElements,"t1",2);case 2:return e.delegateYield(t.rawElements,"t2",3);case 3:return e.delegateYield(t.rawElements,"t3",4);case 4:case"end":return e.stop()}},e,this)})},{key:"ellipseNormal",value:regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<r+1)){e.next=6;break}return e.delegateYield(t.rawElements,"t0",3);case 3:n++,e.next=1;break;case 6:case"end":return e.stop()}},e,this)})},{key:"triangleNormal",value:regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(t.rawElements,"t0",1);case 1:return e.delegateYield(t.rawElements,"t1",2);case 2:return e.delegateYield(t.rawElements,"t2",3);case 3:case"end":return e.stop()}},e,this)})},{key:"cubeNormal",value:regeneratorRuntime.mark(function t(r,n,i,o){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(e.quadNormal(o.negateThis()),"t0",1);case 1:return t.delegateYield(e.quadNormal(o),"t1",2);case 2:return t.delegateYield(e.quadNormal(n),"t2",3);case 3:return t.delegateYield(e.quadNormal(i),"t3",4);case 4:return t.delegateYield(e.quadNormal(n.negateThis()),"t4",5);case 5:return t.delegateYield(e.quadNormal(i.negateThis()),"t5",6);case 6:case"end":return t.stop()}},t,this)})},{key:"cylinderNormal",value:regeneratorRuntime.mark(function t(r,n,i,o,a){var s,l,c,f,d,h,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(e.ellipseNormal(n,a),"t0",1);case 1:return t.delegateYield(e.ellipseNormal(n.negateThis(),a),"t1",2);case 2:s=2*Math.PI/a,l=new u.default(Math.cos(-s/2),r.Y,Math.sin(-s/2)),c=0;case 5:if(!(c<a)){t.next=18;break}return f=s*(c+1),d=Math.sin(Math.PI/2-f),h=Math.cos(Math.PI/2-f),p=new u.default(Math.cos(-s/2-f),r.Y,Math.sin(-s/2-f)),t.delegateYield(u.default.cross(l,n).rawElements,"t2",11);case 11:return t.delegateYield(u.default.cross(p,n).rawElements,"t3",12);case 12:return t.delegateYield(u.default.cross(p,n).rawElements,"t4",13);case 13:return t.delegateYield(u.default.cross(l,n).rawElements,"t5",14);case 14:l=p;case 15:c++,t.next=5;break;case 18:case"end":return t.stop()}},t,this)})},{key:"coneNormal",value:regeneratorRuntime.mark(function t(r,n,i,o,a){var s,l,c,f,d,h,p,b,m;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(e.ellipseNormal(n.negateThis(),a),"t0",1);case 1:s=Math.PI/a,l=Math.cos(s/2)/2,c=u.default.cross(new u.default(Math.cos(s/2),r.Y,Math.sin(s/2)),n.subtractWith(new u.default(l*Math.cos((Math.PI+s)/2),r.Y,l*Math.sin((Math.PI+s)/2)))),f=0;case 5:if(!(f<2*a)){t.next=18;break}return d=s*f,h=Math.sin((Math.PI-s)/2-d),p=Math.cos((Math.PI-s)/2-d),b=new u.default(l*p,r.Y,l*h),m=new u.default(Math.cos(-s/2-d),r.Y,Math.sin(-s/2-d)),t.delegateYield(u.default.cross(m,n.subtractWith(b)).rawElements,"t1",12);case 12:if(f%2!=1){t.next=15;break}return t.delegateYield(c.rawElements,"t2",14);case 14:c=u.default.cross(m,n.subtractWith(b));case 15:f++,t.next=5;break;case 18:return t.delegateYield(u.default.cross(new u.default(Math.cos(s/2),r.Y,Math.sin(s/2)),n.subtractWith(new u.default(l*Math.cos((Math.PI+s)/2),r.Y,l*Math.sin((Math.PI+s)/2)))).rawElements,"t3",19);case 19:case"end":return t.stop()}},t,this)})},{key:"planeNormal",value:regeneratorRuntime.mark(function t(r,n){var i,o,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:i=e.planeSize(n)/2,o=0;case 2:if(!(o<i)){t.next=7;break}return t.delegateYield(r.rawElements,"t0",4);case 4:o++,t.next=2;break;case 7:a=0;case 8:if(!(a<i)){t.next=13;break}return t.delegateYield(r.negateThis().rawElements,"t1",10);case 10:a++,t.next=8;break;case 13:case"end":return t.stop()}},t,this)})},{key:"sphereNormal",value:regeneratorRuntime.mark(function t(r,n,i,o,a){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(e.spherePosition(u.default.Zero,r,n,i,o,a),"t0",1);case 1:case"end":return t.stop()}},t,this)})},{key:"sphereTexCoord",value:regeneratorRuntime.mark(function e(t,r){var n,i,o,a,u,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield([0,0,0,1],"t0",1);case 1:n=2*Math.PI/r,i=Math.PI/(t+1),o=1;case 4:if(!(o<=t)){e.next=17;break}a=i*o,u=Math.sin(a),s=0;case 8:if(!(s<=r)){e.next=14;break}return l=n*s,e.delegateYield([l/Math.PI/2,a/Math.PI],"t1",11);case 11:s++,e.next=8;break;case 14:o++,e.next=4;break;case 17:case"end":return e.stop()}},e,this)})},{key:"quadTexCoord",value:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield([0,0],"t0",1);case 1:return e.delegateYield([1,0],"t1",2);case 2:return e.delegateYield([1,1],"t2",3);case 3:return e.delegateYield([0,1],"t3",4);case 4:case"end":return e.stop()}},e,this)})},{key:"cubeTexCoord",value:regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=0;case 1:if(!(r<6)){t.next=6;break}return t.delegateYield(e.quadTexCoord(),"t0",3);case 3:r++,t.next=1;break;case 6:case"end":return t.stop()}},t,this)})},{key:"triangleTexCoord",value:regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield([0,0],"t0",1);case 1:return e.delegateYield([1,0],"t1",2);case 2:return e.delegateYield([0,1],"t2",3);case 3:case"end":return e.stop()}},e,this)})},{key:"ellipseTexCoord",value:regeneratorRuntime.mark(function e(t){var r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield([.5,.5],"t0",1);case 1:r=2*Math.PI/t,n=0;case 3:if(!(n<t)){e.next=9;break}return i=r*n,e.delegateYield([.5+Math.cos(i+Math.PI)/2,.5+Math.sin(i+Math.PI)/2],"t1",6);case 6:n++,e.next=3;break;case 9:case"end":return e.stop()}},e,this)})},{key:"planeTexCoord",value:regeneratorRuntime.mark(function e(t){var r,n,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<t+1)){e.next=11;break}n=0;case 3:if(!(n<t+1)){e.next=8;break}return e.delegateYield([n/t,r/t],"t0",5);case 5:n++,e.next=3;break;case 8:r++,e.next=1;break;case 11:i=0;case 12:if(!(i<t+1)){e.next=22;break}o=0;case 14:if(!(o<t+1)){e.next=19;break}return e.delegateYield([o/t,i/t],"t1",16);case 16:o++,e.next=14;break;case 19:i++,e.next=12;break;case 22:case"end":return e.stop()}},e,this)})},{key:"cylinderTexCoord",value:regeneratorRuntime.mark(function t(r){var n,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(e.ellipseTexCoord(r),"t0",1);case 1:return t.delegateYield(e.ellipseTexCoord(r),"t1",2);case 2:n=1/r,i=0;case 4:if(!(i<r)){t.next=12;break}return t.delegateYield([n*i,0],"t2",6);case 6:return t.delegateYield([n*(i+1),0],"t3",7);case 7:return t.delegateYield([n*(i+1),1],"t4",8);case 8:return t.delegateYield([n*i,1],"t5",9);case 9:i++,t.next=4;break;case 12:case"end":return t.stop()}},t,this)})},{key:"coneTexCoord",value:regeneratorRuntime.mark(function t(r){var n,i,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(e.ellipseTexCoord(r),"t0",1);case 1:n=Math.PI/2/r,i=0;case 3:if(!(i<r)){t.next=11;break}return o=-n*i,t.delegateYield([0,0],"t1",6);case 6:return t.delegateYield([Math.cos(o-n),Math.sin(o-n)],"t2",7);case 7:return t.delegateYield([Math.cos(o),Math.sin(o)],"t3",8);case 8:i++,t.next=3;break;case 11:case"end":return t.stop()}},t,this)})},{key:"triangleIndex",value:regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t,e.delegateYield([r,r+2,r+1],"t0",2);case 2:case"end":return e.stop()}},e,this)})},{key:"quadIndex",value:regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t,e.delegateYield([r,r+2,r+1,r,r+3,r+2],"t0",2);case 2:case"end":return e.stop()}},e,this)})},{key:"cubeIndex",value:regeneratorRuntime.mark(function t(r){var n,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e.quadSize(),i=0;case 2:if(!(i<6)){t.next=7;break}return t.delegateYield(e.quadIndex(r+n*i),"t0",4);case 4:i++,t.next=2;break;case 7:case"end":return t.stop()}},t,this)})},{key:"sphereIndex",value:regeneratorRuntime.mark(function e(t,r,n){var i,o,a,u,s,l,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=function(e,r){return t+(n+1)*r+2+e},o=t,a=t+1,u=0;case 4:if(!(u<n)){e.next=14;break}return e.next=7,o;case 7:return e.next=9,i(u,0);case 9:return e.next=11,i(u+1,0);case 11:u++,e.next=4;break;case 14:s=0;case 15:if(!(s<r-1)){e.next=36;break}l=0;case 17:if(!(l<n)){e.next=33;break}return e.next=20,i(l,s);case 20:return e.next=22,i(l,s+1);case 22:return e.next=24,i(l+1,s);case 24:return e.next=26,i(l,s+1);case 26:return e.next=28,i(l+1,s+1);case 28:return e.next=30,i(l+1,s);case 30:l++,e.next=17;break;case 33:s++,e.next=15;break;case 36:c=0;case 37:if(!(c<n)){e.next=47;break}return e.next=40,a;case 40:return e.next=42,i(c+1,r-1);case 42:return e.next=44,i(c,r-1);case 44:c++,e.next=37;break;case 47:case"end":return e.stop()}},e,this)})},{key:"cylinderIndex",value:regeneratorRuntime.mark(function t(r,n){var i,o,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.ellipseSize(n),o=e.quadSize(),t.delegateYield(e.ellipseIndex(r,n),"t0",3);case 3:return t.delegateYield(e.ellipseIndex(r+i,n),"t1",4);case 4:a=0;case 5:if(!(a<n)){t.next=10;break}return t.delegateYield(e.quadIndex(r+2*i+o*a),"t2",7);case 7:a++,t.next=5;break;case 10:case"end":return t.stop()}},t,this)})},{key:"coneIndex",value:regeneratorRuntime.mark(function t(r,n){var i,o,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.ellipseSize(n),o=e.triangleSize(),t.delegateYield(e.ellipseIndex(r,n),"t0",3);case 3:a=0;case 4:if(!(a<n)){t.next=9;break}return t.delegateYield(e.triangleIndex(r+i+a*o),"t1",6);case 6:a++,t.next=4;break;case 9:case"end":return t.stop()}},t,this)})},{key:"planeIndex",value:regeneratorRuntime.mark(function t(r,n){var i,o,a,u,s,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:i=r,o=e.planeSize(n)/2,a=0;case 3:if(!(a<n)){t.next=15;break}u=0;case 5:if(!(u<n)){t.next=12;break}return i=r+u+a*(n+1),t.delegateYield([i,i+n+2,i+1],"t0",8);case 8:return t.delegateYield([i,i+n+1,i+n+2],"t1",9);case 9:u++,t.next=5;break;case 12:a++,t.next=3;break;case 15:s=0;case 16:if(!(s<n)){t.next=28;break}l=0;case 18:if(!(l<n)){t.next=25;break}return i=r+l+s*(n+1)+o,t.delegateYield([i,i+1,i+n+2],"t2",21);case 21:return t.delegateYield([i,i+n+2,i+n+1],"t3",22);case 22:l++,t.next=18;break;case 25:s++,t.next=16;break;case 28:case"end":return t.stop()}},t,this)})},{key:"ellipseIndex",value:regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<r-1)){e.next=6;break}return e.delegateYield([t,t+1+n,t+2+n],"t0",3);case 3:n++,e.next=1;break;case 6:return e.delegateYield([t,t+r,t+1],"t1",7);case 7:case"end":return e.stop()}},e,this)})},{key:"quadSize",value:function(){return 4}},{key:"triangleSize",value:function(){return 3}},{key:"cubeSize",value:function(){return 6*e.quadSize()}},{key:"sphereSize",value:function(e,t){return 2+e*(t+1)}},{key:"cylinderSize",value:function(t){return 2*e.ellipseSize(t)+t*e.quadSize()}},{key:"coneSize",value:function(t){return e.ellipseSize(t)+t*e.triangleSize()}},{key:"planeSize",value:function(e){return(e+1)*(e+1)*2}},{key:"ellipseSize",value:function(e){return e+1}}]),e}();t.default=s},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={GRIMOIRE:null,WEBGL_VERSION:"1"}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(13),u=n(a),s=r(94),l=n(s),c=function(){function e(){i(this,e)}return o(e,null,[{key:"register",value:function(){u.default.addSORTMaterial("unlit",l.default)}}]),e}();t.default=c},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(57),u=n(a),s=function(){function e(){i(this,e),this.macroString="",this._macro={},this._observers=[];for(var t in u.default)this.setValue(t,u.default[t])}return o(e,[{key:"setValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._macro[e]!==t&&(this._macro[e]=t,this.macroString=this._getMacroString(),this._notifyMacroChanged())}},{key:"getValue",value:function(e){return this._macro[e]}},{key:"addObserver",value:function(e){this._observers.push(e)}},{key:"removeObserver",value:function(e){for(var t=0;t<this._observers.length;t++)this._observers[t]===e&&this._observers.splice(t,1)}},{key:"_getMacroString",value:function(){var e="";for(var t in this._macro)e+=this._genSingleMacroString(t,this._macro[t]);return e}},{key:"_notifyMacroChanged",value:function(){for(var e=0;e<this._observers.length;e++)this._observers[e]()}},{key:"_genSingleMacroString",value:function(e,t){if(void 0===t)throw new Error("Macro value of "+e+" can't be undefined");return null===t?"#define "+e+"\n":"#define "+e+" "+t+"\n"}}]),e}();t.default=s},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(62),u=n(a),s=function(){function e(t,r){i(this,e),this.gl=t,this.techniqueRecipes=r,this.argumentDeclarations={},this.arguments={},this.macroDeclarations={},this.techniques={},this._macroObserver={};for(var n in r)this.techniques[n]=new u.default(this,r[n])}return o(e,[{key:"draw",value:function(e){var t=this.techniques[e.technique];t&&t.draw(e)}},{key:"addMacroObserver",value:function(e,t,r){this._macroObserver[e]||(this._macroObserver[e]=[]),this._macroObserver[e].push(r),this.macroDeclarations[e]=t}},{key:"setMacroValue",value:function(e,t){this._macroObserver[e]&&this._macroObserver[e].forEach(function(e){return e(t)})}},{key:"addArgument",value:function(e,t){this.argumentDeclarations[e]=t}},{key:"deleteArgument",value:function(e){delete this.argumentDeclarations[e]}}]),e}();t.default=s},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(68),u=n(a),s=r(11),l=n(s),c=r(7),f=n(c),d=r(66),h=n(d),p=r(81),b=n(p),m=function(){function e(t,r){var n=this;i(this,e),this.material=t,this.passRecipe=r,this._macro={};var o=f.default.generateRegisterers(t,r);this._registers=o.registerers,this._disposers=o.disposers,this._gl=t.gl,this.program=new h.default(this._gl),this.fs=new u.default(this._gl,WebGLRenderingContext.FRAGMENT_SHADER),this.vs=new u.default(this._gl,WebGLRenderingContext.VERTEX_SHADER);var a=function(e){var t=r.macros[e];n._macro[t.macroName]=t.value,n.material.addMacroObserver(e,{converter:"bool"===t.type?"Boolean":"Number",default:t.value},function(e){"bool"===t.type?n._macro[t.macroName]=e?"":void 0:n._macro[t.macroName]=e,n._updateProgram()})};for(var s in r.macros)a(s);this._updateProgram(),this._disables=e._glEnableTargets.concat();for(var l=0;l<r.states.enable.length;l++){var c=r.states.enable[l],d=this._disables.indexOf(c);d>-1&&this._disables.splice(d,1)}}return o(e,[{key:"draw",value:function(e){this.program.use();for(var t=0;t<this._registers.length;t++)this._registers[t](this.program.uniforms,e);this._configure();for(var r in this.passRecipe.attributes){var n=this.passRecipe.attributes[r];l.default.bindBufferToAttribute(e.geometry,this.program,r,n.semantic)}l.default.drawWithCurrentVertexBuffer(e.geometry,e.targetBuffer,e.drawCount,e.drawOffset)}},{key:"dispose",value:function(){for(var e=0;e<this._disposers.length;e++)this._disposers[e]()}},{key:"_configure",value:function(){for(var e=this.passRecipe.states,t=this.passRecipe.states.functions,r=0;r<e.enable.length;r++)this._gl.enable(e.enable[r]);for(var n=0;n<this._disables.length;n++)this._gl.disable(this._disables[n]);t.blendColor&&this._gl.blendColor(t.blendColor[0],t.blendColor[1],t.blendColor[2],t.blendColor[3]),t.blendEquationSeparate&&this._gl.blendEquationSeparate(t.blendEquationSeparate[0],t.blendEquationSeparate[1]),t.blendFuncSeparate&&this._gl.blendFuncSeparate(t.blendFuncSeparate[0],t.blendFuncSeparate[1],t.blendFuncSeparate[2],t.blendFuncSeparate[3]),t.colorMask&&this._gl.colorMask(t.colorMask[0],t.colorMask[1],t.colorMask[2],t.colorMask[3]),t.cullFace&&this._gl.cullFace(t.cullFace[0]),t.depthFunc&&this._gl.depthFunc(t.depthFunc[0]),t.depthMask&&this._gl.depthMask(t.depthMask[0]),t.depthRange&&this._gl.depthRange(t.depthRange[0],t.depthRange[1]),t.frontFace&&this._gl.frontFace(t.frontFace[0]),t.lineWidth&&this._gl.lineWidth(t.lineWidth[0]),t.polygonOffset&&this._gl.polygonOffset(t.polygonOffset[0],t.polygonOffset[1]),t.scissor&&this._gl.scissor(t.scissor[0],t.scissor[1],t.scissor[2],t.scissor[3])}},{key:"_updateProgram",value:function(){this.fs.update(this._generateShaderCode("FS")),this.vs.update(this._generateShaderCode("VS")),this.program.update([this.vs,this.fs])}},{key:"_generateShaderCode",value:function(e){return"#define "+e+"\n"+this._macroCode()+"\n"+b.default+"/*BEGINNING OF USER CODE*/\n"+("VS"===e?this.passRecipe.vertex:this.passRecipe.fragment)}},{key:"_macroCode",value:function(){var e="";for(var t in this._macro)e+="#define "+t+" "+this._macro[t]+"\n";return e}}]),e}();t.default=m,m._glEnableTargets=[WebGLRenderingContext.CULL_FACE,WebGLRenderingContext.DEPTH_TEST,WebGLRenderingContext.STENCIL_TEST,WebGLRenderingContext.BLEND,WebGLRenderingContext.SCISSOR_TEST,WebGLRenderingContext.DITHER,WebGLRenderingContext.POLYGON_OFFSET_FILL,WebGLRenderingContext.SAMPLE_ALPHA_TO_COVERAGE,WebGLRenderingContext.SAMPLE_COVERAGE]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(61),u=n(a),s=function(){function e(t,r){i(this,e),this.material=t,this.passes=[],"Auto"===r.drawOrder?this.drawOrder="UseAlpha":this.drawOrder=r.drawOrder,this.passes=r.passes.map(function(e){return new u.default(t,e)})}return o(e,[{key:"draw",value:function(e){for(var t=0;t<this.passes.length;t++)this.passes[t].draw(e)}},{key:"dispose",value:function(){this.passes.forEach(function(e){return e.dispose()})}}]),e}();t.default=s},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t){r(this,e),this.rawResource=t,this._isFunctionalProxy="function"==typeof t}return n(e,[{key:"get",value:function(e){return this._isFunctionalProxy?this.rawResource(e):this.rawResource}}]),e}();t.default=i},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)},l=r(2),c=n(l),f=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:WebGLRenderingContext.ARRAY_BUFFER,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:WebGLRenderingContext.ELEMENT_ARRAY_BUFFER;i(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.target=r,a.usage=n,a.buffer=e.createBuffer(),a}return a(t,e),u(t,[{key:"update",value:function(e,t){this.bind(),t?(this.valid||this.gl.bufferData(this.target,e+t.byteLength,this.usage),this.gl.bufferSubData(this.target,e,t)):"number"==typeof e?this.gl.bufferData(this.target,e,this.usage):this.gl.bufferData(this.target,e,this.usage),this.valid=!0}},{key:"bind",value:function(){this.gl.bindBuffer(this.target,this.buffer)}},{key:"destroy",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.gl.deleteBuffer(this.buffer)}}]),t}(c.default);t.default=f},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t){r(this,e),this.gl=t,this.extensions={},this._readyExtensions={},this._resolveRequested(),e._requestObserver.push(this._resolveExtensionSafely)}return n(e,[{key:"_resolveRequested",value:function(){var t=this;e._requestedExtensions.forEach(function(e){t._resolveExtensionSafely(e.extensionName)})}},{key:"_resolveExtensionSafely",value:function(t){var r=e._requestedExtensions[e._requestIndexOf(t)];if(!this._resolveExtension(r.extensionName)&&r.isNecessary)throw new Error("A WebGL extension '"+r.extensionName+"' was requested. But that is not supported on this device.")}},{key:"_resolveExtension",value:function(t){if(this._readyExtensions[t])return!0;var r=void 0;return r="undefined"==typeof e._customExtensionResolvers[t]?this.extensions[t]=this.gl.getExtension(t):this.extensions[t]=e._customExtensionResolvers[t](this.gl),this._readyExtensions[t]=void 0!==this.extensions[t],!!this._readyExtensions[t]}}],[{key:"request",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e._requestIndexOf(t);n>-1&&r?e._requestedExtensions[n]={extensionName:t,isNecessary:r}:n===-1&&e._requestedExtensions.push({extensionName:t,isNecessary:r}),e._requestObserver.forEach(function(e){return e(t)})}},{key:"_requestIndexOf",value:function(t){for(var r=0;r<e._requestedExtensions.length;r++)if(e._requestedExtensions[r].extensionName===t)return r;return-1}}]),e}();t.default=i,i._requestedExtensions=[],i._customExtensionResolvers={},i._requestObserver=[],i._customExtensionResolvers.WEBGL_color_buffer_float=function(e){var t=void 0;if(null===e.getExtension("WEBGL_color_buffer_float")){var r=e.createFramebuffer(),n=e.createTexture();e.bindFramebuffer(e.FRAMEBUFFER,r),e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.FLOAT,null),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0),t=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE,e.deleteTexture(n),e.deleteFramebuffer(r)}else t=!0;return t}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)},l=r(67),c=n(l),f=r(69),d=n(f),h=r(2),p=n(h),b=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r._uniformLocations={},r._attributeLocations={},r.uniforms=new d.default(r),r.program=e.createProgram(),r}return a(t,e),u(t,[{key:"update",value:function(e){var t=this;if(this.valid){var r=this.gl.getAttachedShaders(this.program);r.forEach(function(e){return t.gl.detachShader(t.program,e)}),this._uniformLocations={},this._attributeLocations={}}if(e.forEach(function(e){t.gl.attachShader(t.program,e.shader)}),this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,WebGLRenderingContext.LINK_STATUS)){var n=this.gl.getProgramInfoLog(this.program);throw new Error("LINK FAILED\n"+n)}this.valid=!0}},{key:"use",value:function(){this.isLastUsed||this.gl.useProgram(this.program),this.uniforms.onUse()}},{key:"destroy",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.gl.deleteProgram(this.program)}},{key:"findAttributeLocation",value:function(e){return void 0===this._attributeLocations[e]?(this._attributeLocations[e]=this.gl.getAttribLocation(this.program,e),this._safeEnableVertexAttribArray(this._attributeLocations[e]),this._attributeLocations[e]):this._attributeLocations[e]}},{key:"findUniformLocation",value:function(e){var t=this._uniformLocations[e];return void 0===t?this._uniformLocations[e]=this.gl.getUniformLocation(this.program,e):t}},{key:"_safeEnableVertexAttribArray",value:function(e){e<0||this.gl.enableVertexAttribArray(e)}},{key:"isLastUsed",get:function(){return c.default.useProgramCheck(this.gl,this.program)}}]),t}(p.default);t.default=b},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=t.ResourceCache=function(){function e(){r(this,e),this._lastUsedPrograms=new Map}return n(e,[{key:"useProgramCheck",value:function(e,t){return this._lastUsedPrograms.get(e)===t||(this._lastUsedPrograms.set(e,t),!1)}}]),e}();t.default=new i},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)},l=r(2),c=n(l),f=function(e){function t(e,r,n){i(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.type=r,a.sourceCode=n,a.shader=e.createShader(r),n&&a.update(n),a}return a(t,e),u(t,[{key:"update",value:function(e){if(this.gl.shaderSource(this.shader,e),this.gl.compileShader(this.shader),!this.gl.getShaderParameter(this.shader,WebGLRenderingContext.COMPILE_STATUS))throw new Error("Compiling shader failed.\nSourceCode:\n"+e+"\n\nErrorCode:"+this.gl.getShaderInfoLog(this.shader));this.sourceCode=e,this.valid=!0}},{key:"destroy",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.gl.deleteShader(this.shader)}}]),t}(c.default);t.default=f},function(e,t){"use strict";function r(e,t){
if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t){r(this,e),this.program=t,this._currentTextureRegister=0,this._gl=t.gl}return n(e,[{key:"uniformBool",value:function(e,t){var r=this;this._pass(e,function(e){return r._gl.uniform1i(e,t?1:0)})}},{key:"uniformMatrix",value:function(e,t){var r=this;this._pass(e,function(e){return r._gl.uniformMatrix4fv(e,!1,t.rawElements)})}},{key:"uniformMatrixArray",value:function(e,t){for(var r=this,n=t.length/16,i=function(n){r._passAsArray(e,n,function(e){return r._gl.uniformMatrix4fv(e,!1,new Float32Array(t.buffer,t.byteOffset+64*n))})},o=0;o<n;o++)i(o)}},{key:"uniformFloat",value:function(e,t){var r=this;this._pass(e,function(e){return r._gl.uniform1f(e,t)})}},{key:"uniformFloatArray",value:function(e,t){var r=this;this._pass(e,function(e){return r._gl.uniform1fv(e,t)})}},{key:"uniformInt",value:function(e,t){var r=this;this._pass(e,function(e){return r._gl.uniform1i(e,t)})}},{key:"uniformVector2",value:function(e,t){var r=this;this._pass(e,function(e){return r._gl.uniform2f(e,t.X,t.Y)})}},{key:"uniformIntVector2",value:function(e,t){var r=this;this._pass(e,function(e){return r._gl.uniform2i(e,t.X,t.Y)})}},{key:"uniformVector2Array",value:function(e,t){var r=this;this._pass(e,function(e){return r._gl.uniform2fv(e,t)})}},{key:"uniformVector3",value:function(e,t){var r=this;this._pass(e,function(e){return r._gl.uniform3f(e,t.X,t.Y,t.Z)})}},{key:"uniformIntVector3",value:function(e,t){var r=this;this._pass(e,function(e){return r._gl.uniform3i(e,t.X,t.Y,t.Z)})}},{key:"uniformVector3Array",value:function(e,t){var r=this;this._pass(e,function(e){return r._gl.uniform3fv(e,t)})}},{key:"uniformColor3",value:function(e,t){var r=this;this._pass(e,function(e){return r._gl.uniform3f(e,t.R,t.G,t.B)})}},{key:"uniformVector4",value:function(e,t){var r=this;this._pass(e,function(e){return r._gl.uniform4f(e,t.X,t.Y,t.Z,t.W)})}},{key:"uniformIntVector4",value:function(e,t){var r=this;this._pass(e,function(e){return r._gl.uniform4f(e,t.X,t.Y,t.Z,t.W)})}},{key:"uniformVector4Array",value:function(e,t){var r=this;this._pass(e,function(e){return r._gl.uniform4fv(e,t)})}},{key:"uniformColor4",value:function(e,t){var r=this;this._pass(e,function(e){return r._gl.uniform4f(e,t.R,t.G,t.B,t.A)})}},{key:"uniformTexture2D",value:function(e,t){t.valid?(t.register(this._currentTextureRegister),this.uniformInt(e,this._currentTextureRegister),this._currentTextureRegister++):console.warn("The texture assigned to '"+e+"' is not valid.")}},{key:"onUse",value:function(){this._currentTextureRegister=0}},{key:"_pass",value:function(e,t){var r=this.program.findUniformLocation(e);r&&t(r)}},{key:"_passAsArray",value:function(e,t,r){var n=this.program.findUniformLocation(e+"["+t+"]");n&&r(n)}}]),e}();t.default=i},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={Background:{priorty:1e3},NoAlpha:{priorty:2e3},UseAlpha:{priorty:3e3,descending:!0},NoDepth:{priorty:4e3,descending:!0},Overlay:{priorty:5e3,descending:!0}}},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){r(this,e),this._rendeables=[]}return n(e,[{key:"add",value:function(e){this._rendeables.push({rendarable:e,priortyCache:Number.MIN_VALUE})}},{key:"remove",value:function(e){for(var t=0;t<this._rendeables.length;t++){var r=this._rendeables[t];if(r.rendarable.id===e.id)break}this._rendeables.length!==t&&this._rendeables.splice(t,1)}},{key:"renderAll",value:function(e,t,r){for(var n=0;n<this._rendeables.length;n++)this._rendeables[n].priortyCache=this._rendeables[n].rendarable.getRenderingPriorty(e.camera,t,this._rendeables[n].priortyCache);this._rendeables.sort(function(e,t){return e.priortyCache-t.priortyCache}),this._rendeables.forEach(function(t){t.rendarable.render(e)})}}]),e}();t.default=i},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){r(this,e),this._queues=[],this._renderables=[]}return n(e,[{key:"registerQueue",value:function(e){this._queues.push(e),this._renderables.forEach(function(t){return e.add(t)})}},{key:"unregisterQueue",value:function(e){var t=this._queues.indexOf(e);t>-1&&this._queues.splice(t,1)}},{key:"addRenderable",value:function(e){this._renderables.push(e),this._queues.forEach(function(t){return t.add(e)})}},{key:"removeRenderable",value:function(e){var t=this._renderables.indexOf(e);t!==-1&&(this._renderables.splice(t,1),this._queues.forEach(function(t){return t.remove(e)}))}}]),e}();t.default=i},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ImportResolver=void 0;var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)},l=r(15),c=n(l),f=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{s(n.next(e))}catch(e){o(e)}}function u(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(a,u)}s((n=n.apply(e,t)).next())})},d=t.ImportResolver=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,function(e){var r=/^https?:\/\/.*/gm;return r.test(e)?t._toAbsolute(e):e}));return e.staticImports={},e}return a(t,e),u(t,[{key:"resolve",value:function(e){var r=this;return s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"resolve",this).call(this,e,function(t){return r._resolve(e)})}},{key:"_resolve",value:function(e){return f(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.staticImports[e]){t.next=4;break}return t.abrupt("return",this.staticImports[e]);case 4:return t.next=6,this._fromExternal(e);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}},t,this)}))}},{key:"_fromExternal",value:function(e){return new Promise(function(t,r){var n=new XMLHttpRequest;n.open("GET",e),n.onload=function(e){t(n.responseText)},n.onerror=function(e){r(e)},n.send()})}}],[{key:"_toAbsolute",value:function(e){var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host+t.pathname+t.search+t.hash}}]),t}(c.default);t.default=new d},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={attribute:{position:"POSITION",normal:"NORMAL",texCoord:"TEXCOORD"},uniform:{_time:"TIME",_viewportSize:"VIEWPORT_SIZE",_matL:"LOCAL",_matM:"MODEL",_matV:"VIEW",_matP:"PROJECTION",_matVM:"MODELVIEW",_matPVM:"MODELVIEWPROJECTION",_matIM:"MODELINVERSE",_matIV:"VIEWINVERSE",_matIP:"PROJECTIONINVERSE",_matIVM:"MODELVIEWINVERSE",_matIPVM:"MODELVIEWPROJECTIONINVERSE",_matITM:"MODELINVERSETRANSPOSE",_matITVM:"MODELVIEWINVERSETRANSPOSE"}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(77),u=n(a),s=function(){function e(){i(this,e)}return o(e,null,[{key:"parse",value:function(t){return e._parse(t).then(function(r){return e._parsedCache[t]=r,r})}},{key:"_parse",value:function(t){return new Promise(function(r,n){var i={};u.default.resolveImports(u.default.removeComment(t)).then(function(t){try{var o=u.default.separateTechniqueSource(t);for(var a in o)i[a]=e._parseTechnique(o[a]);r(i)}catch(e){n(e)}})})}},{key:"_parseTechnique",value:function(t){for(var r=u.default.fetchDrawOrder(t)||"Auto",n=u.default.separatePassSource(t),i=new Array(n.length),o=0;o<n.length;o++)i[o]=e._parsePassSource(n[o]);return{drawOrder:r,passes:i}}},{key:"_parsePassSource",value:function(e){var t=u.default.removePreferences(e),r=u.default.parseVariables(e,"attribute"),n=u.default.parseVariables(e,"uniform"),i=u.default.parseMacros(e),o=u.default.parsePreferences(e);return{fragment:t,vertex:t,attributes:r,uniforms:n,macros:i,states:o}}},{key:"_getHash",value:function(e){var t=0,r=void 0,n=void 0,i=void 0;if(0===e.length)return t;for(r=0,i=this.length;r<i;r++)n=e.charCodeAt(r),t=(t<<5)-t+n,t|=0;return t}}]),e}();s._parsedCache={},t.default=s},function(e,t){"use strict";function r(e,t){if(e.length!==t)throw new Error("Unmatching argument count on preference parse");return e.map(function(e){var t=WebGLRenderingContext[e];if("number"!=typeof t)throw new Error("Unknown WebGL constant "+e+" was specified");return t})}function n(e,t){if(e.length!==t)throw new Error("Unmatching argument count on preference parse");return e.map(function(e){var t=Number.parseFloat(e);if(isNaN(t))throw new Error("Failed to parse number on preference parsing");return t})}function i(e,t){if(e.length!==t)throw new Error("Unmatching argument count on preference parse");return e.map(function(e){if("true"!==e&&"false"!==e)throw new Error(e+" is not boolean");return"true"===e})}Object.defineProperty(t,"__esModule",{value:!0}),t.default={Enable:function(e,t){var r=WebGLRenderingContext[t[0]];if("number"!=typeof r)throw new Error('Unknown WebGL constant "'+t[0]+'" was specified on @Enable');e.enable.push(r)},Disable:function(e,t){var r=WebGLRenderingContext[t[0]];if("number"!=typeof r)throw new Error('Unknown WebGL constant "'+t[0]+'" was specified on @Disable');var n=e.enable.indexOf(r);n!==n&&e.enable.splice(n,1)},BlendFunc:function(e,t){var n=r(t,2);e.functions.blendFuncSeparate=[n[0],n[1],n[0],n[1]]},BlendFuncSeparate:function(e,t){e.functions.blendFuncSeparate=r(t,4)},BlendEquation:function(e,t){var n=r(t,1);e.functions.blendEquationSeparate=[n[0],n[0]]},BlendEquationSeparate:function(e,t){e.functions.blendEquationSeparate=r(t,4)},BlendColor:function(e,t){e.functions.blendColor=n(t,4)},ColorMask:function(e,t){e.functions.colorMask=i(t,4),e.enable.push(WebGLRenderingContext.COLOR_WRITEMASK)},CullFace:function(e,t){e.functions.cullFace=r(t,1)},DepthFunc:function(e,t){e.functions.depthFunc=r(t,1)},DepthRange:function(e,t){e.functions.depthRange=n(t,2)},FrontFace:function(e,t){e.functions.frontFace=r(t,1)},LineWidth:function(e,t){e.functions.lineWidth=n(t,1)},PolygonOffset:function(e,t){e.functions.polygonOffset=n(t,2),e.enable.push(WebGLRenderingContext.POLYGON_OFFSET_FILL)},Scissor:function(e,t){e.functions.scissor=n(t,4),e.enable.push(WebGLRenderingContext.SCISSOR_TEST)},ExposeMacro:function(e,t){}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(76),u=n(a),s=r(78),l=n(s),c=r(74),f=n(c),d=r(73),h=n(d),p=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{s(n.next(e))}catch(e){o(e)}}function u(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(a,u)}s((n=n.apply(e,t)).next())})},b=function(){function e(){i(this,e)}return o(e,null,[{key:"separateTechniqueSource",value:function(t){if(t.indexOf("@Technique")===-1)return{default:t};for(var r={},n=/@Technique\s+([a-zA-Z0-9_]+)/g,i=void 0;i=n.exec(t);){var o=i[1];if(void 0!==r[o])throw new Error("Technique name "+o+" is dupelicated");r[o]=e.obtainNextSection(t,"{","}",i.index+i.length)}return r}},{key:"separatePassSource",value:function(t){if(t.indexOf("@Pass")===-1)return[t];for(var r=[],n=/@Pass/g,i=void 0;i=n.exec(t);)r.push(e.obtainNextSection(t,"{","}",i.index+i.length));return r}},{key:"fetchDrawOrder",value:function(e){var t=/@DrawOrder\s*\((\w+)\)/g.exec(e);if(t){var r=e.indexOf("@Pass");if(r!==-1&&r<t.index)throw new Error("DrawOrder preference should be just under @Technique section");return t[1]}return null}},{key:"removePreferences",value:function(e){var t=/@.+$/gm;return e.replace(t,"")}},{key:"resolveImports",value:function(t){return p(this,void 0,void 0,regeneratorRuntime.mark(function r(){var n,i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n=/\s*@import\s+"([^"]+)"/.exec(t)){r.next=4;break}return r.abrupt("break",17);case 4:return i=void 0,r.t0=e,r.next=8,h.default.resolve(n[1]);case 8:return r.t1=r.sent,r.next=11,r.t0.resolveImports.call(r.t0,r.t1);case 11:if(i=r.sent){r.next=14;break}throw new Error("Required shader chunk '"+n[1]+"' was not found!!");case 14:t=t.replace(n[0],"\n"+i+"\n"),r.next=0;break;case 17:return r.abrupt("return",t);case 18:case"end":return r.stop()}},r,this)}))}},{key:"parseMacros",value:function(e){for(var t={},r=/@ExposeMacro\s*\(\s*([a-zA-Z0-9_]+)\s*,\s*([a-zA-Z0-9_]+)\s*,\s*([a-zA-Z0-9_]+)\s*,\s*([a-zA-Z0-9_]+)\s*\)/g,n=void 0;n=r.exec(e);){if(!(n[1]&&n[2]&&n[3]&&n[4]))throw new Error("Invalid parameter was passed on @ExposeMacro preference on '"+n[0]+"'");if("bool"!==n[1]&&"int"!==n[1])throw new Error('Invalid macro type "'+n[1]+'". regexResult type must be int or bool');var i=void 0;if("bool"===n[1]){if("true"!==n[4]&&"false"!==n[4])throw new Error('Default macro value "'+n[4]+'" is invalid for bool type macro. Must be true or false');i="true"===n[4]}else if(i=parseFloat(n[4]),isNaN(i))throw new Error('Default macro value "'+n[4]+'" is invalid for int type macro. Must be a number.');t[n[2]]={name:n[2],macroName:n[3],type:n[1],value:i}}return t}},{key:"parsePreferences",value:function(e){for(var t={enable:[WebGLRenderingContext.CULL_FACE,WebGLRenderingContext.BLEND,WebGLRenderingContext.DEPTH_TEST],functions:{blendColor:[0,0,0,0],cullFace:[WebGLRenderingContext.BACK],blendFuncSeparate:[WebGLRenderingContext.SRC_ALPHA,WebGLRenderingContext.ONE_MINUS_SRC_ALPHA,WebGLRenderingContext.SRC_ALPHA,WebGLRenderingContext.ONE_MINUS_SRC_ALPHA],blendEquationSeparate:[WebGLRenderingContext.FUNC_ADD,WebGLRenderingContext.FUNC_ADD],lineWidth:[1],frontFace:[WebGLRenderingContext.CCW],depthRange:[0,1],depthFunc:[WebGLRenderingContext.LESS]}},r=/@([A-Za-z]+)\(([a-zA-Z_0-9,\.\-]*)\)/g,n=void 0;n=r.exec(e);){var i=u.default[n[1]];if(!i)throw new Error("Unknown pass preference "+n[1]+" was specified.");i(t,n[2].split(","))}return t}},{key:"asValidJSON",value:function(e){var t=/([\{,]\s*)([a-zA-Z0-9_]+)(\s*\:)/gm,r=e.replace(t,'$1"$2"$3');return r}},{key:"removeComment",value:function(e){for(var t="",r=!1,n=!1,i=0;i<e.length;i++){var o=e.charAt(i);if("/"===o&&i+1<e.length){if("/"===e.charAt(i+1)&&!n){r=!0,i++;continue}if("*"===e.charAt(i+1)&&!r){n=!0,i++;continue}}if("*"===o&&n&&i+1<e.length&&"/"===e.charAt(i+1))n=!1,i++;else{if("\n"===o){if(r){r=!1;continue}n&&(t+="\n")}r||n||(t+=o)}}return t}},{key:"obtainNextSection",value:function(e,t,r,n){var i=e.indexOf(t,n);if(i===-1)throw new Error("Begining section charactor '"+t+"' was not found.");if(t.length>1||r.length>1)throw new Error("Invalid parameter");for(var o=1,a=t.charCodeAt(0),u=r.charCodeAt(0),s=i+1;s<e.length;s++){var l=e.charCodeAt(s);if(l===a?o++:l===u&&o--,0===o)return e.substring(i+1,s)}throw new Error("Invalid bracket matching")}},{key:"generateVariableFetchRegex",value:function(e){return new RegExp("(?:@([a-zA-Z0-9_]+)?(\\{.+\\})?)?\\s*"+e+"\\s+(?:(lowp|mediump|highp)\\s+)?([a-z0-9A-Z]+)\\s+([a-zA-Z0-9_]+)(?:\\s*\\[\\s*([a-zA-Z0-9_]+)\\s*\\]\\s*)?\\s*;","g")}},{key:"parseVariables",value:function(t,r){for(var n={},i=e.generateVariableFetchRegex(r),o=void 0;o=i.exec(t);){var a=o[5],u=l.default[o[4]],s=o[3],c=o[2],d=void 0!==o[6],h=void 0,p=o[1];p||(p=f.default[r][a],p||(p="uniform"===r?"USER_VALUE":a.toUpperCase())),d&&(h=parseInt(o[6],10),isNaN(h)&&(h=o[6])),n[a]={semantic:p,name:a,type:u,precision:s,attributes:c?JSON.parse(e.asValidJSON(c)):{},isArray:d,count:h}}return n}}]),e}();t.default=b},function(e,t){"use strict";if(Object.defineProperty(t,"__esModule",{value:!0}),!WebGLRenderingContext.ONE)throw new Error("WebGLRenderingContext constant can not be retrived!");var r=WebGLRenderingContext,n={vec2:r.FLOAT_VEC2,vec3:r.FLOAT_VEC3,vec4:r.FLOAT_VEC4,ivec2:r.INT_VEC2,ivec3:r.INT_VEC3,ivec4:r.INT_VEC4,bvec2:r.BOOL_VEC2,bvec3:r.BOOL_VEC3,bvec4:r.BOOL_VEC4,float:r.FLOAT,int:r.INT,bool:r.BOOL,sampler2D:r.SAMPLER_2D,samplerCube:r.SAMPLER_CUBE,mat4:r.FLOAT_MAT4,mat3:r.FLOAT_MAT3,mat2:r.FLOAT_MAT2};t.default=n},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.lib.math.AABB},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.lib.math.Quaternion},function(e,t){e.exports="/*Header start*/\n// helper macros\n#ifdef FS\n  #define FS_PREC(prec,type) precision prec type;\n  #define VS_PREC(prec,type)\n#endif\n#ifdef VS\n#define VS_PREC(prec,type) precision prec type;\n#define FS_PREC(prec,type)\n#endif\n// constants\n#define PI 3.141592653589793\n#define E 2.718281828459045\n#define LN2 0.6931471805599453\n#define LN10 2.302585092994046\n#define LOG2E 1.4426950408889634\n#define LOG10E 0.4342944819032518\n#define SQRT2 1.4142135623730951\n#define SQRT1_2 0.7071067811865476\n/*Header end*/\n"},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(8),o=n(i),a=r(7),u=n(a);u.default.add("MODELVIEWPROJECTION",function(e){return function(t,r){t.uniformMatrix(e.name,r.transform.calcPVM(r.camera))}}),u.default.add("LOCAL",function(e){return function(t,r){t.uniformMatrix(e.name,r.transform.localTransform)}}),u.default.add("MODEL",function(e){return function(t,r){t.uniformMatrix(e.name,r.transform.globalTransform)}}),u.default.add("VIEW",function(e){return function(t,r){t.uniformMatrix(e.name,r.camera.ViewMatrix)}}),u.default.add("PROJECTION",function(e){return function(t,r){t.uniformMatrix(e.name,r.camera.ProjectionMatrix)}}),u.default.add("MODELINVERSE",function(e){return function(t,r){t.uniformMatrix(e.name,o.default.inverse(r.transform.globalTransform))}}),u.default.add("VIEWINVERSE",function(e){return function(t,r){t.uniformMatrix(e.name,o.default.inverse(r.camera.ViewMatrix))}}),u.default.add("PROJECTIONINVERSE",function(e){return function(t,r){t.uniformMatrix(e.name,r.camera.InvProjectionMatrix)}}),u.default.add("MODELVIEWINVERSE",function(e){return function(t,r){t.uniformMatrix(e.name,o.default.inverse(r.transform.calcVM(r.camera)))}}),u.default.add("MODELVIEWPROJECTIONINVERSE",function(e){return function(t,r){t.uniformMatrix(e.name,o.default.inverse(r.transform.calcPVM(r.camera)))}}),u.default.add("MODELINVERSETRANSPOSE",function(e){return function(t,r){t.uniformMatrix(e.name,o.default.transpose(o.default.inverse(r.transform.globalTransform)))}}),u.default.add("MODELVIEWINVERSETRANSPOSE",function(e){return function(t,r){t.uniformMatrix(e.name,o.default.transpose(o.default.inverse(r.transform.calcVM(r.camera))))}}),t.default=null},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(88),o=n(i),a=r(14),u=n(a),s=r(7),l=n(s);l.default.add("VIEWPORT",function(e){return function(t,r){var n=r.viewport;t.uniformVector4(e.name,new u.default(n.Left,n.Top,n.Width,n.Height))}}),l.default.add("VIEWPORT_SIZE",function(e){return function(t,r){var n=r.viewport;t.uniformVector2(e.name,new o.default(n.Width,n.Height))}}),l.default.add("TIME",function(e){return function(t,r){t.uniformFloat(e.name,Date.now()%1e7)}}),l.default.add("HAS_TEXTURE",function(e,t){var r=e.attributes.sampler;if(!r)throw new Error("The variable having HAS_TEXTURE as semantics must have sampler attribute");return function(n,i){var o=!!t.arguments[r]&&!!t.arguments[r].get(i.buffers);n.uniformBool(e.name,o)}}),l.default.add("CAMERA_POSITION",function(e){return function(t,r){t.uniformVector3(e.name,r.camera.transform.globalPosition)}}),l.default.add("CAMERA_DIRECTION",function(e){return function(t,r){t.uniformVector3(e.name,r.camera.transform.forward)}}),t.default=null},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t,r,n,i){var o=void 0;o=t?s.array:s.single,o[e]=function(e,t){return t.addArgument(e.name,{converter:r,default:e.attributes.default?e.attributes.default:n}),{register:function(r,n){i(r,e.name,t.arguments[e.name],n)},dispose:function(){t.deleteArgument(e.name)}}}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(7),a=n(o),u=WebGLRenderingContext,s={array:{},single:{}};a.default.add("USER_VALUE",function(e,t){var r=void 0;if(e.count){if(r=s.array[e.type],!r)throw new Error("No user_value registerer was registered for "+e.type+"[]")}else if(r=s.single[e.type],!r)throw new Error("No user_value registerer was registered for "+e.type);return r(e,t)}),i(u.FLOAT,!1,"Number",0,function(e,t,r){return e.uniformFloat(t,r)}),i(u.INT,!1,"Number",0,function(e,t,r){return e.uniformInt(t,r)}),i(u.BOOL,!1,"Boolean",!1,function(e,t,r){return e.uniformBool(t,r)}),i(u.INT_VEC2,!1,"Vector2",[0,0],function(e,t,r){return e.uniformVector2(t,r)}),i(u.INT_VEC3,!1,"Vector3",[0,0,0],function(e,t,r){return e.uniformVector3(t,r)}),i(u.INT_VEC4,!1,"Vector4",[0,0,0,0],function(e,t,r){return e.uniformVector4(t,r)}),i(u.FLOAT_VEC2,!1,"Vector2",[0,0],function(e,t,r){return e.uniformVector2(t,r)}),i(u.FLOAT_MAT4,!0,"Object",[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],function(e,t,r){return e.uniformMatrixArray(t,r)}),i(u.SAMPLER_2D,!1,"Texture",null,function(e,t,r,n){var i=void 0;r&&(i=r.get(n.buffers))?e.uniformTexture2D(t,i):e.uniformTexture2D(t,n.defaultTexture)}),s.single[u.FLOAT_VEC3]=function(e,t){var r="color"===e.attributes.type,n=e.attributes.default,i=n?n:r?[1,1,1]:[0,0,0];return t.addArgument(e.name,{converter:r?"Color3":"Vector3",default:i}),{register:r?function(r,n){r.uniformColor3(e.name,t.arguments[e.name])}:function(r,n){r.uniformVector3(e.name,t.arguments[e.name])},dispose:function(){t.deleteArgument(e.name)}}},s.single[u.FLOAT_VEC4]=function(e,t){var r="color"===e.attributes.type,n=e.attributes.default,i=n?n:r?[1,1,1,1]:[0,0,0,0];return t.addArgument(e.name,{converter:r?"Color4":"Vector4",default:i}),{register:r?function(r,n){r.uniformColor4(e.name,t.arguments[e.name])}:function(r,n){r.uniformVector4(e.name,t.arguments[e.name])},dispose:function(){t.deleteArgument(e.name)}}},t.default=null},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(58),o=n(i),a=r(54),u=n(a),s=r(9),l=n(s),c=r(27),f=n(c),d=r(28),h=n(d),p=r(29),b=n(p),m=r(30),g=n(m),_=r(31),v=n(_),y=r(32),w=n(y),E=r(33),R=n(E),x=r(18),O=n(x),C=r(19),T=n(C),M=r(6),P=n(M),k=r(34),S=n(k),A=r(35),j=n(A),L=r(36),N=n(L),I=r(37),G=n(I),W=r(38),F=n(W),D=r(41),Y=n(D),U=r(42),B=n(U),V=r(39),z=n(V),q=r(40),H=n(q),X=r(10),Z=n(X),$=r(43),J=n($),Q=r(20),K=n(Q),ee=r(3),te=n(ee),re=r(44),ne=n(re),ie=r(45),oe=n(ie),ae=r(46),ue=n(ae),se=r(47),le=n(se),ce=r(48),fe=n(ce),de=r(52),he=n(de),pe=r(49),be=n(pe),me=r(50),ge=n(me),_e=r(51),ve=n(_e),ye=r(53),we=n(ye),Ee=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{s(n.next(e))}catch(e){o(e)}}function u(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(a,u)}s((n=n.apply(e,t)).next())})};t.default=function(){l.default.register(function(){return Ee(void 0,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=l.default.ns("HTTP://GRIMOIRE.GL/NS/DEFAULT"),l.default.registerComponent(t("AssetLoadingManager"),f.default),l.default.registerComponent(t("Camera"),h.default),l.default.registerComponent(t("CanvasInitializer"),b.default),l.default.registerComponent(t("Fullscreen"),g.default),l.default.registerComponent(t("Geometry"),v.default),l.default.registerComponent(t("GeometryRegistory"),w.default),l.default.registerComponent(t("HTMLBinder"),R.default),l.default.registerComponent(t("LoopManager"),O.default),l.default.registerComponent(t("Material"),T.default),l.default.registerComponent(t("MaterialContainer"),P.default),l.default.registerComponent(t("MaterialImporter"),S.default),l.default.registerComponent(t("MaterialManager"),j.default),l.default.registerComponent(t("MeshRenderer"),N.default),l.default.registerComponent(t("MouseCameraControl"),G.default),l.default.registerComponent(t("RenderBuffer"),F.default),l.default.registerComponent(t("Renderer"),Y.default),l.default.registerComponent(t("RendererManager"),B.default),l.default.registerComponent(t("RenderQuad"),z.default),l.default.registerComponent(t("RenderScene"),H.default),l.default.registerComponent(t("Scene"),Z.default),l.default.registerComponent(t("TextureBuffer"),J.default),l.default.registerComponent(t("Texture"),K.default),l.default.registerComponent(t("Transform"),te.default),l.default.registerConverter(t("CanvasSize"),ne.default),l.default.registerConverter(t("Component"),oe.default),l.default.registerConverter(t("Enum"),ue.default),l.default.registerConverter(t("Geometry"),le.default),l.default.registerConverter(t("Material"),fe.default),l.default.registerConverter(t("Texture"),he.default),l.default.registerConverter(t("NumberArray"),be.default),l.default.registerConverter(t("Number"),ge.default),l.default.registerConverter(t("Object"),ve.default),l.default.registerConverter(t("Texture2D"),he.default),l.default.registerConverter(t("Viewport"),we.default),l.default.registerNode("goml",["CanvasInitializer","LoopManager","AssetLoadingManager","GeometryRegistory","MaterialManager","RendererManager","Fullscreen"]),l.default.registerNode("renderer",["Renderer"]),l.default.registerNode("scene",["Scene"]),l.default.registerNode("camera",["Camera"],{position:"0,0,10"},"object"),l.default.registerNode("empty",[]),l.default.registerNode("object",["Transform"]),l.default.registerNode("geometry",["Geometry"]),l.default.registerNode("texture",["Texture"]),l.default.registerNode("mesh",["MaterialContainer","MeshRenderer"],{},"object"),l.default.registerNode("material",["Material"]),l.default.registerNode("import-material",["MaterialImporter"]),l.default.registerNode("texture-buffer",["TextureBuffer"]),l.default.registerNode("render-buffer",["RenderBuffer"]),l.default.registerNode("render-scene",["MaterialContainer","RenderScene"],{material:null}),l.default.registerNode("render-quad",["MaterialContainer","RenderQuad"],{material:null}),u.default.register(),o.default.register();case 52:case"end":return e.stop()}},e,this)}))})}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.lib.math.Color4},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.lib.math.Rectangle},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.lib.math.Vector2},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.Base.EEObject},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.Base.IDObject},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.GrimoireInterface},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=window.GrimoireJS.Node.GomlNode},function(e,t){e.exports='<div style="width:100%;height:100%;position: relative;">\n    <div style="width: 55px;height: 55px;border-radius: 100%;border: 5px solid #381794;border-right-color: #FC659D;animation: rotate 1s linear infinite;position: absolute;top: 0;left: 0;right: 0;bottom: 0;margin: auto;"></div>\n</div>\n<style type="text/css">\n    @keyframes rotate {\n        from {\n            transform: rotate(0deg);\n        }\n        to {\n            transform: rotate(360deg);\n        }\n    }\n</style>\n'},function(e,t){e.exports='@Technique default{\n@DrawOrder(NoAlpha)\n@Pass{\n  @BlendFunc(SRC_ALPHA,ONE_MINUS_SRC_ALPHA)\n  @ExposeMacro(bool,test,TEST,true)\n  @ExposeMacro(int,test2,TEST2,3)\n  FS_PREC(mediump,float)\n  varying vec2 vTexCoord;\n  #ifdef VS\n\n  attribute vec3 position;\n  attribute vec2 texCoord;\n  @MODELVIEWPROJECTION\n  uniform mat4 _matPVM;\n  void main()\n  {\n    gl_Position = _matPVM * vec4(position,1.0);\n    vTexCoord = texCoord;\n  }\n  #endif\n  #ifdef FS\n  @{type:"color",default:"white"}\n  uniform vec4 color;\n\n  uniform sampler2D texture;\n  @HAS_TEXTURE{sampler:"texture"}\n  uniform bool _textureUsed;\n\n  uniform float _time;\n  void main(void)\n  {\n    if(_textureUsed){\n      gl_FragColor = color * texture2D(texture,vTexCoord);\n    }else{\n      gl_FragColor = color;\n   }\n  }\n  #endif\n}\n}\n'}])});
//# sourceMappingURL=grimoire-fundamental.min.js.map